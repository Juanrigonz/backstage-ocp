(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[844],{43518:function(Bn,pt,z){"use strict";z.d(pt,{Iy:function(){return Lo},l0:function(){return bs},zP:function(){return Oi},vF:function(){return xs},v9:function(){return uo},Lp:function(){return ho},_G:function(){return io},Gc:function(){return no},ow:function(){return Ro},h4:function(){return co},mg:function(){return Ls}});var v=z(30705),ke=z(79692),me=z(42494),I=z(90436),se=z(67358),Ne=z(31625),De=z(31377),Tt=z(34546),rt=z(77277),st=z(60364),He=z(94339),gt=z(24579),tt=z(60905),Je=z(95544),It=z(85256),ee=z(7089),Me=z(14503),ge=z(27556),je=z(4614),Ze=z(97136),Oe=z(5806),Xe=z(21324),Ye=z(86619),K=z(2784),yt={AdditionalItemsError:"Array at `{{pointer}}` may not have an additional item `{{key}}`",AdditionalPropertiesError:"Additional property `{{property}}` on `{{pointer}}` does not match schema `{{schema}}`",AllOfError:"Value `{{value}}` at `{{pointer}}` does not match schema of `{{allOf}}`",AnyOfError:"Value `{{value}}` at `{{pointer}}` does not match any schema of `{{anyOf}}`",ConstError:"Expected value at `{{pointer}}` to be `{{expected}}`, but value given is `{{value}}`",containsAnyError:"The array at `{{pointer}}` must contain at least one item",ContainsArrayError:"The property at `{{pointer}}` must not be an array",ContainsError:"The array at `{{pointer}}` must contain an element that matches `{{schema}}`",EnumError:"Expected given value `{{value}}` in `{{pointer}}` to be one of `{{values}}`",FormatDateError:"Value `{{value}}` at `{{pointer}}` is not a valid date",FormatDateTimeError:"Value `{{value}}` at `{{pointer}}` is not a valid date-time",FormatEmailError:"Value `{{value}}` at `{{pointer}}` is not a valid email",FormatHostnameError:"Value `{{value}}` at `{{pointer}}` is not a valid hostname",FormatIPV4Error:"Value `{{value}}` at `{{pointer}}` is not a valid IPv4 address",FormatIPV4LeadingZeroError:"IPv4 addresses starting with zero are invalid, since they are interpreted as octals",FormatIPV6Error:"Value `{{value}}` at `{{pointer}}` is not a valid IPv6 address",FormatIPV6LeadingZeroError:"IPv6 addresses starting with zero are invalid, since they are interpreted as octals",FormatJSONPointerError:"Value `{{value}}` at `{{pointer}}` is not a valid json-pointer",FormatRegExError:"Value `{{value}}` at `{{pointer}}` is not a valid regular expression",FormatTimeError:"Value `{{value}}` at `{{pointer}}` is not a valid time",FormatURIError:"Value `{{value}}` at `{{pointer}}` is not a valid uri",FormatURIReferenceError:"Value `{{value}}` at `{{pointer}}` is not a valid uri-reference",FormatURITemplateError:"Value `{{value}}` at `{{pointer}}` is not a valid uri-template",FormatURLError:"Value `{{value}}` at `{{pointer}}` is not a valid url",InvalidDataError:"No value may be specified in `{{pointer}}`",InvalidPropertyNameError:"Invalid property name `{{property}}` at `{{pointer}}`",MaximumError:"Value in `{{pointer}}` is `{{length}}`, but should be `{{maximum}}` at maximum",MaxItemsError:"Too many items in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`",MaxLengthError:"Value `{{pointer}}` should have a maximum length of `{{maxLength}}`, but got `{{length}}`.",MaxPropertiesError:"Too many properties in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`",MinimumError:"Value in `{{pointer}}` is `{{length}}`, but should be `{{minimum}}` at minimum",MinItemsError:"Too few items in `{{pointer}}`, should be at least `{{minimum}}`, but got `{{length}}`",MinItemsOneError:"At least one item is required in `{{pointer}}`",MinLengthError:"Value `{{pointer}}` should have a minimum length of `{{minLength}}`, but got `{{length}}`.",MinLengthOneError:"A value is required in `{{pointer}}`",MinPropertiesError:"Too few properties in `{{pointer}}`, should be at least `{{minimum}}`, but got `{{length}}`",MissingDependencyError:"The required propery '{{missingProperty}}' in `{{pointer}}` is missing",MissingOneOfPropertyError:"Value at `{{pointer}}` property: `{{property}}`",MultipleOfError:"Expected `{{value}}` in `{{pointer}}` to be multiple of `{{multipleOf}}`",MultipleOneOfError:"Value `{{value}}` should not match multiple schemas in oneOf `{{matches}}`",NoAdditionalPropertiesError:"Additional property `{{property}}` in `{{pointer}}` is not allowed",NotError:"Value `{{value}}` at pointer should not match schema `{{not}}`",OneOfError:"Value `{{value}}` in `{{pointer}}` does not match any given oneof schema",OneOfPropertyError:"Failed finding a matching oneOfProperty schema in `{{pointer}}` where `{{property}}` matches `{{value}}`",PatternError:"Value in `{{pointer}}` should match `{{description}}`, but received `{{received}}`",PatternPropertiesError:"Property `{{key}}` does not match any patterns in `{{pointer}}`. Valid patterns are: {{patterns}}",RequiredPropertyError:"The required property `{{key}}` is missing at `{{pointer}}`",TypeError:"Expected `{{value}}` ({{received}}) in `{{pointer}}` to be of type `{{expected}}`",UndefinedValueError:"Value must not be undefined in `{{pointer}}`",UniqueItemsError:"Expected unique items in {{pointer}}: duplicate value `{{value}}` found at {{itemPointer}} and {{duplicatePointer}}",UnknownPropertyError:"Could not find a valid schema for property `{{pointer}}` within object",ValueNotEmptyError:"A value for `{{property}}` is required at `{{pointer}}`"};function le(h,a={}){return h.replace(/\{\{\w+\}\}/g,d=>a[d.replace(/[{}]/g,"")])}function Ie(h,a,d=h){const x=yt[h]||d;return le(x,a)}function ze(h){return h.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ot(h,a){return{type:"error",name:h,code:ze(h),message:Ie(h,a),data:a}}function Ae(h){return ot.bind(null,h)}const Ue=Object.prototype.toString;function Ge(h){const a=Ue.call(h).match(/\s([^\]]+)\]/).pop().toLowerCase();return a==="file"?"object":a}function lt(h){return(h==null?void 0:h.type)==="error"}function ye(h){return h instanceof Promise}function xe(h){return lt(h)||ye(h)}function We(h){return isJSONError(h)}function vt(h,a=[]){for(let d=0;d<h.length;d+=1){const x=h[d];Array.isArray(x)?vt(x,a):a.push(x)}return a}var Pt={DECLARATOR_ONEOF:"oneOfProperty",GET_TEMPLATE_RECURSION_LIMIT:1,floatingPointPrecision:1e4,propertyBlacklist:["_id"]};const{DECLARATOR_ONEOF:Wt}=Pt;function Zt(h,a,d=h.rootSchema,x="#"){if(a!=null&&d[Wt]){const J=[],_=d[Wt],de=a[d[Wt]];if(de===void 0)return h.errors.missingOneOfPropertyError({property:_,pointer:x});for(let ie=0;ie<d.oneOf.length;ie+=1){const Ce=h.resolveRef(d.oneOf[ie]),Ve=h.step(_,Ce,a,x);if(lt(Ve))return Ve;let dt=vt(h.validate(de,Ve,x));if(dt=dt.filter(xe),dt.length>0)J.push(...dt);else return Ce}return h.errors.oneOfPropertyError({property:_,value:de,pointer:x,errors:J})}const E=[],F=[];for(let J=0;J<d.oneOf.length;J+=1){const _=h.resolveRef(d.oneOf[J]);let de=vt(h.validate(a,_,x));de=de.filter(xe),de.length>0?F.push(...de):E.push(_)}return E.length===1?E[0]:E.length>1?h.errors.multipleOneOfError({value:a,pointer:x,matches:E}):h.errors.oneOfError({value:JSON.stringify(a),pointer:x,oneOf:d.oneOf,errors:F})}var In=h=>JSON.parse(JSON.stringify(h)),xn=z(39714),er=z.n(xn);const Lt=(h,a)=>a;var rn=(h,a)=>er()(h,a,{arrayMerge:Lt});const Ee=(h,a)=>{const d=h.concat(a);return d.filter((x,E)=>d.indexOf(x)===E)},O=(h,a)=>er()(h,a,{arrayMerge:Ee});function N(h,a,d){var x;const E={...(x=h.resolveRef(a))!==null&&x!==void 0?x:{}};if(E.if&&(E.then||E.else)){const F=h.isValid(d,E.if);if(F&&E.then)return N(h,E.then,d);if(!F&&E.else)return N(h,E.else,d);delete E.if,delete E.then,delete E.else}return E}function W(h,a,d=h.rootSchema,x="#"){let E=In(d);for(let F=0;F<d.allOf.length;F+=1){const J=N(h,d.allOf[F],a);E=O(E,J),a=h.getTemplate(a,E)}return delete E.allOf,E}const{DECLARATOR_ONEOF:G}=Pt;function ne(h,a,d,x){if(d==null||a.properties==null)return-1;let E=0;const F=Object.keys(a.properties);for(let J=0;J<F.length;J+=1){const _=F[J];d[_]!=null&&h.isValid(d[_],a.properties[_],x)&&(E+=1)}return E}function pe(h,a,d=h.rootSchema,x="#"){if(a!=null&&d[G]){const F=[],J=d[G],_=a[d[G]];if(_===void 0)return h.errors.missingOneOfPropertyError({property:J,pointer:x});for(let de=0;de<d.oneOf.length;de+=1){const ie=h.resolveRef(d.oneOf[de]),Ce=h.step(J,ie,a,x);if(lt(Ce))return Ce;let Ve=vt(h.validate(_,Ce,x));if(Ve=Ve.filter(xe),Ve.length>0)F.push(...Ve);else return ie}return h.errors.oneOfPropertyError({property:J,value:_,pointer:x,errors:F})}const E=[];for(let F=0;F<d.oneOf.length;F+=1){const J=h.resolveRef(d.oneOf[F]);h.isValid(a,J,x)&&E.push(J)}if(E.length===1)return E[0];if(Ge(a)==="object"){let F,J=0;for(let _=0;_<d.oneOf.length;_+=1){const de=h.resolveRef(d.oneOf[_]),ie=ne(h,de,a);J<ie&&(J=ie,F=d.oneOf[_])}return F===void 0?h.errors.oneOfError({value:JSON.stringify(a),pointer:x,oneOf:d.oneOf}):F}return E.length>1?h.errors.multipleOneOfError({matches:E,data:a,pointer:x}):h.errors.oneOfError({value:JSON.stringify(a),pointer:x,oneOf:d.oneOf})}var Se=z(67142),$e=z.n(Se);const ve={};function ut(h,a,d,x=h.rootSchema){const E=$e().split(a);return x=h.resolveRef(x),St(h,x,E,a,d)}function St(h,a,d,x,E=ve){if(d.length===0)return h.resolveRef(a);const F=d.shift();return a=h.step(F,a,E,x),lt(a)?a:(E=E[F],St(h,a,d,`${x}/${F}`,E))}function at(h,a){if(h==null||h.$ref==null)return h;const d=a.getRef(h),x=Object.assign({},d,h);return delete x.$ref,Object.defineProperty(x,"__ref",{enumerable:!1,value:h.__ref}),Object.defineProperty(x,"getRoot",{enumerable:!1,value:h.getRoot}),x}function zt(h,a,d){d.id=d.id||a,h.remotes[a]=h.compileSchema(d)}var Ft=z(44091);const Qt="[^?/{}*,()#]+",Jn=`
root ::= ("#" recursion | recursion | (query | pattern) recursion* | "#" SEP? | SEP)
recursion ::= (SEP query | pattern)*

query ::= (ESC escaped ESC | property | all | any | regex) typecheck? lookahead?
property ::= ${Qt}
regex ::= "{" [^}]+ "}"
SEP ::= "/"
all ::= "**"
any ::= "*"

typecheck ::= "?:" ("value" | "boolean" | "string" | "number" | "object" | "array")
lookahead ::= "?" expression ((andExpr | orExpr) expression)*
andExpr ::= S? "&&" S?
orExpr ::= S? "||" S?

expression ::= (exprProperty | ESC escaped ESC) ((isnot | is) (exprProperty | regex | ESC escaped ESC))*
exprProperty ::= [a-zA-Z0-9-_ $]+
escaped ::= [^"]+
is ::= ":"
isnot ::= ":!"
ESC ::= '"'

pattern ::= S? "(" (SEP query | pattern (orPattern? pattern)*)* ")" quantifier? S? lookahead?
quantifier ::= "+" | "*" | [0-9]+
orPattern ::= S? "," S?

S ::= [ ]*
`,En=/(children|text|type|start|end|rest|errors|fullText|\d+)/,or=/(children|text|type|\d+)/,Gt=h=>JSON.stringify(h,(a,d)=>a===""||En.test(a)?d:void 0,2),Mt=h=>JSON.stringify(h,(a,d)=>a===""||a==="rest"&&d!==""||or.test(a)?d:void 0,2),yn=new Ft.Z.Parser(Jn),Ct=h=>yn.getAST(h),Kt=h=>JSON.parse(Mt(h)),Xt=0,Jt=1,bt=2,wt=3,an=(h,a)=>`${h}/${a}`,hn=Object.prototype.toString,Vn=/Object|Array/,Hn=h=>Vn.test(hn.call(h)),cr=h=>hn.call(h).match(/\s([^\]]+)\]/).pop().toLowerCase();function wr(h){return new RegExp(h.text.replace(/(^{|}$)/g,""))}function Bt(h,a){Array.isArray(h)?h.forEach(a):Object.prototype.toString.call(h)==="[object Object]"&&Object.keys(h).forEach(function(d){a(h[d],d,h)})}function Pn(h){return Array.isArray(h)?h.map(function(a,d){return`${d}`}):Object.prototype.toString.call(h)==="[object Object]"?Object.keys(h):[]}const Yt={mem:[],get(h,a){const d=h[Xt][a];if(!Yt.mem.includes(d))return Hn(d)&&Yt.mem.push(d),[d,a,h[Xt],an(h[wt],a)]},reset(){Yt.mem.length=0}},un={any(h,a){const d=a[Xt];return Pn(d).map(x=>[d[x],x,d,an(a[wt],x)])},all(h,a){const d=[a];return Bt(a[Xt],(x,E)=>{const F=Yt.get(a,E);F&&d.push(...un.all(h,F))}),d},regex(h,a){const d=wr(h),x=a[Xt];return Pn(x).filter(E=>d.test(E)).map(E=>[x[E],E,x,an(a[wt],E)])}},Xn={escaped:(h,a)=>Xn.property(h,a),property:(h,a)=>{const d=h.text;if(a[Xt]&&a[Xt][d]!==void 0)return[a[Xt][d],d,a[Xt],an(a[wt],d)]},typecheck:(h,a)=>{const d=h.text.replace(/^\?:/,"");if(d==="value")return Hn(a[Xt])?void 0:a;if(cr(a[Xt])===d)return a},lookahead:(h,a)=>{let d=!0,x=!1;return h.children.forEach(E=>{if(E.type==="expression"){const F=Xn.expression(E,a)!==void 0;d=x===!0?d||F:d&&F}else x=E.type==="orExpr"}),d?a:void 0},expression:(h,a)=>{const d=h.children[0].text,x=h.children[1],E=h.children[2],F=a[Xt];if(Hn(F)!==!1)return fr(F[d],x,E)?a:void 0}};function fr(h,a,d){if(a===void 0)return h!==void 0;let x;const E=`${h}`;return d.type==="regex"?x=wr(d).test(E):x=E===d.text,a.type==="isnot"&&(x=x===!1&&h!==void 0),x}function zn(h,a,d,x){const E=[];for(let F=0,J=a.length;F<J;F+=1)E.push(...h(d,a[F],d,x));return E}function Hi(h,a,d,x){const E=[];for(let F=0,J=a.length;F<J;F+=1){const _=h(d,a[F],x);_&&E.push(_)}return E}function $r(h,a,d){let x=h;return a.children.forEach(E=>{if(un[E.type])x=zn(un[E.type],x,E,d);else if(Xn[E.type])x=Hi(Xn[E.type],x,E,d);else throw new Error(`Unknown filter ${E.type}`)}),x}function ri(h,a,d){const x=[];let E=h;return a.children.forEach(F=>{if(F.type==="orPattern"){x.push(...E),E=h;return}E=Dn(E,F,d)}),x.push(...E),x}function Ln(h){if(h==null)return 1;if(h==="*"||h==="+")return 1/0;const a=parseInt(h);return isNaN(a)?1:a}function gr(h,a,d){const x=[],E=a.children.find(de=>de.type==="quantifier"),F=Ln(E&&E.text);let J=h;E&&E.text==="*"&&x.push(...J);let _=0;for(;J.length>0&&_<F;)J=ri(J,a,d),x.push(...J),_+=1;return x}function ai(h,a,d){let x=h;return a.children.forEach(E=>x=Dn(x,E,d)),x}function Dn(h,a,d){let x;return a.type==="query"?x=$r(h,a,d):a.type==="pattern"?x=gr(h,a,d):x=ai(h,a,d),Yt.reset(),Yt.mem.push(h),x}function yr(h,a){return Yt.reset(),Yt.mem.push(h),Dn([[h,null,null,"#"]],a)}const Gr={value:h=>h.map(a=>a[Xt]),pointer:h=>h.map(a=>a[wt]),all:h=>h,map:h=>{const a={};return h.forEach(d=>a[d[wt]]=d[Xt]),a}};var kn;(function(h){h.POINTER="pointer",h.VALUE="value",h.ALL="all",h.MAP="map"})(kn||(kn={})),tr.POINTER=kn.POINTER,tr.VALUE=kn.VALUE,tr.ALL=kn.ALL,tr.MAP=kn.MAP;function tr(h,a,d=kn.VALUE){if(a==null)return[];a=a.replace(/(\/$)/g,""),a===""&&(a="#");const x=Ct(a);if(x==null)throw new Error(`empty ast for '${a}'`);if(x.rest!=="")throw new Error(`Failed parsing queryString from: '${x.rest}'`);const E=yr(h,x);return typeof d=="function"?E.map(F=>d(...F)):Gr[d]?Gr[d](E):E}const qi=["root","recursion"];function Cr(h,a=[]){return qi.includes(h.type)?(h.children.forEach(d=>Cr(d,a)),a):(a.push(h.text),a)}function Zn(h){if(h==null||h==="")return[];const a=Ct(h);return Cr(a)}const j=h=>JSON.parse(JSON.stringify(h)),f=Object.prototype.toString,g=h=>f.call(h).match(/\s([^\]]+)\]/).pop().toLowerCase(),S=new RegExp(`^("[^"]+"|${Qt})$`),C=["string","number","boolean","null"],P=/^\[\d*\]$/,M=/^\[(\d+)\]$/,Z=/^".+"$/,U=/(^\[\d*\]$|^\d+$)/;function he(h){return parseInt(h.replace(/^(\[|\]$)/,""))}function ue(h){return Z.test(h)?h.replace(/(^"|"$)/g,""):h}function Be(h,a,d){h.length<=a?h[a]=d:h.splice(a,0,d)}function ft(h,a){const d=[];return h.forEach(x=>d.push(...tr(x[0],a,kn.ALL))),d}function _e(h,a,d,x){const E=h[0];if(/^\[\]$/.test(a)){E.push(d);const F=E.length-1;return[E[F],F,E,`${h[3]}/${F}}`]}if(x==null&&g(E[a])==="object"&&g(d)==="object")return[E[a],a,E,`${h[3]}/${a}}`];if(x===sn.INSERT_ITEMS||x==null&&M.test(a)){const F=he(a);return Be(E,F,d),[E[F],F,E,`${h[3]}/${F}}`]}if(x===sn.REPLACE_ITEMS||x==null){const F=he(a);return E[F]=d,[E[F],F,E,`${h[3]}/${F}}`]}throw new Error(`Unknown array index '${a}' with force-option '${x}'`)}function on(h,a,d,x){return a=ue(a),h.filter(E=>Array.isArray(E[0])&&U.test(a)?!0:C.includes(g(E[0][a]))===!1).map(E=>{const F=d?[]:{},J=E[0];return Array.isArray(J)?_e(E,a,F,x):(J[a]=J[a]||F,[J[a],a,J,`${E[3]}/${a}`])})}var Gn;(function(h){h.REPLACE_ITEMS="replace",h.INSERT_ITEMS="insert"})(Gn||(Gn={})),sn.REPLACE_ITEMS=Gn.REPLACE_ITEMS,sn.INSERT_ITEMS=Gn.INSERT_ITEMS;function sn(h,a,d,x){if(a==null)return j(h);if(a=a.replace(/(\/$)/g,""),a==="")return j(d);const E=j(h);let F=[[E,null,null,"#"]];const J=Zn(a),_=J.pop(),de=P.test(_)&&M.test(_)===!1;if(S.test(_)===!1||de)throw new Error(`Unsupported query '${a}' ending with non-property`);return J.forEach((ie,Ce)=>{if(ie==="__proto__"||ie==="prototyped"||ie==="constructor")return;if(S.test(ie)===!1){F=ft(F,ie);return}const Ve=Ce>=J.length-1?_:J[Ce+1],dt=U.test(Ve);F=on(F,ie,dt,x)}),F.forEach(ie=>{let Ce=d;g(d)==="function"&&(Ce=d(ie[3],_,ie[0],`${ie[3]}/${_}`));const Ve=ie[0];if(Array.isArray(Ve))_e(ie,_,Ce,x);else{const dt=ue(_);if(dt==="__proto__"||dt==="prototyped"||dt==="constructor")return;Ve[dt]=Ce}}),E}function Rn(h,a,d=!1){const x=[],E=tr(h,a,kn.ALL);return E.forEach(function(F){x.push(F[0]),(0,Se.remove)(h,F[wt],!0)}),E.forEach(function(F){Array.isArray(F[bt])&&(0,Se.removeUndefinedItems)(F[bt])}),d?x:h}var Vr={get:tr,set:sn,split:Zn,remove:Rn,ReturnType:kn},nr={$ref:{type:!1},allOf:{type:!1,definitions:["allOf/*"]},anyOf:{type:!1,definitions:["anyOf/*"]},array:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not","items","items/*","additionalItems"],validationKeywords:["minItems","maxItems","uniqueItems"],keywords:["items","additionalItems","minItems","maxItems","uniqueItems"]},boolean:{type:!0},enum:{type:!1},integer:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minimum","maximum","multipleOf"]},not:{type:!1,definitions:["not"]},number:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minimum","maximum","multipleOf"]},null:{type:!0},object:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not","properties/*","additionalProperties","patternProperties/*","dependencies/*"],validationKeywords:["minProperties","maxProperties","required"],keywords:["properties","additionalProperties","patternProperties","dependencies","minProperties","maxProperties","required"]},oneOf:{type:!1,definitions:["oneOf/*"]},string:{type:!0,definitions:["allOf/*","anyOf/*","oneOf/*","not"],validationKeywords:["minLength","maxLength","pattern"]}};const Sn=h=>Object.prototype.toString.call(h)==="[object Object]",Ri=Object.keys(nr).filter(h=>nr[h].type===!1),Ii=Object.prototype.hasOwnProperty;function ci(h){if(Sn(h)===!1)return;if(h.enum)return"enum";if(nr[h.type]||Array.isArray(h.type))return h.type;const a=Ri.filter(d=>h[d]);if(a.length===1)return a[0];if(a.length===0){for(let d=0,x=nr.object.keywords.length;d<x;d+=1){const E=nr.object.keywords[d];if(Ii.call(h,E))return"object"}for(let d=0,x=nr.array.keywords.length;d<x;d+=1){const E=nr.array.keywords[d];if(Ii.call(h,E))return"array"}return}throw new Error(`Mutiple typeIds [${a.join(", ")}] matched in ${JSON.stringify(h)}`)}const bi=h=>Object.prototype.toString.call(h)==="[object Object]";function _i(h){const a=[],d=ci(h);if(d==null)return a;let x;if(Array.isArray(d)){x={};for(let E=0,F=d.length;E<F;E+=1)Object.assign(x,nr[d[E]])}else x=nr[d];return x.definitions==null||x.definitions.forEach(E=>{tr(h,E,(F,J,_,de)=>{bi(F)&&ci(F)&&a.push({pointer:$e().join($e().split(de),!1),def:F})})}),a}const B=h=>Object.prototype.toString.call(h)==="[object Object]";function b(h,a){if(this.callback(h,a)===!0)return;_i(h).forEach(x=>this.nextTypeDefs(x.def,$e().join(a,x.pointer,!1)))}function k(h,a,d,x="definitions"){const E=a[x];Object.keys(E).forEach(F=>{if(E[F]===!1||B(E[F])){h.nextTypeDefs(E[F],$e().join(d,x,F,!1));return}})}function $(h,a,d="#"){const x={callback:a,nextTypeDefs:b};x.nextTypeDefs(h,d),h.definitions!=null&&(x.callback=(E,F)=>{a(E,F),E.definitions!=null&&k(x,E,F)},k(x,h,d)),h.$defs!=null&&(x.callback=(E,F)=>{a(E,F),E.definitions!=null&&k(x,E,F)},k(x,h,d,"$defs"))}const H=/(#|\/)+$/,te=/#$/,oe=/^[^:]+:\/\/[^/]+\//,Re=/\/[^/]*$/,Te=/#.*$/;function kt(h,a){return h==null&&a==null?"#":a==null?h.replace(te,""):h==null?a.replace(te,""):a[0]==="#"?`${h.replace(Te,"")}${a.replace(H,"")}`:oe.test(a)?a.replace(te,""):`${h.replace(Re,"")}/${a.replace(te,"")}`}const Ot=/(#|\/)+$/g,cn=["",null,"#"];function Yn(h){if(cn.includes(h))return[];if(h=h.replace(Ot,""),h.indexOf("#")===-1)return[h.replace(Ot,"")];if(h.indexOf("#")===0)return[h.replace(Ot,"")];const a=h.split("#");return a[0]=a[0].replace(Ot,""),a[1]=`#${a[1].replace(Ot,"")}`,a}const Qn=/(#|\/)+$/g,vr=h=>Ge(h)==="object";function Un(h,a,d){if(vr(d)&&(d=d.__ref||d.$ref),d==null)return a;let x;const E=d.replace(Qn,"");if(h.remotes[E])return x=h.remotes[E],x&&x.$ref?Un(h,a,x.$ref):x;if(h.ids[d])return x=(0,Se.get)(a,h.ids[d]),x&&x.$ref?Un(h,a,x.$ref):x;const F=Yn(d);if(F.length===0)return a;if(F.length===1){if(d=F[0],h.remotes[d])return x=h.remotes[d],Un(h,a,x.$ref);if(h.ids[d])return x=(0,Se.get)(a,h.ids[d]),x&&x.$ref?Un(h,a,x.$ref):x}if(F.length===2){const J=F[0];if(d=F[1],h.remotes[J])return h.remotes[J].getRef?h.remotes[J].getRef(d):Un(h,h.remotes[J],d);if(h.ids[J])return Un(h,(0,Se.get)(a,h.ids[J]),d)}return x=(0,Se.get)(a,h.ids[d]||d),x&&x.$ref?Un(h,a,x.$ref):x}const xi="__compiled",Si="__ref",ms="getRef",Ws="getRoot",Hs=/(#|\/)+$/g;function es(h,a,d=a,x=!1){if(a===!0||a===!1||a===void 0||a[xi]!==void 0)return a;const E={ids:{},remotes:h.remotes},F=JSON.stringify(a),J=JSON.parse(F);if(Object.defineProperty(J,xi,{enumerable:!1,value:!0}),Object.defineProperty(J,ms,{enumerable:!1,value:Un.bind(null,E,J)}),x===!1&&F.includes("$ref")===!1)return J;J!==d&&Object.defineProperty(J,"$defs",{enumerable:!0,value:Object.assign({},d.definitions,d.$defs,J.definitions,J.$defs)});const _={},de=()=>J;return $(J,(ie,Ce)=>{var Ve;if(ie.$id){if(ie.$id.startsWith("http")&&/(allOf|anyOf|oneOf)\/\d+$/.test(Ce)){const _n=Ce.replace(/\/(allOf|anyOf|oneOf)\/\d+$/,""),Pr=(0,Se.get)(J,_n);ie.$id=(Ve=Pr.$id)!==null&&Ve!==void 0?Ve:ie.$id}E.ids[ie.$id.replace(Hs,"")]=Ce}Ce=`#${Ce}`.replace(/##+/,"#");const dt=Ce.replace(/\/[^/]+$/,""),Ht=Ce.replace(/\/[^/]+\/[^/]+$/,""),mn=_[dt]||_[Ht],en=kt(mn,ie.$id);_[Ce]=en,E.ids[en]==null&&(E.ids[en]=Ce),ie.$ref&&!ie[Si]&&(Object.defineProperty(ie,Si,{enumerable:!1,value:kt(en,ie.$ref)}),Object.defineProperty(ie,Ws,{enumerable:!1,value:de}))}),J}function As(h,a,d,x=h.rootSchema,E="#"){x=h.resolveRef(x),d(x,a,E);const F=Ge(a);F==="object"?Object.keys(a).forEach(J=>{const _=h.step(J,x,a,E),de=a[J];h.each(de,d,_,`${E}/${J}`)}):F==="array"&&a.forEach((J,_)=>{const de=h.step(_,x,a,E);h.each(J,d,de,`${E}/${_}`)})}var dn={additionalItemsError:Ae("AdditionalItemsError"),additionalPropertiesError:Ae("AdditionalPropertiesError"),anyOfError:Ae("AnyOfError"),allOfError:Ae("AllOfError"),constError:Ae("ConstError"),containsError:Ae("ContainsError"),containsArrayError:Ae("ContainsArrayError"),containsAnyError:Ae("ContainsAnyError"),enumError:Ae("EnumError"),formatURLError:Ae("FormatURLError"),formatURIError:Ae("FormatURIError"),formatURIReferenceError:Ae("FormatURIReferenceError"),formatURITemplateError:Ae("FormatURITemplateError"),formatDateError:Ae("FormatDateaError"),formatDateTimeError:Ae("FormatDateTimeError"),formatEmailError:Ae("FormatEmailError"),formatHostnameError:Ae("FormatHostnameError"),formatIPV4Error:Ae("FormatIPV4Error"),formatIPV4LeadingZeroError:Ae("FormatIPV4LeadingZeroError"),formatIPV6Error:Ae("FormatIPV6Error"),formatIPV6LeadingZeroError:Ae("FormatIPV6LeadingZeroError"),formatJSONPointerError:Ae("FormatJSONPointerError"),formatRegExError:Ae("FormatRegExError"),formatTimeError:Ae("FormatTimeError"),invalidSchemaError:Ae("InvalidSchemaError"),invalidDataError:Ae("InvalidDataError"),invalidTypeError:Ae("InvalidTypeError"),invalidPropertyNameError:Ae("InvalidPropertyNameError"),maximumError:Ae("MaximumError"),maxItemsError:Ae("MaxItemsError"),maxLengthError:Ae("MaxLengthError"),maxPropertiesError:Ae("MaxPropertiesError"),minimumError:Ae("MinimumError"),minItemsError:Ae("MinItemsError"),minItemsOneError:Ae("MinItemsOneError"),minLengthError:Ae("MinLengthError"),minLengthOneError:Ae("MinLengthOneError"),minPropertiesError:Ae("MinPropertiesError"),missingDependencyError:Ae("MissingDependencyError"),missingOneOfPropertyError:Ae("MissingOneOfPropertyError"),multipleOfError:Ae("MultipleOfError"),multipleOneOfError:Ae("MultipleOneOfError"),noAdditionalPropertiesError:Ae("NoAdditionalPropertiesError"),notError:Ae("NotError"),oneOfError:Ae("OneOfError"),oneOfPropertyError:Ae("OneOfPropertyError"),patternError:Ae("PatternError"),patternPropertiesError:Ae("PatternPropertiesError"),requiredPropertyError:Ae("RequiredPropertyError"),typeError:Ae("TypeError"),undefinedValueError:Ae("UndefinedValueError"),uniqueItemsError:Ae("UniqueItemsError"),unknownPropertyError:Ae("UnknownPropertyError"),valueNotEmptyError:Ae("ValueNotEmptyError")},Zs=z(1170),fi=z.n(Zs);const zi=new RegExp("^([0-9]+)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?(([Zz])|([\\+|\\-]([01][0-9]|2[0-3]):[0-5][0-9]))$"),Us=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ts=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,Ts=/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,Ks=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,ns=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,rs=[0,31,28,31,30,31,30,31,31,30,31,30,31],Js=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Gs=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,Cn=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Ms=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i;var X={date:(h,a,d,x)=>{if(typeof d!="string")return;const E=d.match(Ks);if(!E)return dn.formatDateTimeError({value:d,pointer:x});const F=+E[1],J=+E[2],_=+E[3],de=F%4===0&&(F%100!==0||F%400===0);if(!(J>=1&&J<=12&&_>=1&&_<=(J==2&&de?29:rs[J])))return dn.formatDateError({value:d,pointer:x})},"date-time":(h,a,d,x)=>{if(typeof d=="string")return d===""||zi.test(d)?new Date(d).toString()==="Invalid Date"?dn.formatDateTimeError({value:d,pointer:x}):void 0:dn.formatDateTimeError({value:d,pointer:x})},email:(h,a,d,x)=>{if(typeof d!="string")return;if(d[0]==='"')return dn.formatEmailError({value:d,pointer:x});const[E,F,...J]=d.split("@");if(!E||!F||J.length!==0||E.length>64||F.length>253)return dn.formatEmailError({value:d,pointer:x});if(E[0]==="."||E.endsWith(".")||E.includes(".."))return dn.formatEmailError({value:d,pointer:x});if(!/^[a-z0-9.-]+$/i.test(F)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(E))return dn.formatEmailError({value:d,pointer:x});if(!F.split(".").every(_=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(_)))return dn.formatEmailError({value:d,pointer:x})},hostname:(h,a,d,x)=>{if(typeof d=="string"&&!(d===""||Ts.test(d)))return dn.formatHostnameError({value:d,pointer:x})},ipv4:(h,a,d,x)=>{if(!(typeof d!="string"||d==="")){if(d&&d[0]==="0")return dn.formatIPV4LeadingZeroError({value:d,pointer:x});if(!(d.length<=15&&Us.test(d)))return dn.formatIPV4Error({value:d,pointer:x})}},ipv6:(h,a,d,x)=>{if(!(typeof d!="string"||d==="")){if(d&&d[0]==="0")return dn.formatIPV6LeadingZeroError({value:d,pointer:x});if(!(d.length<=45&&ts.test(d)))return dn.formatIPV6Error({value:d,pointer:x})}},"json-pointer":(h,a,d,x)=>{if(!(typeof d!="string"||d==="")&&!Js.test(d))return dn.formatJSONPointerError({value:d,pointer:x})},"relative-json-pointer":(h,a,d,x)=>{if(!(typeof d!="string"||d==="")&&!Gs.test(d))return dn.formatJSONPointerError({value:d,pointer:x})},regex:(h,a,d,x)=>{if(typeof d=="string"&&/\\Z$/.test(d)===!1){try{new RegExp(d);return}catch{}return dn.formatRegExError({value:d,pointer:x})}if(!(typeof d=="object"||typeof d=="number"||Array.isArray(d)))return dn.formatRegExError({value:d,pointer:x})},time:(h,a,d,x)=>{if(typeof d!="string")return;const E=d.match(ns);if(!E)return dn.formatDateTimeError({value:d,pointer:x});const F=+E[1],J=+E[2],_=+E[3],de=!!E[5];if(!((F<=23&&J<=59&&_<=59||F==23&&J==59&&_==60)&&de))return dn.formatTimeError({value:d,pointer:x})},uri:(h,a,d,x)=>{if(!(typeof d!="string"||d==="")&&!fi().isUri(d))return dn.formatURIError({value:d,pointer:x})},"uri-reference":(h,a,d,x)=>{if(!(typeof d!="string"||d==="")&&!Cn.test(d))return dn.formatURIReferenceError({value:d,pointer:x})},"uri-template":(h,a,d,x)=>{if(!(typeof d!="string"||d==="")&&!Ms.test(d))return dn.formatURITemplateError({value:d,pointer:x})},url:(h,a,d,x)=>{if(!(d===""||fi().isWebUri(d)))return dn.formatURLError({value:d,pointer:x})}};function ae(h){switch(Ge(h)){case"string":case"array":return h.length===0;case"null":case"undefined":return!0;case"object":return Object.keys(h).length===0;default:return!1}}const be={addOptionalProps:!0,removeInvalidData:!1};let Pe;function ct(h,a){const{$ref:d}=h;return d==null?!0:(Pe[a]==null||Pe[a][d]==null?0:Pe[a][d])<Pt.GET_TEMPLATE_RECURSION_LIMIT}function it(h,a,d){if(d==null)throw new Error(`missing pointer ${d}`);const{$ref:x}=a;return x==null?a:(Pe[d]=Pe[d]||{},Pe[d][x]=Pe[d][x]||0,Pe[d][x]+=1,h.resolveRef(a))}function Nt(h,a){if(h==="string")return JSON.stringify(a);if(typeof a!="string")return null;try{if(a=JSON.parse(a),typeof a===h)return a}catch{}return null}function On(h,a,d,x){if(Ge(a)!=="object")return Object.assign({pointer:x},a);if(ct(a,x)===!1&&d==null)return!1;let E=In(it(h,a,x));if(Array.isArray(a.anyOf)&&a.anyOf.length>0){if(ct(a.anyOf[0],`${x}/anyOf/0`)){const F=it(h,a.anyOf[0],`${x}/anyOf/0`);E=rn(E,F),E.pointer=a.anyOf[0].$ref||E.pointer}delete E.anyOf}if(Array.isArray(a.allOf)){for(let F=0,J=a.allOf.length;F<J;F+=1)ct(a.allOf[F],`${x}/allOf/${F}`)&&(E=rn(E,it(h,a.allOf[F],`${x}/allOf/${F}`)),E.pointer=a.allOf[F].$ref||E.pointer);delete E.allOf}return E.pointer=E.pointer||a.$ref||x,E}const qt=h=>h&&typeof h=="object";function Dt(h,a,d,x,E){if(d==null)throw new Error(`getTemplate: missing schema for data: ${JSON.stringify(a)}`);if(x==null)throw new Error("Missing pointer");let F=On(h,d,a,x);if(!qt(F))return;if(x=F.pointer,F!=null&&F.const)return F.const;if(Array.isArray(F.oneOf))if(ae(a)){const ie=F.oneOf[0].type||F.type||F.const&&typeof F.const||Ge(a);F={...F.oneOf[0],type:ie}}else{const ie=pe(h,a,F);if(lt(ie)){if(a!=null&&E.removeInvalidData!==!0)return a;F=F.oneOf[0],a=void 0}else F=ie}if(!qt(F)||F.type==null)return;const J=Array.isArray(F.type)?xt(F.type,a,F.default):F.type,_=Ge(a);return a!=null&&_!==J&&!(_==="number"&&J==="integer")&&(a=Nt(J,a)),At[J]==null?E.removeInvalidData?void 0:a:At[J](h,F,a,x,E)}function xt(h,a,d){if(a==null){if(d!=null){const E=Ge(d);if(h.includes(E))return E}return h[0]}const x=Ge(a);return h.includes(x)?x:h[0]}const At={null:(h,a,d)=>ln(a,d,null),string:(h,a,d)=>ln(a,d,""),number:(h,a,d)=>ln(a,d,0),integer:(h,a,d)=>ln(a,d,0),boolean:(h,a,d)=>ln(a,d,!1),object:(h,a,d,x,E)=>{var F;const J=a.default===void 0?{}:a.default,_={},de=(F=a.required)!==null&&F!==void 0?F:[];if(a.properties&&Object.keys(a.properties).forEach(ie=>{const Ce=d==null||d[ie]==null?J[ie]:d[ie],Ve=de.includes(ie);(Ce!=null||Ve||E.addOptionalProps)&&(_[ie]=Dt(h,Ce,a.properties[ie],`${x}/properties/${ie}`,E))}),a.dependencies&&Object.keys(a.dependencies).forEach(ie=>{if(_[ie]===void 0)return;const Ce=a.dependencies[ie];if(Array.isArray(Ce)){Ce.forEach(dt=>{_[dt]=Dt(h,_[dt],a.properties[dt],`${x}/properties/${dt}`,E)});return}if(Ge(Ce)!=="object")return;const Ve=Dt(h,d,{...Ce,type:"object"},`${x}/dependencies/${ie}`,E);Ve&&!lt(Ve)&&Object.assign(_,Ve)}),d&&Object.keys(d).forEach(ie=>_[ie]==null&&(_[ie]=d[ie])),a.if&&(a.then||a.else)){const ie=h.isValid(_,a.if);if(ie&&a.then){const Ce=h.getTemplate(_,{type:"object",...a.then},E);Object.assign(_,Ce)}else if(!ie&&a.else){const Ce=h.getTemplate(_,{type:"object",...a.else},E);Object.assign(_,Ce)}}return _},array:(h,a,d,x,E)=>{var F,J,_;const de=a.default===void 0?[]:a.default;a.minItems=a.minItems||0;const ie=d||[];if(a.items==null)return ie;if(Array.isArray(a.items)){for(let Ve=0,dt=Math.max((F=a.minItems)!==null&&F!==void 0?F:0,(_=(J=a.items)===null||J===void 0?void 0:J.length)!==null&&_!==void 0?_:0);Ve<dt;Ve+=1)ie[Ve]=Dt(h,ie[Ve]==null?de[Ve]:ie[Ve],a.items[Ve],`${x}/items/${Ve}`,E);return ie}if(Ge(a.items)!=="object")return ie;const Ce=On(h,a.items,d,x);if(Ce===!1)return ie;if(x=Ce.pointer||x,Ce.oneOf&&ie.length===0){const Ve=Ce.oneOf[0];for(let dt=0;dt<a.minItems;dt+=1)ie[dt]=Dt(h,ie[dt]==null?de[dt]:ie[dt],Ve,`${x}/oneOf/0`,E);return ie}if(Ce.oneOf&&ie.length>0){const Ve=Math.max(a.minItems,ie.length);for(let dt=0;dt<Ve;dt+=1){let Ht=ie[dt]==null?de[dt]:ie[dt],mn=pe(h,Ht,Ce);mn==null||lt(mn)?Ht!=null&&E.removeInvalidData!==!0?ie[dt]=Ht:(Ht=void 0,mn=Ce.oneOf[0],ie[dt]=Dt(h,Ht,mn,`${x}/oneOf/${dt}`,E)):ie[dt]=Dt(h,Ht,mn,`${x}/oneOf/${dt}`,E)}return ie}if(Ce.type){for(let Ve=0,dt=Math.max(a.minItems,ie.length);Ve<dt;Ve+=1)ie[Ve]=Dt(h,ie[Ve]==null?de[Ve]:ie[Ve],Ce,`${x}/items`,E);return ie}return ie}};function ln(h,a,d){return a!=null?a:h.const?h.const:h.default===void 0&&Array.isArray(h.enum)?h.enum[0]:h.default===void 0?d:h.default}var Nn=(h,a,d=h.rootSchema,x=be)=>(Pe={mi:{}},Dt(h,a,d,"#",x));function Fn(h,a,d=h.rootSchema,x="#"){return h.validate(a,d,x).length===0}function rr(h,a){const d=typeof h;if(d!==typeof a)return!1;if(Array.isArray(h)){if(!Array.isArray(a))return!1;const x=h.length;if(x!==a.length)return!1;for(let E=0;E<x;E++)if(!rr(h[E],a[E]))return!1;return!0}if(d==="object"){if(!h||!a)return h===a;const x=Object.keys(h),E=Object.keys(a);if(x.length!==E.length)return!1;for(const J of x)if(!rr(h[J],a[J]))return!1;return!0}return h===a}function Or(h){const a=[];let d=0;const x=h.length;for(;d<x;){const E=h.charCodeAt(d++);if(E>=55296&&E<=56319&&d<x){const F=h.charCodeAt(d++);(F&64512)==56320?a.push(((E&1023)<<10)+(F&1023)+65536):(a.push(E),d--)}else a.push(E)}return a}const Rr=Pt.floatingPointPrecision,ir=Object.prototype.hasOwnProperty,hr=(h,a)=>!(h[a]===void 0||!ir.call(h,a));var fn={additionalProperties:(h,a,d,x)=>{if(a.additionalProperties===!0||a.additionalProperties==null||Ge(a.patternProperties)==="object"&&a.additionalProperties===!1)return;const E=[];let F=Object.keys(d).filter(_=>Pt.propertyBlacklist.includes(_)===!1);const J=Object.keys(a.properties||{});if(Ge(a.patternProperties)==="object"){const _=Object.keys(a.patternProperties).map(de=>new RegExp(de));F=F.filter(de=>{for(let ie=0;ie<_.length;ie+=1)if(_[ie].test(de))return!1;return!0})}for(let _=0,de=F.length;_<de;_+=1){const ie=F[_];if(J.indexOf(ie)===-1){const Ce=typeof a.additionalProperties=="object";if(Ce&&Array.isArray(a.additionalProperties.oneOf)){const Ve=h.resolveOneOf(d[ie],a.additionalProperties,`${x}/${ie}`);lt(Ve)?E.push(h.errors.additionalPropertiesError({schema:a.additionalProperties,property:F[_],properties:J,pointer:x,errors:Ve.data.errors})):E.push(...h.validate(d[ie],Ve,x))}else Ce?E.push(...h.validate(d[ie],a.additionalProperties,`${x}/${ie}`)):E.push(h.errors.noAdditionalPropertiesError({property:F[_],properties:J,pointer:x}))}}return E},allOf:(h,a,d,x)=>{if(Array.isArray(a.allOf)===!1)return;const E=[];return a.allOf.forEach(F=>{E.push(...h.validate(d,F,x))}),E},anyOf:(h,a,d,x)=>{if(Array.isArray(a.anyOf)!==!1){for(let E=0;E<a.anyOf.length;E+=1)if(h.isValid(d,a.anyOf[E]))return;return h.errors.anyOfError({anyOf:a.anyOf,value:d,pointer:x})}},dependencies:(h,a,d,x)=>{if(Ge(a.dependencies)!=="object")return;const E=[];return Object.keys(d).forEach(F=>{if(a.dependencies[F]===void 0||a.dependencies[F]===!0)return;if(a.dependencies[F]===!1){E.push(h.errors.missingDependencyError({pointer:x}));return}let J;const _=Ge(a.dependencies[F]);if(_==="array")J=a.dependencies[F].filter(de=>d[de]===void 0).map(de=>h.errors.missingDependencyError({missingProperty:de,pointer:x}));else if(_==="object")J=h.validate(d,a.dependencies[F],x);else throw new Error(`Invalid dependency definition for ${x}/${F}. Must be list or schema`);E.push(...J)}),E.length>0?E:void 0},enum:(h,a,d,x)=>{const E=Ge(d);if(E==="object"||E==="array"){const F=JSON.stringify(d);for(let J=0;J<a.enum.length;J+=1)if(JSON.stringify(a.enum[J])===F)return}else if(a.enum.includes(d))return;return h.errors.enumError({values:a.enum,value:d,pointer:x})},format:(h,a,d,x)=>{if(h.validateFormat[a.format])return h.validateFormat[a.format](h,a,d,x)},items:(h,a,d,x)=>{if(a.items===!1)return Array.isArray(d)&&d.length===0?void 0:h.errors.invalidDataError({pointer:x,value:d});const E=[];for(let F=0;F<d.length;F+=1){const J=d[F],_=h.step(F,a,d,x);if(lt(_))return[_];const de=h.validate(J,_,`${x}/${F}`);E.push(...de)}return E},maximum:(h,a,d,x)=>{if(!isNaN(a.maximum)){if(a.maximum&&a.maximum<d)return h.errors.maximumError({maximum:a.maximum,length:d,pointer:x});if(a.maximum&&a.exclusiveMaximum===!0&&a.maximum===d)return h.errors.maximumError({maximum:a.maximum,length:d,pointer:x})}},maxItems:(h,a,d,x)=>{if(!isNaN(a.maxItems)&&a.maxItems<d.length)return h.errors.maxItemsError({maximum:a.maxItems,length:d.length,pointer:x})},maxLength:(h,a,d,x)=>{if(isNaN(a.maxLength))return;const E=Or(d).length;if(a.maxLength<E)return h.errors.maxLengthError({maxLength:a.maxLength,length:E,pointer:x})},maxProperties:(h,a,d,x)=>{const E=Object.keys(d).length;if(isNaN(a.maxProperties)===!1&&a.maxProperties<E)return h.errors.maxPropertiesError({maxProperties:a.maxProperties,length:E,pointer:x})},minLength:(h,a,d,x)=>{if(isNaN(a.minLength))return;const E=Or(d).length;if(a.minLength>E)return a.minLength===1?h.errors.minLengthOneError({minLength:a.minLength,length:E,pointer:x}):h.errors.minLengthError({minLength:a.minLength,length:E,pointer:x})},minimum:(h,a,d,x)=>{if(!isNaN(a.minimum)){if(a.minimum>d)return h.errors.minimumError({minimum:a.minimum,length:d,pointer:x});if(a.exclusiveMinimum===!0&&a.minimum===d)return h.errors.minimumError({minimum:a.minimum,length:d,pointer:x})}},minItems:(h,a,d,x)=>{if(!isNaN(a.minItems)&&a.minItems>d.length)return a.minItems===1?h.errors.minItemsOneError({minItems:a.minItems,length:d.length,pointer:x}):h.errors.minItemsError({minItems:a.minItems,length:d.length,pointer:x})},minProperties:(h,a,d,x)=>{if(isNaN(a.minProperties))return;const E=Object.keys(d).length;if(a.minProperties>E)return h.errors.minPropertiesError({minProperties:a.minProperties,length:E,pointer:x})},multipleOf:(h,a,d,x)=>{if(!isNaN(a.multipleOf)&&d*Rr%(a.multipleOf*Rr)/Rr!==0)return h.errors.multipleOfError({multipleOf:a.multipleOf,value:d,pointer:x})},not:(h,a,d,x)=>{const E=[];return h.validate(d,a.not,x).length===0&&E.push(h.errors.notError({value:d,not:a.not,pointer:x})),E},oneOf:(h,a,d,x)=>{if(Array.isArray(a.oneOf)!==!1&&(a=h.resolveOneOf(d,a,x),lt(a)))return a},pattern:(h,a,d,x)=>{if(new RegExp(a.pattern,"u").test(d)===!1)return h.errors.patternError({pattern:a.pattern,description:a.patternExample||a.pattern,received:d,pointer:x})},patternProperties:(h,a,d,x)=>{const E=a.properties||{},F=a.patternProperties;if(Ge(F)!=="object")return;const J=[],_=Object.keys(d),de=Object.keys(F).map(ie=>({regex:new RegExp(ie),patternSchema:F[ie]}));return _.forEach(ie=>{let Ce=!1;for(let Ve=0,dt=de.length;Ve<dt;Ve+=1)if(de[Ve].regex.test(ie)){Ce=!0;const Ht=h.validate(d[ie],de[Ve].patternSchema,`${x}/${ie}`);Ht&&Ht.length>0&&J.push(...Ht)}E[ie]||Ce===!1&&a.additionalProperties===!1&&J.push(h.errors.patternPropertiesError({key:ie,pointer:x,patterns:Object.keys(F).join(",")}))}),J},properties:(h,a,d,x)=>{const E=[],F=Object.keys(a.properties||{});for(let J=0;J<F.length;J+=1){const _=F[J];if(hr(d,_)){const de=h.step(_,a,d,x),ie=h.validate(d[_],de,`${x}/${_}`);E.push(...ie)}}return E},propertiesRequired:(h,a,d,x)=>{const E=[],F=Object.keys(a.properties||{});for(let J=0;J<F.length;J+=1){const _=F[J];if(d[_]===void 0)E.push(h.errors.requiredPropertyError({key:_,pointer:x}));else{const de=h.step(_,a,d,x),ie=h.validate(d[_],de,`${x}/${_}`);E.push(...ie)}}return E},required:(h,a,d,x)=>{if(Array.isArray(a.required)!==!1)return a.required.map(E=>{if(!hr(d,E))return h.errors.requiredPropertyError({key:E,pointer:x})})},requiredNotEmpty:(h,a,d,x)=>{if(Array.isArray(a.required)!==!1)return a.required.map(E=>{if(d[E]==null||d[E]==="")return h.errors.valueNotEmptyError({property:E,pointer:`${x}/${E}`})})},uniqueItems:(h,a,d,x)=>{if((Array.isArray(d)&&a.uniqueItems)===!1)return;const E=[];return d.forEach((F,J)=>{for(let _=J+1;_<d.length;_+=1)rr(F,d[_])&&E.push(h.errors.uniqueItemsError({pointer:x,itemPointer:`${x}/${J}`,duplicatePointer:`${x}/${_}`,value:JSON.stringify(F)}))}),E}},Ar={...fn,contains:(h,a,d,x)=>{if(a.contains===!1)return h.errors.containsArrayError({pointer:x,value:d});if(a.contains===!0)return Array.isArray(d)&&d.length===0?h.errors.containsAnyError({pointer:x}):void 0;if(Ge(a.contains)==="object"){for(let E=0;E<d.length;E+=1)if(h.isValid(d[E],a.contains))return;return h.errors.containsError({pointer:x,schema:JSON.stringify(a.contains)})}},exclusiveMaximum:(h,a,d,x)=>{if(!isNaN(a.exclusiveMaximum)&&a.exclusiveMaximum<=d)return h.errors.maximumError({maximum:a.exclusiveMaximum,length:d,pointer:x})},exclusiveMinimum:(h,a,d,x)=>{if(!isNaN(a.exclusiveMinimum)&&a.exclusiveMinimum>=d)return h.errors.minimumError({minimum:a.exclusiveMinimum,length:d,pointer:x})},if:(h,a,d,x)=>{if(a.if==null)return;const E=h.validate(d,a.if,x);if(E.length===0&&a.then)return h.validate(d,a.then,x);if(E.length!==0&&a.else)return h.validate(d,a.else,x)},maximum:(h,a,d,x)=>{if(!isNaN(a.maximum)&&a.maximum&&a.maximum<d)return h.errors.maximumError({maximum:a.maximum,length:d,pointer:x})},minimum:(h,a,d,x)=>{if(!isNaN(a.minimum)&&a.minimum>d)return h.errors.minimumError({minimum:a.minimum,length:d,pointer:x})},patternProperties:(h,a,d,x)=>{const E=a.properties||{},F=a.patternProperties;if(Ge(F)!=="object")return;const J=[],_=Object.keys(d),de=Object.keys(F).map(ie=>({regex:new RegExp(ie),patternSchema:F[ie]}));return _.forEach(ie=>{let Ce=!1;for(let Ve=0,dt=de.length;Ve<dt;Ve+=1)if(de[Ve].regex.test(ie)){if(Ce=!0,de[Ve].patternSchema===!1){J.push(h.errors.patternPropertiesError({key:ie,pointer:x,patterns:Object.keys(F).join(",")}));return}const Ht=h.validate(d[ie],de[Ve].patternSchema,`${x}/${ie}`);Ht&&Ht.length>0&&J.push(...Ht)}E[ie]||Ce===!1&&a.additionalProperties===!1&&J.push(h.errors.patternPropertiesError({key:ie,pointer:x,patterns:Object.keys(F).join(",")}))}),J},propertyNames:(h,a,d,x)=>{if(a.propertyNames===!1)return Object.keys(d).length===0?void 0:h.errors.invalidPropertyNameError({property:Object.keys(d),pointer:x,value:d});if(a.propertyNames===!0||Ge(a.propertyNames)!=="object")return;const E=[],F=Object.keys(d),J={...a.propertyNames,type:"string"};return F.forEach(_=>{const de=h.validate(_,J,`${x}/${_}`);de.length>0&&E.push(h.errors.invalidPropertyNameError({property:_,pointer:x,validationError:de[0],value:d[_]}))}),E}};function Wr(h,a,d=h.rootSchema,x="#"){let E=!1,F=In(d);for(let J=0;J<d.anyOf.length;J+=1){const _=h.resolveRef(d.anyOf[J]);h.isValid(a,d.anyOf[J],x)&&(E=!0,F=rn(F,_))}return E===!1?dn.anyOfError({value:a,pointer:x,anyOf:JSON.stringify(d.anyOf)}):(delete F.anyOf,F)}function Xr(h,a){return h==null||h.$ref==null?h:h.getRoot?h.getRoot().getRef(h):a.getRef(h)}function Kn(h){const a={type:Ge(h)};return a.type==="object"&&(a.properties={},Object.keys(h).forEach(d=>a.properties[d]=Kn(h[d]))),a.type==="array"&&h.length===1?a.items=Kn(h[0]):a.type==="array"&&(a.items=h.map(Kn)),a}function Ni(h,a,d=h.rootSchema){const x=h.step(a,d,{},"#");return lt(x)?x.code==="one-of-error"?x.data.oneOf.map(E=>h.resolveRef(E)):x:[x]}const pn={array:(h,a,d,x,E)=>{const F=Ge(d.items);if(F==="object")return Array.isArray(d.items.oneOf)?h.resolveOneOf(x[a],d.items,E):Array.isArray(d.items.anyOf)?h.resolveAnyOf(x[a],d.items,E):Array.isArray(d.items.allOf)?h.resolveAllOf(x[a],d.items,E):h.resolveRef(d.items);if(F==="array"){if(d.items[a]===!0)return Kn(x[a]);if(d.items[a]===!1)return dn.invalidDataError({key:a,value:x[a],pointer:E});if(d.items[a])return h.resolveRef(d.items[a]);if(d.additionalItems===!1)return dn.additionalItemsError({key:a,value:x[a],pointer:E});if(d.additionalItems===!0||d.additionalItems===void 0)return Kn(x[a]);if(Ge(d.additionalItems)==="object")return d.additionalItems;throw new Error(`Invalid schema ${JSON.stringify(d,null,4)} for ${JSON.stringify(x,null,4)}`)}return d.additionalItems!==!1&&x[a]?Kn(x[a]):new Error(`Invalid array schema for ${a} at ${E}`)},object:(h,a,d,x,E)=>{if(Array.isArray(d.oneOf)){const _=h.resolveOneOf(x,d,E);if(d=rn(d,_),lt(d))return d}if(Array.isArray(d.anyOf)&&(d=h.resolveAnyOf(x,d,E),lt(d))||Array.isArray(d.allOf)&&(d=h.resolveAllOf(x,d,E),lt(d)))return d;let F;if(d.properties&&d.properties[a]!==void 0){if(F=h.resolveRef(d.properties[a]),lt(F))return F;if(F&&Array.isArray(F.oneOf)){let _=h.resolveOneOf(x[a],F,`${E}/${a}`);const de=F.oneOf.findIndex(ie=>ie===_);return _.variableSchema=!0,_.oneOfIndex=de,_.oneOfSchema=F,_}if(F)return F}const{dependencies:J}=d;if(Ge(J)==="object"){const _=Object.keys(J).filter(de=>Ge(J[de])==="object");for(let de=0,ie=_.length;de<ie;de+=1){const Ce=_[de],Ve=Ut(h,a,J[Ce],x,`${E}/${Ce}`);if(!lt(Ve))return Ve}}if(d.if&&(d.then||d.else)){const _=h.isValid(x,d.if);if(_&&d.then){const de=Ut(h,a,d.then,x,E);if(typeof de.type=="string"&&de.type!=="error")return de}if(!_&&d.else){const de=Ut(h,a,d.else,x,E);if(typeof de.type=="string"&&de.type!=="error")return de}}if(Ge(d.patternProperties)==="object"){let _;const de=Object.keys(d.patternProperties);for(let ie=0,Ce=de.length;ie<Ce;ie+=1)if(_=new RegExp(de[ie]),_.test(a))return d.patternProperties[de[ie]]}return Ge(d.additionalProperties)==="object"?d.additionalProperties:d.additionalProperties===!0?Kn(x[a]):dn.unknownPropertyError({property:a,value:x,pointer:`${E}`})}};function Ut(h,a,d,x,E="#"){if(Array.isArray(d.type)){const _=Ge(x);return d.type.includes(_)?pn[_](h,`${a}`,d,x,E):h.errors.typeError({value:x,pointer:E,expected:d.type,received:_})}const F=d.type||Ge(x),J=pn[F];return J?J(h,`${a}`,d,x,E):new Error(`Unsupported schema type ${d.type} for key ${a}`)}var qn={array:(h,a,d,x)=>h.typeKeywords.array.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),object:(h,a,d,x)=>h.typeKeywords.object.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),string:(h,a,d,x)=>h.typeKeywords.string.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),integer:(h,a,d,x)=>h.typeKeywords.number.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),number:(h,a,d,x)=>h.typeKeywords.number.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),boolean:(h,a,d,x)=>h.typeKeywords.boolean.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),null:(h,a,d,x)=>h.typeKeywords.null.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x))},Zi=z(69378),wn=z.n(Zi);function $n(h,a){const d=Ge(h);return d==="number"&&(a==="integer"||Array.isArray(a)&&a.includes("integer"))?Number.isInteger(h)||isNaN(h)?"integer":"number":d}function hi(h,a,d=h.rootSchema,x="#"){if(d=h.resolveRef(d),Ge(d)==="boolean")return d?[]:[h.errors.invalidDataError({value:a,pointer:x})];if(lt(d))return[d];if(d.const!==void 0)return wn()(d.const,a)?[]:[h.errors.constError({value:a,expected:d.const,pointer:x})];const E=$n(a,d.type),F=d.type||E;return E!==F&&(!Array.isArray(F)||!F.includes(E))?[h.errors.typeError({received:E,expected:F,value:a,pointer:x})]:h.validateType[E]==null?[h.errors.invalidTypeError({receivedType:E,pointer:x})]:vt(h.validateType[E](h,d,a,x)).filter(xe)}class Ui{constructor(a,d){this.remotes={},this.errors={},this.typeKeywords={},this.validateKeyword={},this.validateType={},this.validateFormat={},this.config=a,this.typeKeywords=JSON.parse(JSON.stringify(a.typeKeywords)),this.validateKeyword=Object.assign({},a.validateKeyword),this.validateType=Object.assign({},a.validateType),this.validateFormat=Object.assign({},a.validateFormat),this.errors=Object.assign({},a.errors),this.setSchema(d)}get rootSchema(){return this.__rootSchema}set rootSchema(a){a!=null&&(this.__rootSchema=this.config.compileSchema(this,a))}addRemoteSchema(a,d){this.config.addRemoteSchema(this,a,d)}compileSchema(a){var d;return this.config.compileSchema(this,a,(d=this.rootSchema)!==null&&d!==void 0?d:a)}createSchemaOf(a){return this.config.createSchemaOf(a)}each(a,d,x,E){return this.config.each(this,a,d,x,E)}eachSchema(a,d=this.rootSchema){return this.config.eachSchema(d,a)}getChildSchemaSelection(a,d){return this.config.getChildSchemaSelection(this,a,d)}getSchema(a="#",d,x){return this.config.getSchema(this,a,d,x)}getTemplate(a,d,x){return this.config.getTemplate(this,a,d,x)}isValid(a,d,x){return this.config.isValid(this,a,d,x)}resolveAnyOf(a,d,x){return this.config.resolveAnyOf(this,a,d,x)}resolveAllOf(a,d,x){return this.config.resolveAllOf(this,a,d,x)}resolveRef(a){return this.config.resolveRef(a,this.rootSchema)}resolveOneOf(a,d,x){return this.config.resolveOneOf(this,a,d,x)}setSchema(a){this.rootSchema=a}step(a,d,x,E){return this.config.step(this,a,d,x,E)}validate(a,d,x){return this.config.validate(this,a,d,x)}}const ur={typeKeywords:{array:["allOf","anyOf","contains","enum","if","items","maxItems","minItems","not","oneOf","uniqueItems"],boolean:["allOf","anyOf","enum","not","oneOf"],object:["additionalProperties","allOf","anyOf","dependencies","enum","format","if","maxProperties","minProperties","not","oneOf","patternProperties","properties","propertyNames","required"],string:["allOf","anyOf","enum","format","if","maxLength","minLength","not","oneOf","pattern"],number:["allOf","anyOf","enum","exclusiveMaximum","exclusiveMinimum","format","if","maximum","minimum","multipleOf","not","oneOf"],null:["allOf","anyOf","enum","format","not","oneOf"]},validateKeyword:Ar,validateType:qn,validateFormat:X,errors:dn,addRemoteSchema:zt,compileSchema:es,createSchemaOf:Kn,each:As,eachSchema:$,getChildSchemaSelection:Ni,getSchema:ut,getTemplate:Nn,isValid:Fn,resolveAllOf:W,resolveAnyOf:Wr,resolveOneOf:Zt,resolveRef:Xr,step:Ut,validate:hi};class br extends Ui{constructor(a,d={}){super(rn(ur,d),a)}}const Hr={...ur,resolveOneOf:pe,resolveRef:at};class Ir extends null{constructor(a,d={}){super(merge(Hr,d),a)}}class Ps{constructor(a,d){this.core=new Core(a),this.schema=a,this.data=d,this.cache={}}updateData(a){this.data=a,this.cache={}}updateSchema(a){this.schema=a,this.core.setSchema(a),this.cache={}}get(a,d){if(d){const _=getSchema(this.core,a,d,this.schema);return copy(_)}if(a==="#")return this.schema;if(this.cache[a])return this.cache[a];const x=gp.join(a,"..");let E=this.cache[x];E==null&&(E=getSchema(this.core,x,this.data,this.schema),E.variableSchema!==!0&&(this.cache[x]=copy(E)));const F=gp.split(a).pop();let J=getSchema(this.core,F,gp.get(this.data,x),this.cache[x]);return J=copy(J),J.variableSchema!==!0&&(this.cache[a]=J),J}}const zr="__compiled",si="__ref",Bi="getRef",ui="getRoot",Yr=/(#|\/)+$/g;function Qr(h,a,d=a,x=!1){if(!a||a[zr]!==void 0)return a;const E={ids:{},remotes:h.remotes},F=JSON.stringify(a),J=JSON.parse(F);if(Object.defineProperty(J,zr,{enumerable:!1,value:!0}),Object.defineProperty(J,Bi,{enumerable:!1,value:Un.bind(null,E,J)}),x===!1&&F.includes("$ref")===!1)return J;a!==d&&Object.defineProperty(J,"definitions",{enumerable:!1,value:Object.assign({},d.definitions,d.$defs,a.definitions,a.$defs)});const _={},de=()=>J;return $(J,(ie,Ce)=>{var Ve;if(ie.id){if(ie.id.startsWith("http")&&/(allOf|anyOf|oneOf)\/\d+$/.test(Ce)){const _n=Ce.replace(/\/(allOf|anyOf|oneOf)\/\d+$/,""),Pr=(0,Se.get)(J,_n);ie.id=(Ve=Pr.id)!==null&&Ve!==void 0?Ve:ie.id}E.ids[ie.id.replace(Yr,"")]=Ce}Ce=`#${Ce}`.replace(/##+/,"#");const dt=Ce.replace(/\/[^/]+$/,""),Ht=Ce.replace(/\/[^/]+\/[^/]+$/,""),mn=_[dt]||_[Ht],en=kt(mn,ie.id);_[Ce]=en,E.ids[en]==null&&(E.ids[en]=Ce),ie.$ref&&!ie[si]&&(Object.defineProperty(ie,si,{enumerable:!1,value:kt(en,ie.$ref)}),Object.defineProperty(ie,ui,{enumerable:!1,value:de}))}),J}var qr=Qr,oi={array:(h,a,d,x)=>h.typeKeywords.array.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),object:(h,a,d,x)=>h.typeKeywords.object.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),string:(h,a,d,x)=>h.typeKeywords.string.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),integer:(h,a,d,x)=>h.typeKeywords.number.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),number:(h,a,d,x)=>h.typeKeywords.number.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),boolean:(h,a,d,x)=>h.typeKeywords.boolean.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x)),null:(h,a,d,x)=>h.typeKeywords.null.filter(E=>a&&a[E]!=null).map(E=>h.validateKeyword[E](h,a,d,x))};const di={typeKeywords:{array:["allOf","anyOf","enum","items","maxItems","minItems","not","oneOf","uniqueItems"],boolean:["enum","not","allOf","anyOf","oneOf"],object:["additionalProperties","dependencies","enum","format","minProperties","maxProperties","patternProperties","properties","required","not","oneOf","allOf","anyOf"],string:["allOf","anyOf","enum","format","maxLength","minLength","not","oneOf","pattern"],number:["allOf","anyOf","enum","format","maximum","minimum","multipleOf","not","oneOf"],null:["allOf","anyOf","enum","format","not","oneOf"]},validateKeyword:fn,validateType:oi,validateFormat:X,errors:dn,addRemoteSchema:zt,compileSchema:qr,createSchemaOf:Kn,each:As,eachSchema:$,getChildSchemaSelection:Ni,getSchema:ut,getTemplate:Nn,isValid:Fn,resolveAllOf:W,resolveAnyOf:Wr,resolveOneOf:Zt,resolveRef:Xr,step:Ut,validate:hi};class pi extends null{constructor(a,d={}){super(merge(di,d),a)}}const _r={typeKeywords:{array:["allOf","anyOf","contains","enum","if","items","maxItems","minItems","not","oneOf","uniqueItems"],boolean:["allOf","anyOf","enum","not","oneOf"],object:["additionalProperties","allOf","anyOf","dependencies","enum","format","if","maxProperties","minProperties","not","oneOf","patternProperties","properties","propertyNames","required"],string:["allOf","anyOf","enum","format","if","maxLength","minLength","not","oneOf","pattern"],number:["enum","exclusiveMaximum","exclusiveMinimum","format","maximum","minimum","multipleOf","not","oneOf","allOf","anyOf","if"],null:["allOf","anyOf","enum","format","not","oneOf"]},validateKeyword:Ar,validateType:qn,validateFormat:X,errors:dn,addRemoteSchema:zt,compileSchema:es,createSchemaOf:Kn,each:As,eachSchema:$,getChildSchemaSelection:Ni,getSchema:ut,getTemplate:Nn,isValid:Fn,resolveAllOf:W,resolveAnyOf:Wr,resolveOneOf:Zt,resolveRef:Xr,step:Ut,validate:hi};class wi extends null{constructor(a,d={}){super(merge(_r,d),a)}}const li={strings:yt};var vn=z(80236),Mr=z(39362),ei=z(19126),Er=z.n(ei),Fi=z(64279),is=z(60885),xr=z(55635),mi=z(26411),Zr=z(34520),Wn=z(64304),mt=z(52160),An=z(67898),Ur=z(27057),Ei=z(71140),Ds=z(34063),Xs=z(72779),bn=z.n(Xs),Ys=z(34812),gs=z(91750),Kr=z(70218),ki=z(26228),ys=z(75951),Rs=z.n(ys);function Ki(h){(0,K.useEffect)(function(){h()},[])}var Ci=z(82108),Rt=z.n(Ci),qe=z(19996),nt=z(25505),ht=z(38016),jt=z(88013),_t=z(61837),Tn=z(86136),Mn=z(49378),lr=z(12231),ss=z(50758),vs=z(79784),Is=z(30254),So=z(27604),os=z(5075),Ji=z(43054),wo=z(18473);function ti(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function Lr(h,a){if(!ti(h))return;const{properties:d,items:x,anyOf:E,oneOf:F,allOf:J,dependencies:_,then:de,else:ie}=h;for(const Ce in h)h.hasOwnProperty(Ce)&&Ce.startsWith("ui:")&&(a[Ce]=h[Ce],delete h[Ce]);if(ti(d))for(const Ce in d){if(!d.hasOwnProperty(Ce))continue;const Ve=d[Ce];if(!ti(Ve))continue;const dt={};a[Ce]=dt,Lr(Ve,dt)}if(ti(x)){const Ce={};a.items=Ce,Lr(x,Ce)}if(Array.isArray(E))for(const Ce of E)ti(Ce)&&Lr(Ce,a);if(Array.isArray(F))for(const Ce of F)ti(Ce)&&Lr(Ce,a);if(Array.isArray(J))for(const Ce of J)ti(Ce)&&Lr(Ce,a);if(ti(_))for(const Ce of Object.keys(_)){const Ve=_[Ce];ti(Ve)&&Lr(Ve,a)}ti(de)&&Lr(de,a),ti(ie)&&Lr(ie,a)}const Ls=h=>{const a={},d=JSON.parse(JSON.stringify(h));return Lr(d,a),{uiSchema:a,schema:d}},Ns=()=>{const h={__errors:[],addError:a=>{var d;(d=h.__errors)==null||d.push(a)}};return h};function Nr(h){return!!h&&"__errors"in h}function ji(h){var a;if(!h)return!1;for(const d of Object.values(h)){if(Nr(d)){if(((a=d.__errors)!=null?a:[]).length>0)return!0;continue}if(ji(d))return!0}return!1}function Eo(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}const Qs=(h,a,d)=>{async function x(E,F="#",J=E){var _,de;const ie=new br(h),Ce={},Ve=async(dt,Ht,mn,en,_n)=>{const Pr=a[dt];if(Pr){const Sr=Ns();try{await Pr(mn,Sr,{...d,formData:E,schema:en,uiSchema:_n})}catch(Br){Sr.addError(Br.message)}Ce[Ht]=Sr}};for(const[dt,Ht]of Object.entries(J)){const mn=`${F}/${dt}`,en=ie.getSchema(mn,E),{schema:_n,uiSchema:Pr}=Ls(en),Sr=en&&en.items,Br=async(ar,Ti,Gi)=>{await Ve(ar["ui:field"],dt,Ht,Ti,Gi)},Ai=async ar=>{if("ui:field"in ar){const{schema:Ti,uiSchema:Gi}=Ls(en.items);await Br(ar,Ti,Gi)}};if(en&&"ui:field"in en)await Br(en,_n,Pr);else if(Sr&&"ui:field"in en.items)await Ai(en.items);else if(Sr&&en.items.type==="object"){const ar=(de=(_=en.items)==null?void 0:_.properties)!=null?de:[];for(const[,Ti]of Object.entries(ar))await Ai(Ti)}else Eo(Ht)&&(Ce[dt]=await x(E,mn,Ht))}return Ce}return async E=>await x(E)},qs=h=>{const a=Object.fromEntries(Object.entries(h.formState).map(([d,x])=>{var E;for(const F of h.schemas){const _=new br(F.mergedSchema).getSchema(`#/${d}`,h.formState);if(_){const de=(E=_["ui:backstage"])==null?void 0:E.review;if(de){if(de.mask)return[d,de.mask];if(de.show===!1)return[]}if(_["ui:widget"]==="password")return[d,"******"]}}return[d,x]}));return K.createElement(vn.xT,{metadata:a})},dr=h=>{const a=(0,v.h_)(v.W0);return{steps:h.steps.map(({title:E,description:F,schema:J})=>({title:E,description:F,mergedSchema:J,...Ls(J)})).filter(E=>{var F;const J=(F=E.uiSchema["ui:backstage"])==null?void 0:F.featureFlag;return J?a.isActive(J):!0}).map(E=>{var F,J;return{...E,schema:{...E.schema,title:void 0,properties:Object.fromEntries(Object.entries((J=(F=E.schema)==null?void 0:F.properties)!=null?J:[]).filter(([_])=>{var de,ie;const Ce=(ie=(de=E.uiSchema[_])==null?void 0:de["ui:backstage"])==null?void 0:ie.featureFlag;return Ce?a.isActive(Ce):!0}))}}})}},ls=h=>(0,K.useState)(()=>{if(h)return h;const a=Er().parse(window.location.search,{ignoreQueryPrefix:!0});try{return JSON.parse(a.formData)}catch{return{}}}),Bs=h=>{const a=(0,v.h_)(is.s),{value:d,loading:x,error:E}=(0,Fi.default)(()=>a.getTemplateParameterSchema(h),[a,h]);return{manifest:d,loading:x,error:E}},ko=(h,a={})=>{var d;const{layouts:x=[]}=a,E=h==null?void 0:h.uiSchema["ui:ObjectFieldTemplate"];if(typeof E!="string")return h;const F=(d=x.find(J=>J.name===E))==null?void 0:d.component;return F?{...h,uiSchema:{...h.uiSchema,["ui:ObjectFieldTemplate"]:F}}:h};var Oo=Object.freeze({__proto__:null,DescriptionField:({description:h})=>h&&K.createElement(vn.SA,{content:h,linkTarget:"_blank"})});const _s=(0,ke.Z)(h=>({markdownDescription:{fontSize:h.typography.caption.fontSize,margin:0,color:h.palette.text.secondary,"& :first-child":{margin:0,marginTop:"3px"}}})),Fs=h=>{const{children:a,displayLabel:d=!0,rawErrors:x=[],errors:E,help:F,rawDescription:J,required:_,disabled:de}=h,ie=_s();return K.createElement(me.Z,{fullWidth:!0,error:!!x.length,required:_,disabled:de},a,d&&J?K.createElement(vn.SA,{content:J,className:ie.markdownDescription}):null,E,F)},Ao=h=>{const{id:a,children:d,classNames:x,style:E,disabled:F,displayLabel:J,hidden:_,label:de,onDropPropertyClick:ie,onKeyChange:Ce,readonly:Ve,required:dt,rawErrors:Ht=[],errors:mn,help:en,rawDescription:_n,schema:Pr,uiSchema:Sr,registry:Br}=h,Ai=(0,mi.LI)(Sr),ar=(0,mi.t4)("WrapIfAdditionalTemplate",Br,Ai);return _?K.createElement("div",{style:{display:"none"}},d):K.createElement(ar,{classNames:x,style:E,disabled:F,id:a,label:de,onDropPropertyClick:ie,onKeyChange:Ce,readonly:Ve,required:dt,schema:Pr,uiSchema:Sr,registry:Br},K.createElement(Fs,{displayLabel:J,rawErrors:Ht,help:en,disabled:F,rawDescription:_n,errors:mn,required:dt},d))},To=(0,ke.Z)(h=>({markdownDescription:{fontSize:h.typography.caption.fontSize,margin:0,color:h.palette.text.secondary,"& :first-child":{margin:0,marginTop:"3px"}}})),eo=h=>{const{id:a,description:d}=h,x=To();return d?typeof d=="string"?K.createElement(vn.SA,{content:d,className:x.markdownDescription}):K.createElement(I.Z,{id:a,variant:"subtitle2",style:{marginTop:"5px"}},d):null},lo=(0,xr.Zz)(z(80070).Q2),bs=h=>{const a={FieldTemplate:Ao,DescriptionFieldTemplate:eo,...h.templates};return K.createElement(lo,{...h,templates:a})},to=(0,ke.Z)(h=>({backButton:{marginRight:h.spacing(1)},footer:{display:"flex",flexDirection:"row",justifyContent:"right",marginTop:h.spacing(2)},formWrapper:{padding:h.spacing(2)}})),xs=h=>{var a;const{layouts:d=[],components:x={},...E}=h,{ReviewStateComponent:F=qs,createButtonText:J="Create",reviewButtonText:_="Review"}=x,de=(0,v.z$)(),{steps:ie}=dr(E.manifest),Ce=(0,v.I_)(),[Ve,dt]=(0,K.useState)(0),[Ht,mn]=(0,K.useState)(!1),[en,_n]=ls(E.initialState),[Pr,Sr]=(0,K.useState)(),Br=to(),Ai=(0,K.useMemo)(()=>Object.fromEntries(E.extensions.map(({name:pr,component:Jr})=>[pr,Jr])),[E.extensions]),ar=(0,K.useMemo)(()=>Object.fromEntries(E.extensions.map(({name:pr,validation:Jr})=>[pr,Jr])),[E.extensions]),Ti=(0,K.useMemo)(()=>{var pr;return Qs((pr=ie[Ve])==null?void 0:pr.mergedSchema,ar,{apiHolder:Ce})},[ie,Ve,ar,Ce]),Gi=()=>{dt(pr=>pr-1)},js=(0,K.useCallback)(pr=>_n(Jr=>({...Jr,...pr.formData})),[_n]),$o=ko(ie[Ve],{layouts:d}),go=async({formData:pr={}})=>{Sr(void 0),mn(!0);const Jr=await Ti(pr);mn(!1),ji(Jr)?Sr(Jr):(Sr(void 0),dt(gi=>{const Mi=gi+1;return de.captureEvent("click",`Next Step (${Mi})`),Mi})),_n(gi=>({...gi,...pr}))};return K.createElement(K.Fragment,null,Ht&&K.createElement(se.Z,{variant:"indeterminate"}),K.createElement(Ne.Z,{activeStep:Ve,alternativeLabel:!0,variant:"elevation"},ie.map((pr,Jr)=>K.createElement(De.Z,{key:Jr},K.createElement(Tt.Z,null,pr.title))),K.createElement(De.Z,null,K.createElement(Tt.Z,null,"Review"))),K.createElement("div",{className:Br.formWrapper},Ve<ie.length?K.createElement(bs,{validator:Mr.ZP,extraErrors:Pr,formData:en,formContext:{formData:en},schema:$o.schema,uiSchema:$o.uiSchema,onSubmit:go,fields:{...Oo,...Ai},showErrorList:!1,onChange:js,...(a=E.FormProps)!=null?a:{}},K.createElement("div",{className:Br.footer},K.createElement(rt.Z,{onClick:Gi,className:Br.backButton,disabled:Ve<1||Ht},"Back"),K.createElement(rt.Z,{variant:"contained",color:"primary",type:"submit",disabled:Ht},Ve===ie.length-1?_:"Next"))):K.createElement(K.Fragment,null,K.createElement(F,{formState:en,schemas:ie}),K.createElement("div",{className:Br.footer},K.createElement(rt.Z,{onClick:Gi,className:Br.backButton,disabled:Ve<1},"Back"),K.createElement(rt.Z,{variant:"contained",color:"primary",onClick:()=>{var pr;E.onCreate(en);const Jr=typeof en.name=="string"?en.name:void 0;de.captureEvent("create",(pr=Jr!=null?Jr:E.templateName)!=null?pr:"unknown")}},J)))))},Mo=(0,ke.Z)(()=>({header:{backgroundImage:({cardBackgroundImage:h})=>h,color:({cardFontColor:h})=>h},subtitleWrapper:{display:"flex",justifyContent:"space-between"}})),Po=h=>{const{template:{metadata:{title:a,name:d},spec:{type:x}}}=h,{getPageTheme:E}=(0,st.Z)(),F=E({themeId:x}),J=Mo({cardFontColor:F.fontColor,cardBackgroundImage:F.backgroundImage}),_=K.createElement("div",{className:J.subtitleWrapper},K.createElement("div",null,x),K.createElement("div",null,K.createElement(Wn.LH,{entity:h.template,style:{padding:0}})));return K.createElement(vn.hu,{title:a!=null?a:d,subtitle:_,classes:{root:J.header}})},as=(0,ke.Z)(()=>({linkText:{display:"inline-flex",alignItems:"center"}})),cs=({icon:h,text:a,url:d})=>{const x=as();return K.createElement("div",{className:x.linkText},K.createElement(h,{fontSize:"small"}),K.createElement(vn.rU,{style:{marginLeft:"8px"},to:d},a||d))},Do=(0,ke.Z)(h=>({box:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":10,"-webkit-box-orient":"vertical"},markdown:{"& :first-child":{margin:0}},label:{color:h.palette.text.secondary,textTransform:"uppercase",fontWeight:"bold",letterSpacing:.5,lineHeight:1,fontSize:"0.75rem"},footer:{display:"flex",justifyContent:"space-between",flex:1,alignItems:"center"},ownedBy:{display:"flex",alignItems:"center",flex:1,color:h.palette.link}})),$i=h=>{var a,d,x,E,F,J,_;const{template:de}=h,ie=Do(),Ce=(0,Wn.hF)(de,Zr.S4),Ve=(0,v.qD)(),dt=Ht=>{var mn;return Ht&&(mn=Ve.getSystemIcon(Ht))!=null?mn:mt.Z};return K.createElement(He.Z,null,K.createElement(Po,{template:de}),K.createElement(gt.Z,null,K.createElement(tt.Z,{container:!0,spacing:2},K.createElement(tt.Z,{item:!0,xs:12},K.createElement(Je.Z,{className:ie.box},K.createElement(vn.SA,{className:ie.markdown,content:(a=de.metadata.description)!=null?a:"No description"}))),((x=(d=de.metadata.tags)==null?void 0:d.length)!=null?x:0)>0&&K.createElement(K.Fragment,null,K.createElement(tt.Z,{item:!0,xs:12},K.createElement(It.Z,null)),K.createElement(tt.Z,{item:!0,xs:12},K.createElement(tt.Z,{container:!0,spacing:2},(E=de.metadata.tags)==null?void 0:E.map(Ht=>K.createElement(tt.Z,{item:!0},K.createElement(ee.Z,{style:{margin:0},size:"small",label:Ht,key:Ht})))))),(h.additionalLinks||((F=de.metadata.links)==null?void 0:F.length))&&K.createElement(K.Fragment,null,K.createElement(tt.Z,{item:!0,xs:12},K.createElement(It.Z,null)),K.createElement(tt.Z,{item:!0,xs:12},K.createElement(tt.Z,{container:!0,spacing:2},(J=h.additionalLinks)==null?void 0:J.map(({icon:Ht,text:mn,url:en},_n)=>K.createElement(tt.Z,{className:ie.linkText,item:!0,xs:6,key:_n},K.createElement(cs,{icon:Ht,text:mn,url:en}))),(_=de.metadata.links)==null?void 0:_.map(({url:Ht,icon:mn,title:en},_n)=>K.createElement(tt.Z,{className:ie.linkText,item:!0,xs:6,key:_n},K.createElement(cs,{icon:dt(mn),text:en||Ht,url:Ht})))))))),K.createElement(Me.Z,{style:{padding:"16px",flex:1,alignItems:"flex-end"}},K.createElement("div",{className:ie.footer},K.createElement("div",{className:ie.ownedBy},Ce.length>0&&K.createElement(K.Fragment,null,K.createElement(vn.tB,{fontSize:"small"}),K.createElement(Wn.rI,{style:{marginLeft:"8px"},entityRefs:Ce,defaultKind:"Group"}))),K.createElement(rt.Z,{size:"small",variant:"outlined",color:"primary",onClick:()=>{var Ht;return(Ht=h.onSelected)==null?void 0:Ht.call(h,de)}},"Choose"))))},no=h=>{const{templates:a,title:d,components:{CardComponent:x}={},onSelected:E}=h,F=typeof d=="string"?K.createElement(vn.yW,{title:d}):d;if(a.length===0)return null;const J=x||$i;return K.createElement(vn.VY,null,F,K.createElement(vn.Oh,null,a.map(({template:_,additionalLinks:de})=>K.createElement(J,{key:(0,Zr.eE)(_),additionalLinks:de,template:_,onSelected:E}))))},Ro=h=>{const{loading:a,error:d,entities:x}=(0,Wn.wp)(),{groups:E,templateFilter:F,TemplateCardComponent:J,onTemplateSelected:_}=h,de=(0,v.h_)(v.VE),ie=(0,K.useCallback)(Ce=>{_==null||_(Ce)},[_]);return a?K.createElement(vn.Ex,null):d?(de.post(d),null):!x||!x.length?K.createElement(I.Z,{variant:"body2"},"No templates found that match your filter. Learn more about"," ",K.createElement(vn.rU,{to:"https://backstage.io/docs/features/software-templates/adding-templates"},"adding templates"),"."):K.createElement(K.Fragment,null,E.map(({title:Ce,filter:Ve},dt)=>{const Ht=x.filter(An.t).filter(mn=>F?F(mn):!0).filter(Ve).map(mn=>{var en,_n;const Pr=(_n=(en=h.additionalLinksForEntity)==null?void 0:en.call(h,mn))!=null?_n:[];return{template:mn,additionalLinks:Pr}});return K.createElement(no,{key:dt,templates:Ht,title:Ce,components:{CardComponent:J},onSelected:ie})}))},ao=(0,ke.Z)(()=>({markdown:{"& :first-child":{marginTop:0},"& :last-child":{marginBottom:0}}})),co=h=>{var a;const{title:d,description:x,namespace:E,templateName:F,...J}=h,_=ao(),de=(0,Zr.eE)({kind:"Template",namespace:E,name:F}),ie=(0,v.h_)(v.VE),{loading:Ce,manifest:Ve,error:dt}=Bs(de);return(0,K.useEffect)(()=>{dt&&ie.post(new Error(`Failed to load template, ${dt}`))},[dt,ie]),dt?J.onError(dt):K.createElement(vn.VY,null,Ce&&K.createElement(vn.Ex,null),Ve&&K.createElement(vn.rJ,{title:d!=null?d:Ve.title,subheader:K.createElement(vn.SA,{className:_.markdown,content:(a=x!=null?x:Ve.description)!=null?a:"No description"}),noPadding:!0,titleTypographyProps:{component:"h2"}},K.createElement(xs,{manifest:Ve,...J})))},Jo=h=>React.createElement(SecretsContextProvider,null,React.createElement(co,{...h})),Io=(0,ke.Z)({root:{"&:hover":{textDecoration:"none"}}}),fo=h=>{const{links:a=[]}=h.output,d=Io(),x=(0,v.qD)(),E=(0,v.tg)(Wn.wi),F=J=>{var _;return(_=x.getSystemIcon(J))!=null?_:Ur.Z};return K.createElement(K.Fragment,null,a.filter(({url:J,entityRef:_})=>J||_).map(({url:J,entityRef:_,title:de,icon:ie})=>{if(_){const Ce=(0,Zr.of)(_),Ve=E(Ce);return{title:de,icon:ie,url:Ve}}return{title:de,icon:ie,url:J}}).map(({url:J,title:_,icon:de},ie)=>{const Ce=F(de);return K.createElement(vn.rU,{to:J,key:ie,classes:{root:d.root}},K.createElement(rt.Z,{startIcon:K.createElement(Ce,null),component:"div",color:"primary"},_))}))},Go=h=>{const{output:{text:a=[]},index:d,setIndex:x}=h,E=(0,v.qD)(),F=J=>{var _;return(_=E.getSystemIcon(J))!=null?_:Ur.Z};return K.createElement(K.Fragment,null,a.filter(({content:J})=>J!==void 0).map(({title:J,icon:_},de)=>{const ie=F(_);return K.createElement(rt.Z,{key:de,startIcon:K.createElement(ie,null),component:"div",color:"primary",onClick:()=>x==null?void 0:x(d!==de?de:void 0),variant:d===de?"outlined":void 0},J)}))},Lo=h=>{var a,d;const[x,E]=(0,K.useState)(),F=(0,K.useMemo)(()=>{var J,_;return x!==void 0?(_=(J=h.output)==null?void 0:J.text)==null?void 0:_[x]:null},[h.output,x]);return h.output?K.createElement(K.Fragment,null,K.createElement(Je.Z,{paddingBottom:2},K.createElement(ge.Z,null,K.createElement(Je.Z,{padding:2,justifyContent:"center",display:"flex",gridGap:16},K.createElement(Go,{output:h.output,index:x,setIndex:E}),K.createElement(fo,{output:h.output})))),F?K.createElement(Je.Z,{paddingBottom:2},K.createElement(vn.rJ,{title:(a=F.title)!=null?a:"Text Output",noPadding:!0,titleTypographyProps:{component:"h2"}},K.createElement(Je.Z,{padding:2,height:"100%"},K.createElement(vn.SA,{content:(d=F.content)!=null?d:""})))):null):null},ro=(0,ke.Z)(h=>({root:{color:h.palette.text.disabled},completed:{color:h.palette.status.ok},error:{color:h.palette.status.error}})),No=h=>{const a=ro(),{active:d,completed:x,error:E,skipped:F}=h,J=()=>d?K.createElement(je.Z,{size:"20px"}):x?K.createElement(Ys.Z,null):E?K.createElement(gs.Z,null):F?K.createElement(Ei.Z,null):K.createElement(Ds.Z,null);return K.createElement("div",{className:bn()(a.root,{[a.completed]:x,[a.error]:E})},J())},Xo=h=>{const[a,d]=(0,K.useState)(""),{step:x}=h,E=(0,K.useCallback)(()=>{if(!x.startedAt){d("");return}const F=x.endedAt?ki.ou.fromISO(x.endedAt):ki.ou.local(),J=ki.ou.fromISO(x.startedAt),_=ki.Xp.fromDateTimes(J,F).toDuration().valueOf();d(Rs()(_,{round:!0}))},[x.endedAt,x.startedAt]);return Ki(()=>E()),(0,Kr.Z)(()=>!x.endedAt&&E(),1e3),K.createElement(I.Z,{variant:"caption"},a)},Bo=(0,ke.Z)(h=>({failed:{backgroundColor:h.palette.error.main},success:{backgroundColor:h.palette.success.main}})),Fo=h=>{const a=Bo();return h.isComplete?K.createElement(se.Z,{variant:"determinate",classes:{bar:h.isError?a.failed:a.success},value:100}):K.createElement(se.Z,{variant:"indeterminate"})},ho=h=>{var a,d;return K.createElement(ge.Z,{style:{position:"relative",overflow:"hidden"}},K.createElement(Fo,{isComplete:(a=h.isComplete)!=null?a:!1,isError:(d=h.isError)!=null?d:!1}),K.createElement(Je.Z,{padding:2},K.createElement(Ne.Z,{activeStep:h.activeStep,alternativeLabel:!0,variant:"elevation"},h.steps.map((x,E)=>{const F=x.status==="completed",J=x.status==="failed",_=x.status==="processing",de=x.status==="skipped",ie={completed:F,error:J,active:_,skipped:de};return K.createElement(De.Z,{key:E},K.createElement(Ze.Z,null,K.createElement(Tt.Z,{StepIconProps:ie,StepIconComponent:No,"data-testid":"step-label"},K.createElement(Je.Z,null,x.name),!de&&K.createElement(Xo,{step:x}))))}))))},Ss=(0,ke.Z)({root:{width:"100%",height:"100%",position:"relative"}}),uo=h=>{const a=Ss();return K.createElement("div",{className:a.root},K.createElement(vn.nU,{text:Object.values(h.logs).map(d=>d.join(`
`)).filter(Boolean).join(`
`)}))},jo=K.createElement(nt.Z,{fontSize:"small"}),po=K.createElement(qe.Z,{fontSize:"small"}),io=()=>{const h=(0,v.h_)(v.$v),{error:a,loading:d,availableTypes:x,selectedTypes:E,setSelectedTypes:F}=(0,Wn.Uh)();return d?K.createElement(vn.Ex,null):a?(h.post({message:`Failed to load entity types with error: ${a}`,severity:"error"}),null):x?K.createElement(Je.Z,{pb:1,pt:1},K.createElement(I.Z,{variant:"button",component:"label",htmlFor:"categories-picker"},"Categories"),K.createElement(jt.ZP,{multiple:!0,id:"categories-picker",options:x,value:E,onChange:(J,_)=>F(_),renderOption:(J,{selected:_})=>K.createElement(Oe.Z,{control:K.createElement(Xe.Z,{icon:jo,checkedIcon:po,checked:_}),label:Rt()(J)}),size:"small",popupIcon:K.createElement(ht.Z,null),renderInput:J=>K.createElement(Ye.Z,{...J,variant:"outlined"})})):null},fs=(0,ke.Z)(h=>({button:{color:h.page.fontColor}}));function Oi(h){const{onEditorClicked:a,onActionsClicked:d,onTasksClicked:x}=h,E=fs(),[F,J]=(0,K.useState)();if(!a&&!d)return null;const _=ie=>{J(ie.currentTarget)},de=()=>{J(void 0)};return K.createElement(K.Fragment,null,K.createElement(_t.Z,{id:"long-menu","aria-label":"more","aria-controls":"long-menu","aria-expanded":!!F,"aria-haspopup":"true",role:"button",onClick:_,"data-testid":"menu-button",color:"inherit",className:E.button},K.createElement(Ji.Z,null)),K.createElement(vs.ZP,{"aria-labelledby":"long-menu",open:Boolean(F),onClose:de,anchorEl:F,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},K.createElement(ss.Z,null,a&&K.createElement(lr.Z,{onClick:a},K.createElement(Tn.Z,null,K.createElement(So.Z,{fontSize:"small"})),K.createElement(Mn.Z,{primary:"Template Editor"})),d&&K.createElement(lr.Z,{onClick:d},K.createElement(Tn.Z,null,K.createElement(Is.Z,{fontSize:"small"})),K.createElement(Mn.Z,{primary:"Installed Actions"})),x&&K.createElement(lr.Z,{onClick:x},K.createElement(Tn.Z,null,K.createElement(os.Z,{fontSize:"small"})),K.createElement(Mn.Z,{primary:"Task List"})))))}function mo(h){return{expose(){const a=()=>null;return attachComponentData(a,FIELD_EXTENSION_KEY,h),a}}}},48394:function(Bn,pt,z){"use strict";z.d(pt,{A:function(){return Zn},D:function(){return _i},L:function(){return Ms},T:function(){return dn},W:function(){return S},a:function(){return bi},b:function(){return H},c:function(){return fi},d:function(){return As},e:function(){return Re},f:function(){return Us},u:function(){return te}});var v=z(2784),ke=z(64279),me=z(12053),I=z(79692),se=z(60905),Ne=z(95544),De=z(90436),Tt=z(91256),rt=z(27556),st=z(37390),He=z(58987),gt=z(89571),tt=z(15584),Je=z(97485),It=z(82113),ee=z(27616),Me=z(8284),ge=z(70660),je=z(80030),Ze=z(61837),Oe=z(85256),Xe=z(94339),Ye=z(11776),K=z(12231),yt=z(86136),le=z(49378),Ie=z(72779),ze=z.n(Ie),ot=z(38016),Ae=z(84905),Ue=z(30705),Ge=z(80236),lt=z(7089),ye=z(25417),xe=z(24579),We=z(82726),vt=z(78887),Pt=function(q){return(q+1)%Number.MAX_SAFE_INTEGER};function Wt(){var q=(0,vt.F)(0),X=q[1];return(0,v.useCallback)(function(){X(Pt)},[])}var Zt=z(51967);function In(q){var X=(0,v.useRef)();return(0,v.useEffect)(function(){X.current=q}),X.current}var xn=z(77246),er=z(29862),Lt=z(16303),rn=function(q,X,ae){if(ae||arguments.length===2)for(var be=0,Pe=X.length,ct;be<Pe;be++)(ct||!(be in X))&&(ct||(ct=Array.prototype.slice.call(X,0,be)),ct[be]=X[be]);return q.concat(ct||Array.prototype.slice.call(X))};function Ee(q){for(var X=[],ae=1;ae<arguments.length;ae++)X[ae-1]=arguments[ae];var be=(0,er.t)(),Pe=(0,xn.x)(X[1]),ct=(0,v.useMemo)(function(){return function(){for(var it=[],Nt=0;Nt<arguments.length;Nt++)it[Nt]=arguments[Nt];be()&&(typeof Pe.current=="function"?Pe.current.apply(this,it):typeof Pe.current.handleEvent=="function"&&Pe.current.handleEvent.apply(this,it))}},[]);(0,v.useEffect)(function(){var it=q&&(0,Lt.nr)(q,"current")?q.current:q;if(it){var Nt=X.slice(2);return Lt.on.apply(void 0,rn([it,X[0],ct],Nt,!1)),function(){return Lt.S1.apply(void 0,rn([it,X[0],ct],Nt,!1))}}},[q,X[0]])}var O=z(24947),N=function(q){return typeof q=="function"?q:typeof q=="string"?function(X){return X.key===q}:q?Lt.cI:Lt.Vp},W=O.jU?window:null;function G(q,X,ae,be){be===void 0&&(be={});var Pe=be.event,ct=Pe===void 0?"keydown":Pe,it=be.target,Nt=it===void 0?W:it,On=be.eventOptions,qt=(0,xn.x)(X),Dt=(0,v.useMemo)(function(){var xt=N(q);return function(ln){xt(ln)&&qt.current.call(this,ln)}},ae);Ee(Nt,ct,Dt,On)}var ne=z(10921),pe=z(38402),Se=z(9520),$e=z(49166),ve=z(98281),ut=z(22983),St=z(77120),at=z(42123),zt=z(6487),Ft=z(99152),Qt=z(2552),Jn=z(89759),En=z(87685),or=z(49423),Gt=z(96401),Mt=z(7896),yn=z(96234),Ct=z(59740),Kt=z(6277),Xt=z(15459),Jt=z(24514),bt=v.createContext({}),wt=bt,an={root:{padding:0,margin:0,listStyle:"none"}};function hn(q,X){if(q.length!==X.length)return!0;for(var ae=0;ae<q.length;ae+=1)if(q[ae]!==X[ae])return!0;return!1}var Vn=function(X,ae,be){for(var Pe=ae;Pe<X.length;Pe+=1)if(be===X[Pe])return Pe;return-1},Hn=[],cr=[],wr=v.forwardRef(function(X,ae){var be=X.children,Pe=X.classes,ct=X.className,it=X.defaultCollapseIcon,Nt=X.defaultEndIcon,On=X.defaultExpanded,qt=On===void 0?Hn:On,Dt=X.defaultExpandIcon,xt=X.defaultParentIcon,At=X.defaultSelected,ln=At===void 0?cr:At,Nn=X.disableSelection,Fn=Nn===void 0?!1:Nn,rr=X.multiSelect,Or=rr===void 0?!1:rr,Rr=X.expanded,ir=X.onNodeSelect,hr=X.onNodeToggle,ii=X.selected,fn=(0,Ct.Z)(X,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),Li=v.useState(null),Ar=Li[0],Wr=Li[1],Xr=v.useState(null),Kn=Xr[0],Ni=Xr[1],pn=v.useRef({}),Ut=v.useRef({}),jn=v.useRef([]),qn=(0,Jt.Z)({controlled:Rr,default:qt,name:"TreeView",state:"expanded"}),Zi=(0,yn.Z)(qn,2),wn=Zi[0],$n=Zi[1],hi=(0,Jt.Z)({controlled:ii,default:ln,name:"TreeView",state:"selected"}),Ui=(0,yn.Z)(hi,2),ur=Ui[0],br=Ui[1],Hr=v.useCallback(function(Rt){return Array.isArray(wn)?wn.indexOf(Rt)!==-1:!1},[wn]),Ir=v.useCallback(function(Rt){return Array.isArray(ur)?ur.indexOf(Rt)!==-1:ur===Rt},[ur]),Ps=function(qe){return Ar===qe},zr=function(qe){return Kn===qe},si=function(qe){var nt=jn.current.indexOf(qe);return nt!==-1&&nt+1<jn.current.length?jn.current[nt+1]:null},Bi=function(qe){var nt=jn.current.indexOf(qe);return nt!==-1&&nt-1>=0?jn.current[nt-1]:null},ui=function(){return jn.current[jn.current.length-1]},Yr=function(){return jn.current[0]},Qr=function(qe){return pn.current[qe].parent},qr=function(qe,nt){var ht=jn.current.indexOf(qe),jt=jn.current.indexOf(nt),_t=Math.min(ht,jt),Tn=Math.max(ht,jt);return jn.current.slice(_t,Tn+1)},Tr=function(qe){qe&&(Wr(qe),Ni(qe))},oi=function(qe){return Tr(si(qe))},di=function(qe){return Tr(Bi(qe))},pi=function(){return Tr(Yr())},_r=function(){return Tr(ui())},wi=function(qe,nt){var ht,jt,_t=nt.toLowerCase(),Tn=[],Mn=[];Object.keys(Ut.current).forEach(function(lr){var ss=Ut.current[lr],vs=pn.current[lr],Is=vs.parent?Hr(vs.parent):!0;Is&&(Tn.push(lr),Mn.push(ss))}),ht=Tn.indexOf(qe)+1,ht===pn.current.length&&(ht=0),jt=Vn(Mn,ht,_t),jt===-1&&(jt=Vn(Mn,0,_t)),jt>-1&&Tr(Tn[jt])},li=function(qe){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kn,ht;wn.indexOf(nt)!==-1?(ht=wn.filter(function(jt){return jt!==nt}),Wr(function(jt){var _t=pn.current[jt];return jt&&(_t&&_t.parent?_t.parent.id:null)===nt?nt:jt})):ht=[nt].concat(wn),hr&&hr(qe,ht),$n(ht)},vn=function(qe,nt){var ht=pn.current[nt],jt=pn.current[ht.parent],_t;if(jt)_t=jt.children.filter(function(lr){return!Hr(lr)});else{var Tn=pn.current[-1].children;_t=Tn.filter(function(lr){return!Hr(lr)})}var Mn=wn.concat(_t);_t.length>0&&($n(Mn),hr&&hr(qe,Mn))},Mr=v.useRef(null),ei=v.useRef(!1),Er=v.useRef([]),Fi=function(qe,nt){var ht=ur,jt=nt.start,_t=nt.next,Tn=nt.current;!_t||!Tn||(Er.current.indexOf(Tn)===-1&&(Er.current=[]),ei.current?Er.current.indexOf(_t)!==-1?(ht=ht.filter(function(Mn){return Mn===jt||Mn!==Tn}),Er.current=Er.current.filter(function(Mn){return Mn===jt||Mn!==Tn})):(ht.push(_t),Er.current.push(_t)):(ht.push(_t),Er.current.push(Tn,_t)),ir&&ir(qe,ht),br(ht))},is=function(qe,nt){var ht=ur,jt=nt.start,_t=nt.end;ei.current&&(ht=ur.filter(function(lr){return Er.current.indexOf(lr)===-1}));var Tn=qr(jt,_t);Er.current=Tn;var Mn=ht.concat(Tn);Mn=Mn.filter(function(lr,ss){return Mn.indexOf(lr)===ss}),ir&&ir(qe,Mn),br(Mn)},xr=function(qe,nt){var ht=[];ur.indexOf(nt)!==-1?ht=ur.filter(function(jt){return jt!==nt}):ht=[nt].concat(ur),ir&&ir(qe,ht),br(ht)},mi=function(qe,nt){var ht=Or?[nt]:nt;ir&&ir(qe,ht),br(ht)},Zr=function(qe,nt){var ht=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return nt?(ht?xr(qe,nt):mi(qe,nt),Mr.current=nt,ei.current=!1,Er.current=[],!0):!1},Wn=function(qe,nt){var ht=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,jt=nt.start,_t=jt===void 0?Mr.current:jt,Tn=nt.end,Mn=nt.current;return ht?Fi(qe,{start:_t,next:Tn,current:Mn}):is(qe,{start:_t,end:Tn}),ei.current=!0,!0},mt=function(qe,nt){Mr.current||(Mr.current=nt);var ht=ei.current?Mr.current:nt;return Wn(qe,{start:ht,end:Yr()})},An=function(qe,nt){Mr.current||(Mr.current=nt);var ht=ei.current?Mr.current:nt;return Wn(qe,{start:ht,end:ui()})},Ur=function(qe,nt){return Wn(qe,{end:si(nt),current:nt},!0)},Ei=function(qe,nt){return Wn(qe,{end:Bi(nt),current:nt},!0)},Ds=function(qe){return Wn(qe,{start:Yr(),end:ui()})},Xs=function(qe,nt){var ht=pn.current[qe];pn.current[qe]=(0,Mt.Z)({},ht,{children:nt,id:qe}),nt.forEach(function(jt){var _t=pn.current[jt];pn.current[jt]=(0,Mt.Z)({},_t,{parent:qe,id:jt})})},bn=v.useCallback(function(Rt){var qe=pn.current[Rt],nt=[];return qe&&(nt.push(Rt),qe.children&&(nt.concat(qe.children),qe.children.forEach(function(ht){nt.concat(bn(ht))}))),nt},[]),Ys=v.useCallback(function(Rt){var qe=(0,Mt.Z)({},Ut.current);Rt.forEach(function(nt){qe[nt]&&delete qe[nt]}),Ut.current=qe},[]),gs=v.useCallback(function(Rt){var qe=bn(Rt);Ys(qe);var nt=(0,Mt.Z)({},pn.current);qe.forEach(function(ht){var jt=nt[ht];if(jt){if(jt.parent){var _t=nt[jt.parent];if(_t&&_t.children){var Tn=_t.children.filter(function(Mn){return Mn!==ht});nt[jt.parent]=(0,Mt.Z)({},_t,{children:Tn})}}delete nt[ht]}}),pn.current=nt,Ni(function(ht){return ht===Rt?null:ht})},[bn,Ys]),Kr=function(qe,nt){Ut.current[qe]=nt},ki=v.useRef([]),ys=v.useState(!1),Rs=ys[0],Ki=ys[1];v.useEffect(function(){var Rt=[];v.Children.forEach(be,function(qe){v.isValidElement(qe)&&qe.props.nodeId&&Rt.push(qe.props.nodeId)}),hn(ki.current,Rt)&&(pn.current[-1]={parent:null,children:Rt},Rt.forEach(function(qe,nt){nt===0&&Wr(qe)}),jn.current=pn.current[-1].children,ki.current=Rt,Ki(!0))},[be]),v.useEffect(function(){var Rt=function qe(nt){for(var ht=[],jt=0;jt<nt.length;jt+=1){var _t=nt[jt];ht.push(_t);var Tn=pn.current[_t].children;Hr(_t)&&Tn&&(ht=ht.concat(qe(Tn)))}return ht};Rs&&(jn.current=Rt(pn.current[-1].children))},[wn,Rs,Hr,be]);var Ci=function(){return!1};return v.createElement(wt.Provider,{value:{icons:{defaultCollapseIcon:it,defaultExpandIcon:Dt,defaultParentIcon:xt,defaultEndIcon:Nt},focus:Tr,focusFirstNode:pi,focusLastNode:_r,focusNextNode:oi,focusPreviousNode:di,focusByFirstCharacter:wi,expandAllSiblings:vn,toggleExpansion:li,isExpanded:Hr,isFocused:zr,isSelected:Ir,selectNode:Fn?Ci:Zr,selectRange:Fn?Ci:Wn,selectNextNode:Fn?Ci:Ur,selectPreviousNode:Fn?Ci:Ei,rangeSelectToFirst:Fn?Ci:mt,rangeSelectToLast:Fn?Ci:An,selectAllNodes:Fn?Ci:Ds,isTabbable:Ps,multiSelect:Or,getParent:Qr,mapFirstChar:Kr,addNodeToNodeMap:Xs,removeNodeFromNodeMap:gs}},v.createElement("ul",(0,Mt.Z)({role:"tree","aria-multiselectable":Or,className:(0,Kt.default)(Pe.root,ct),ref:ae},fn),be))}),Bt=(0,Xt.Z)(an,{name:"MuiTreeView"})(wr),Pn=z(51209),Yt=z(41128),un=z(60364),Xn=z(85974),fr=function(X){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:X.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,Yt.Fq)(X.palette.primary.main,X.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,Yt.Fq)(X.palette.primary.main,X.palette.action.selectedOpacity+X.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:X.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},zn=function(X){return X&&X.length===1&&X.match(/\S/)},Hi=v.forwardRef(function(X,ae){var be=X.children,Pe=X.classes,ct=X.className,it=X.collapseIcon,Nt=X.endIcon,On=X.expandIcon,qt=X.icon,Dt=X.label,xt=X.nodeId,At=X.onClick,ln=X.onLabelClick,Nn=X.onIconClick,Fn=X.onFocus,rr=X.onKeyDown,Or=X.onMouseDown,Rr=X.TransitionComponent,ir=Rr===void 0?It.Z:Rr,hr=X.TransitionProps,ii=(0,Ct.Z)(X,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),fn=v.useContext(wt),Li=fn.icons,Ar=fn.focus,Wr=fn.focusFirstNode,Xr=fn.focusLastNode,Kn=fn.focusNextNode,Ni=fn.focusPreviousNode,pn=fn.focusByFirstCharacter,Ut=fn.selectNode,jn=fn.selectRange,qn=fn.selectNextNode,Zi=fn.selectPreviousNode,wn=fn.rangeSelectToFirst,$n=fn.rangeSelectToLast,hi=fn.selectAllNodes,Ui=fn.expandAllSiblings,ur=fn.toggleExpansion,br=fn.isExpanded,Hr=fn.isFocused,Ir=fn.isSelected,Ps=fn.isTabbable,zr=fn.multiSelect,si=fn.getParent,Bi=fn.mapFirstChar,ui=fn.addNodeToNodeMap,Yr=fn.removeNodeFromNodeMap,Qr=v.useRef(null),qr=v.useRef(null),Tr=(0,Xn.Z)(Qr,ae),oi=qt,di=Boolean(Array.isArray(be)?be.length:be),pi=br?br(xt):!1,_r=Hr?Hr(xt):!1,wi=Ps?Ps(xt):!1,li=Ir?Ir(xt):!1,vn=Li||{},Mr=(0,un.Z)();oi||(di?(pi?oi=it||vn.defaultCollapseIcon:oi=On||vn.defaultExpandIcon,oi||(oi=vn.defaultParentIcon)):oi=Nt||vn.defaultEndIcon);var ei=function(mt){_r||Ar(xt);var An=zr&&(mt.shiftKey||mt.ctrlKey||mt.metaKey);di&&!mt.defaultPrevented&&!(An&&br(xt))&&ur(mt,xt),An?mt.shiftKey?jn(mt,{end:xt}):Ut(mt,xt,!0):Ut(mt,xt),At&&At(mt)},Er=function(mt){(mt.shiftKey||mt.ctrlKey||mt.metaKey)&&mt.preventDefault(),Or&&Or(mt)},Fi=function(mt){return di&&(pi?Kn(xt):ur(mt)),!0},is=function(mt){if(pi)return ur(mt,xt),!0;var An=si(xt);return An?(Ar(An),!0):!1},xr=function(mt){var An=!1,Ur=mt.key;if(!(mt.altKey||mt.currentTarget!==mt.target)){var Ei=mt.ctrlKey||mt.metaKey;switch(Ur){case" ":Qr.current===mt.currentTarget&&(zr&&mt.shiftKey?An=jn(mt,{end:xt}):zr?An=Ut(mt,xt,!0):An=Ut(mt,xt)),mt.stopPropagation();break;case"Enter":Qr.current===mt.currentTarget&&di&&(ur(mt),An=!0),mt.stopPropagation();break;case"ArrowDown":zr&&mt.shiftKey&&qn(mt,xt),Kn(xt),An=!0;break;case"ArrowUp":zr&&mt.shiftKey&&Zi(mt,xt),Ni(xt),An=!0;break;case"ArrowRight":Mr.direction==="rtl"?An=is(mt):An=Fi(mt);break;case"ArrowLeft":Mr.direction==="rtl"?An=Fi(mt):An=is(mt);break;case"Home":zr&&Ei&&mt.shiftKey&&wn(mt,xt),Wr(),An=!0;break;case"End":zr&&Ei&&mt.shiftKey&&$n(mt,xt),Xr(),An=!0;break;default:Ur==="*"?(Ui(mt,xt),An=!0):zr&&Ei&&Ur.toLowerCase()==="a"?An=hi(mt):!Ei&&!mt.shiftKey&&zn(Ur)&&(pn(xt,Ur),An=!0)}An&&(mt.preventDefault(),mt.stopPropagation()),rr&&rr(mt)}},mi=function(mt){!_r&&mt.currentTarget===mt.target&&Ar(xt),Fn&&Fn(mt)};v.useEffect(function(){if(ui){var Wn=[];v.Children.forEach(be,function(mt){v.isValidElement(mt)&&mt.props.nodeId&&Wn.push(mt.props.nodeId)}),ui(xt,Wn)}},[be,xt,ui]),v.useEffect(function(){if(Yr)return function(){Yr(xt)}},[xt,Yr]),v.useEffect(function(){Bi&&Dt&&Bi(xt,qr.current.textContent.substring(0,1).toLowerCase())},[Bi,xt,Dt]),v.useEffect(function(){_r&&Qr.current.focus()},[_r]);var Zr;return zr?Zr=li:li&&(Zr=!0),v.createElement("li",(0,Mt.Z)({className:(0,Kt.default)(Pe.root,ct,pi&&Pe.expanded,li&&Pe.selected),role:"treeitem",onKeyDown:xr,onFocus:mi,"aria-expanded":di?pi:null,"aria-selected":Zr,ref:Tr,tabIndex:wi?0:-1},ii),v.createElement("div",{className:Pe.content,onClick:ei,onMouseDown:Er,ref:qr},v.createElement("div",{onClick:Nn,className:Pe.iconContainer},oi),v.createElement(De.Z,{onClick:ln,component:"div",className:Pe.label},Dt)),be&&v.createElement(ir,(0,Mt.Z)({unmountOnExit:!0,className:Pe.group,in:pi,component:"ul",role:"group"},hr),be))}),$r=(0,Xt.Z)(fr,{name:"MuiTreeItem"})(Hi),ri=z(65329),Ln=z(12650),gr=z(64304),ai=z(47603),Dn=z(56881),yr=z(26228),Gr=z(75951),kn=z.n(Gr),tr=z(34520);const qi=(0,I.Z)(q=>({code:{fontFamily:"Menlo, monospace",padding:q.spacing(1),backgroundColor:q.palette.type==="dark"?q.palette.grey[700]:q.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${q.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:q.spacing(.5),fontWeight:"bolder",color:q.palette.error.light}}})),Cr=q=>v.createElement(se.Z,{container:!0},q.examples.map((X,ae)=>v.createElement(v.Fragment,{key:`example-${ae}`},v.createElement(se.Z,{item:!0,lg:3},v.createElement(Ne.Z,{padding:4},v.createElement(De.Z,null,X.description))),v.createElement(se.Z,{item:!0,lg:9},v.createElement(Ne.Z,{padding:1},v.createElement(Ge.Oi,{text:X.example,showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})))))),Zn=()=>{const q=(0,Ue.h_)(me.lc),X=qi(),{loading:ae,value:be,error:Pe}=(0,ke.default)(async()=>q.listActions()),[ct,it]=(0,v.useState)({});if(ae)return v.createElement(Ge.Ex,null);if(Pe)return v.createElement(Ge.mf,{statusMessage:"Failed to load installed actions",status:"500"});const Nt=At=>!At||At.length<1?v.createElement(De.Z,null,"No schema defined"):v.createElement(Tt.Z,{component:rt.Z},v.createElement(st.Z,{size:"small"},v.createElement(He.Z,null,v.createElement(gt.Z,null,v.createElement(tt.Z,null,"Name"),v.createElement(tt.Z,null,"Title"),v.createElement(tt.Z,null,"Description"),v.createElement(tt.Z,null,"Type"))),v.createElement(Je.Z,null,At))),On=At=>{var ln,Nn;return At.type?At.type!=="array"?[At.type].flat():[`${At.type}(${(Nn=(ln=At.items)==null?void 0:ln.type)!=null?Nn:"unknown"})`]:["unknown"]},qt=(At,ln)=>{const Nn=ln==null?void 0:ln.properties;if(Nn)return Object.entries(Nn).map(Fn=>{var rr,Or,Rr;const[ir]=Fn,hr=`${At}.${ir}`,ii=Fn[1],fn=ze()(X.code,{[X.codeRequired]:(rr=ln.required)==null?void 0:rr.includes(ir)}),Li=On(ii);return v.createElement(v.Fragment,{key:hr},v.createElement(gt.Z,{key:hr},v.createElement(tt.Z,null,v.createElement("div",{className:fn},ir)),v.createElement(tt.Z,null,ii.title),v.createElement(tt.Z,null,ii.description),v.createElement(tt.Z,null,Li.map(Ar=>Ar.includes("object")?v.createElement(lt.Z,{label:Ar,key:Ar,icon:ct[hr]?v.createElement(Ae.Z,null):v.createElement(ot.Z,null),variant:"outlined",onClick:()=>it(Wr=>{const Xr={...Wr};return Xr[hr]=!Wr[hr],Xr})}):v.createElement(lt.Z,{label:Ar,key:Ar,variant:"outlined"})))),v.createElement(gt.Z,null,v.createElement(tt.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6},v.createElement(It.Z,{in:ct[hr],timeout:"auto",unmountOnExit:!0},v.createElement(Ne.Z,{sx:{margin:1}},v.createElement(De.Z,{variant:"h6",component:"div"},ir),Nt(qt(hr,ii.type==="array"?{properties:(Rr=(Or=ii.items)==null?void 0:Or.properties)!=null?Rr:{}}:ii)))))))})},Dt=(At,ln,Nn)=>{if(Nn)return v.createElement(v.Fragment,null,v.createElement(De.Z,{variant:"h6",component:"h4"},At),Nn.map((Fn,rr)=>v.createElement("div",{key:rr},Nt(qt(`${ln}.${rr}`,Fn)))))},xt=be==null?void 0:be.map(At=>{var ln,Nn,Fn,rr,Or,Rr;if(At.id.startsWith("legacy:"))return;const ir=Dt("oneOf",`${At.id}.input`,(Nn=(ln=At.schema)==null?void 0:ln.input)==null?void 0:Nn.oneOf);return v.createElement(Ne.Z,{pb:4,key:At.id},v.createElement(De.Z,{variant:"h4",component:"h2",className:X.code},At.id),At.description&&v.createElement(Ge.SA,{content:At.description}),((Fn=At.schema)==null?void 0:Fn.input)&&v.createElement(Ne.Z,{pb:2},v.createElement(De.Z,{variant:"h5",component:"h3"},"Input"),Nt(qt(`${At.id}.input`,(rr=At==null?void 0:At.schema)==null?void 0:rr.input)),ir),((Or=At.schema)==null?void 0:Or.output)&&v.createElement(Ne.Z,{pb:2},v.createElement(De.Z,{variant:"h5",component:"h3"},"Output"),Nt(qt(`${At.id}.output`,(Rr=At==null?void 0:At.schema)==null?void 0:Rr.output))),At.examples&&v.createElement(ee.Z,null,v.createElement(Me.Z,{expandIcon:v.createElement(ot.Z,null)},v.createElement(De.Z,{variant:"h5",component:"h3"},"Examples")),v.createElement(ge.Z,null,v.createElement(Ne.Z,{pb:2},v.createElement(Cr,{examples:At.examples})))))});return v.createElement(Ge.T3,{themeId:"home"},v.createElement(Ge.h4,{pageTitleOverride:"Create a New Component",title:"Installed actions",subtitle:"This is the collection of all installed actions"}),v.createElement(Ge.VY,null,xt))},j=window.showDirectoryPicker;class f{constructor(X,ae){this.path=X,this.handle=ae}file(){return this.handle.getFile()}async save(X){const ae=await this.handle.createWritable();await ae.write(X),await ae.close()}}class g{constructor(X){this.handle=X}async listFiles(){const X=[];for await(const ae of this.listDirectoryContents(this.handle))X.push(ae);return X}async*listDirectoryContents(X,ae=[]){for await(const be of X.values())if(be.kind==="file")yield new f([...ae,be.name].join("/"),be);else if(be.kind==="directory"){if(be.name===".git")continue;yield*this.listDirectoryContents(be,[...ae,be.name])}}}class S{static isSupported(){return Boolean(j)}static async requestDirectoryAccess(){if(!j)throw new Error("File system access is not supported");const X=await j();return new g(X)}constructor(){}}var C=Object.defineProperty,P=(q,X,ae)=>X in q?C(q,X,{enumerable:!0,configurable:!0,writable:!0,value:ae}):q[X]=ae,M=(q,X,ae)=>(P(q,typeof X!="symbol"?X+"":X,ae),ae),Z=(q,X,ae)=>{if(!X.has(q))throw TypeError("Cannot "+ae)},U=(q,X,ae)=>(Z(q,X,"read from private field"),ae?ae.call(q):X.get(q)),he=(q,X,ae)=>{if(X.has(q))throw TypeError("Cannot add the same private member more than once");X instanceof WeakSet?X.add(q):X.set(q,ae)},ue=(q,X,ae,be)=>(Z(q,X,"write to private field"),be?be.call(q,ae):X.set(q,ae),ae),Be,ft,_e,on,Gn,sn,Rn,Vr,Di;const nr=1024*1024,Sn="This file is too large to be displayed";class Ri{constructor(X,ae){he(this,Be,void 0),he(this,ft,void 0),he(this,_e,void 0),he(this,on,void 0),ue(this,Be,X),ue(this,ft,ae)}get path(){return U(this,Be).path}get content(){var X;return(X=U(this,_e))!=null?X:Sn}updateContent(X){U(this,_e)!==void 0&&(ue(this,_e,X),U(this,ft).call(this))}get dirty(){return U(this,_e)!==U(this,on)}async save(){U(this,_e)!==void 0&&(await U(this,Be).save(U(this,_e)),ue(this,on,U(this,_e)),U(this,ft).call(this))}async reload(){const X=await U(this,Be).file();if(X.size>nr){U(this,_e)!==void 0&&(ue(this,_e,void 0),ue(this,on,void 0),U(this,ft).call(this));return}const ae=await X.text();U(this,_e)!==ae&&(ue(this,_e,ae),ue(this,on,ae),U(this,ft).call(this))}}Be=new WeakMap,ft=new WeakMap,_e=new WeakMap,on=new WeakMap;class Ii{constructor(X){he(this,Gn,void 0),he(this,sn,new Set),he(this,Rn,[]),he(this,Vr,void 0),M(this,"setSelectedFile",ae=>{const be=U(this,Vr),Pe=U(this,Rn).find(ct=>ct.path===ae);be!==Pe&&(ue(this,Vr,Pe),U(this,Di).call(this))}),he(this,Di,()=>{U(this,sn).forEach(ae=>ae())}),ue(this,Gn,X)}get files(){return U(this,Rn)}get selectedFile(){return U(this,Vr)}get dirty(){return U(this,Rn).some(X=>X.dirty)}async save(){await Promise.all(U(this,Rn).map(X=>X.save()))}async reload(){var X;const ae=(X=U(this,Vr))==null?void 0:X.path,be=await U(this,Gn).listFiles(),Pe=await Promise.all(be.map(async ct=>{const it=new Ri(ct,U(this,Di));return await it.reload(),it}));U(this,Rn).length=0,U(this,Rn).push(...Pe),this.setSelectedFile(ae),U(this,Di).call(this)}subscribe(X){return U(this,sn).add(X),()=>{U(this,sn).delete(X)}}}Gn=new WeakMap,sn=new WeakMap,Rn=new WeakMap,Vr=new WeakMap,Di=new WeakMap;const ci=(0,v.createContext)(void 0);function bi(){const q=(0,v.useContext)(ci),X=Wt();if((0,v.useEffect)(()=>q==null?void 0:q.subscribe(X),[q,X]),!q)throw new Error("must be used within a DirectoryEditorProvider");return q}function _i(q){const{directory:X}=q,[{result:ae,error:be},{execute:Pe}]=(0,Zt.r)(async ct=>{const it=new Ii(ct);await it.reload();const Nt=it.files.find(On=>On.path.match(/\.ya?ml$/));return Nt&&it.setSelectedFile(Nt.path),it});return(0,v.useEffect)(()=>{Pe(X)},[Pe,X]),be?v.createElement(Ge.yu,{error:be}):ae?v.createElement(ci.Provider,{value:ae},q.children):v.createElement(Ge.Ex,null)}const B=64*1024,b=32*1024,k=(0,v.createContext)(void 0);function $(q){if(q.length>B)return window.btoa("<file too large>");try{return window.btoa(q)}catch{const ae=new TextEncoder().encode(q),be=new Array;for(let Pe=0;Pe<ae.length;Pe+=b)be.push(String.fromCharCode(...ae.slice(Pe,Pe+b)));return window.btoa(be.join(""))}}function H(q){const X=(0,Ue.h_)(me.lc),[ae,be]=(0,v.useState)({results:[],selectedResult:void 0}),Pe=(0,v.useRef)(1),ct=(0,v.useCallback)(qt=>{be(Dt=>{const xt=Dt.results.find(At=>At.id===qt);return xt===Dt.selectedResult?Dt:{results:Dt.results,selectedResult:xt}})},[]),it=(0,v.useCallback)(qt=>{be(Dt=>{var xt;const At=Dt.results.findIndex(Fn=>Fn.id===qt);if(At===-1)return Dt;const ln=Dt.results.slice(),[Nn]=ln.splice(At,1);return{results:ln,selectedResult:((xt=Dt.selectedResult)==null?void 0:xt.id)===Nn.id?ln[0]:Dt.selectedResult}})},[]),Nt=(0,v.useCallback)(async qt=>{if(!X.dryRun)throw new Error("Scaffolder API does not support dry-run");const Dt=ne.ZP.parse(qt.templateContent),At={...await X.dryRun({template:Dt,values:qt.values,secrets:{},directoryContents:qt.files.map(ln=>({path:ln.path,base64Content:$(ln.content)}))}),id:Pe.current++};be(ln=>{var Nn;return{results:[...ln.results,At],selectedResult:(Nn=ln.selectedResult)!=null?Nn:At}})},[X]),On=(0,v.useMemo)(()=>({...ae,selectResult:ct,deleteResult:it,execute:Nt}),[ae,ct,it,Nt]);return v.createElement(k.Provider,{value:On},q.children)}function te(){const q=(0,v.useContext)(k);if(!q)throw new Error("must be used within a DryRunProvider");return q}const oe=(0,I.Z)(q=>({introText:{textAlign:"center",marginTop:q.spacing(2)},card:{position:"relative",maxWidth:340,marginTop:q.spacing(4),margin:q.spacing(0,2)},infoIcon:{position:"absolute",top:q.spacing(1),right:q.spacing(1)}}));function Re(q){const X=oe(),ae=S.isSupported(),be=v.createElement(Xe.Z,{className:X.card,elevation:4},v.createElement(ye.Z,{disabled:!ae,onClick:()=>{var it;return(it=q.onSelect)==null?void 0:it.call(q,"local")}},v.createElement(xe.Z,null,v.createElement(De.Z,{variant:"h4",component:"h3",gutterBottom:!0,color:ae?void 0:"textSecondary",style:{display:"flex",flexFlow:"row nowrap"}},"Load Template Directory"),v.createElement(De.Z,{variant:"body1",color:ae?void 0:"textSecondary"},"Load a local template directory, allowing you to both edit and try executing your own template."))),!ae&&v.createElement("div",{className:X.infoIcon},v.createElement(je.ZP,{placement:"top",title:"Only supported in some Chromium-based browsers"},v.createElement(We.Z,null)))),Pe=v.createElement(Xe.Z,{className:X.card,elevation:4},v.createElement(ye.Z,{onClick:()=>{var it;return(it=q.onSelect)==null?void 0:it.call(q,"form")}},v.createElement(xe.Z,null,v.createElement(De.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Edit Template Form"),v.createElement(De.Z,{variant:"body1"},"Preview and edit a template form, either using a sample template or by loading a template from the catalog.")))),ct=v.createElement(Xe.Z,{className:X.card,elevation:4},v.createElement(ye.Z,{onClick:()=>{var it;return(it=q.onSelect)==null?void 0:it.call(q,"field-explorer")}},v.createElement(xe.Z,null,v.createElement(De.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Custom Field Explorer"),v.createElement(De.Z,{variant:"body1"},"View and play around with available installed custom field extensions."))));return v.createElement("div",{style:q.style},v.createElement(De.Z,{variant:"h4",component:"h2",className:X.introText},"Get started by choosing one of the options below"),v.createElement("div",{style:{display:"flex",flexFlow:"row wrap",alignItems:"flex-start",justifyContent:"center",alignContent:"flex-start"}},ae&&be,Pe,!ae&&be,ct))}const Te=(0,I.Z)(q=>({root:{overflowY:"auto",background:q.palette.background.default},iconSuccess:{minWidth:0,marginRight:q.spacing(1),color:q.palette.status.ok},iconFailure:{minWidth:0,marginRight:q.spacing(1),color:q.palette.status.error}}));function kt(){const q=Te(),X=te();return v.createElement(Ye.Z,{className:q.root,dense:!0},X.results.map(ae=>{var be;const Pe=ae.log.some(ct=>ct.body.status==="failed");return v.createElement(pe.Z,{button:!0,key:ae.id,selected:((be=X.selectedResult)==null?void 0:be.id)===ae.id,onClick:()=>X.selectResult(ae.id)},v.createElement(yt.Z,{className:Pe?q.iconFailure:q.iconSuccess},Pe?v.createElement($e.Z,null):v.createElement(ve.Z,null)),v.createElement(le.Z,{primary:`Result ${ae.id}`}),v.createElement(Se.Z,null,v.createElement(Ze.Z,{edge:"end","aria-label":"delete",onClick:()=>X.deleteResult(ae.id)},v.createElement(ut.Z,null))))}))}const Ot=(0,I.Z)({root:{whiteSpace:"nowrap",overflowY:"auto"}});function cn(q){const X={type:"directory",name:"",path:"",children:[]};for(const ae of q.slice().sort()){const be=ae.split("/");let Pe=X;for(let ct=0;ct<be.length;ct++){const it=be[ct];if(it==="")throw new Error("Invalid path part: ''");const Nt=be.slice(0,ct+1).join("/"),On=Pe.children.find(qt=>qt.name===it);if((On==null?void 0:On.type)==="file")throw new Error(`Duplicate filename at '${Nt}'`);if(On)Pe=On;else if(ct<be.length-1){const qt={type:"directory",name:it,path:Nt,children:[]},Dt=Pe.children.findIndex(xt=>xt.type==="file");Pe.children.splice(Dt,0,qt),Pe=qt}else Pe.children.push({type:"file",name:it,path:Nt})}}return X.children}function Yn({entry:q}){return q.type==="file"?v.createElement($r,{nodeId:q.path,label:q.name}):v.createElement($r,{nodeId:q.path,label:q.name},q.children.map(X=>v.createElement(Yn,{key:X.path,entry:X})))}function Qn(q){const X=Ot(),ae=(0,v.useMemo)(()=>cn(q.filePaths),[q.filePaths]);return v.createElement(Bt,{selected:q.selected,className:X.root,defaultCollapseIcon:v.createElement(ot.Z,null),defaultExpandIcon:v.createElement(Pn.Z,null),onNodeSelect:(be,Pe)=>{q.onSelect&&q.filePaths.includes(Pe)&&q.onSelect(Pe)}},ae.map(be=>v.createElement(Yn,{key:be.path,entry:be})))}const vr=(0,I.Z)(q=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:q.palette.background.paper}}));function Un(q){const X=vr(),ae=v.Children.toArray(q.children);if(ae.length!==2)throw new Error("must have exactly 2 children");return v.createElement("div",{className:X.root},v.createElement("div",{className:ze()(X.child,X.firstChild)},ae[0]),v.createElement(Oe.Z,{orientation:"horizontal"}),v.createElement("div",{className:X.child},ae[1]))}const xi=(0,I.Z)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function Si(){const q=xi(),{selectedResult:X}=te(),[ae,be]=(0,v.useState)(""),Pe=X==null?void 0:X.directoryContents.find(ct=>ct.path===ae);return(0,v.useEffect)(()=>{if(X){const[ct]=X.directoryContents;be(ct?ct.path:"")}},[X]),X?v.createElement(Un,null,v.createElement(Qn,{selected:ae,onSelect:be,filePaths:X.directoryContents.map(ct=>ct.path)}),v.createElement(Qt.ZP,{className:q.codeMirror,theme:"dark",height:"100%",extensions:[St.il.define(at.r)],readOnly:!0,value:Pe!=null&&Pe.base64Content?atob(Pe.base64Content):""})):null}function ms(){var q,X;const{selectedResult:ae}=te(),[be,Pe]=(0,v.useState)(),ct=(0,v.useMemo)(()=>{var Nt;return ae?(Nt=ae.steps.map(On=>{var qt,Dt;const xt=ae.log.filter(At=>At.body.stepId===On.id);return{id:On.id,name:On.name,logString:xt.map(At=>At.body.message).join(`
`),status:(Dt=(qt=xt[xt.length-1])==null?void 0:qt.body.status)!=null?Dt:"completed"}}))!=null?Nt:[]:[]},[ae]);if(!ae)return null;const it=(q=ct.find(Nt=>Nt.id===be))!=null?q:ct[0];return v.createElement(Un,null,v.createElement(Jn.a,{steps:ct,currentStepId:it.id,onUserStepChange:Pe}),v.createElement(Ge.nU,{text:(X=it==null?void 0:it.logString)!=null?X:""}))}function Ws(){var q,X;const ae=xi(),{selectedResult:be}=te();return be?v.createElement(Un,null,v.createElement(Ne.Z,{pt:2},((X=(q=be.output)==null?void 0:q.links)==null?void 0:X.length)&&v.createElement(Jn.b,{output:be.output})),v.createElement(Qt.ZP,{className:ae.codeMirror,theme:"dark",height:"100%",extensions:[St.il.define(at.r)],readOnly:!0,value:JSON.stringify(be.output,null,2)})):null}function Hs(){const q=xi(),[X,ae]=(0,v.useState)("files");return v.createElement("div",{className:q.root},v.createElement(Ft.Z,{value:X,onChange:(be,Pe)=>ae(Pe)},v.createElement(zt.Z,{value:"files",label:"Files"}),v.createElement(zt.Z,{value:"log",label:"Log"}),v.createElement(zt.Z,{value:"output",label:"Output"})),v.createElement(Oe.Z,null),v.createElement("div",{className:q.contentWrapper},v.createElement("div",{className:q.content},X==="files"&&v.createElement(Si,null),X==="log"&&v.createElement(ms,null),X==="output"&&v.createElement(Ws,null))))}const es=(0,I.Z)(q=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:q.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function As(){const q=es(),X=te(),[ae,be]=(0,v.useState)(!1),[Pe,ct]=(0,v.useState)(!0),it=X.results.length,Nt=In(it);return(0,v.useEffect)(()=>{Nt===0&&it===1?(ct(!1),be(!0)):Nt===1&&it===0&&be(!1)},[Nt,it]),v.createElement(v.Fragment,null,v.createElement(ee.Z,{variant:"outlined",expanded:ae,hidden:it===0&&Pe,onChange:(On,qt)=>be(qt),onTransitionEnd:()=>it===0&&ct(!0)},v.createElement(Me.Z,{className:q.header,expandIcon:v.createElement(Ae.Z,null)},v.createElement(De.Z,null,"Dry-run results")),v.createElement(Oe.Z,{orientation:"horizontal"}),v.createElement(ge.Z,{className:q.content},v.createElement(kt,null),v.createElement(Oe.Z,{orientation:"horizontal"}),v.createElement(Hs,null))))}const zs=(0,I.Z)(q=>({button:{padding:q.spacing(1)},buttons:{display:"flex",flexFlow:"row nowrap",alignItems:"center",justifyContent:"flex-start"},buttonsGap:{flex:"1 1 auto"},buttonsDivider:{marginBottom:q.spacing(1)}}));function dn(q){var X,ae;const be=zs(),Pe=bi(),ct=Pe.files.filter(Nt=>Nt.dirty),it=()=>{q.onClose&&(ct.length>0&&!window.confirm("Are you sure? Unsaved changes will be lost")||q.onClose())};return v.createElement(v.Fragment,null,v.createElement("div",{className:be.buttons},v.createElement(je.ZP,{title:"Save all files"},v.createElement(Ze.Z,{className:be.button,disabled:Pe.files.every(Nt=>!Nt.dirty),onClick:()=>Pe.save()},v.createElement(Gt.Z,null))),v.createElement(je.ZP,{title:"Reload directory"},v.createElement(Ze.Z,{className:be.button,onClick:()=>Pe.reload()},v.createElement(or.Z,null))),v.createElement("div",{className:be.buttonsGap}),v.createElement(je.ZP,{title:"Close directory"},v.createElement(Ze.Z,{className:be.button,onClick:it},v.createElement(En.Z,null)))),v.createElement(Oe.Z,{className:be.buttonsDivider}),v.createElement(Qn,{selected:(ae=(X=Pe.selectedFile)==null?void 0:X.path)!=null?ae:"",onSelect:Pe.setSelectedFile,filePaths:Pe.files.map(Nt=>Nt.path)}))}const Zs=(0,I.Z)(q=>({container:{position:"relative",width:"100%",height:"100%"},codeMirror:{position:"absolute",top:0,bottom:0,left:0,right:0},errorPanel:{color:q.palette.error.main,lineHeight:2,margin:q.spacing(0,1)},floatingButtons:{position:"absolute",top:q.spacing(1),right:q.spacing(3)},floatingButton:{padding:q.spacing(1)}}));function fi(q){const{errorText:X}=q,ae=Zs(),be=(0,v.useMemo)(()=>{if(!X)return ri.mH.of(null);const Pe=document.createElement("div");return Pe.classList.add(ae.errorPanel),Pe.textContent=X,ri.mH.of(()=>({dom:Pe,bottom:!0}))},[ae,X]);return G(Pe=>Pe.key==="s"&&(Pe.ctrlKey||Pe.metaKey),Pe=>{Pe.preventDefault(),q.onSave&&q.onSave()}),v.createElement("div",{className:ae.container},v.createElement(Qt.ZP,{className:ae.codeMirror,theme:"dark",height:"100%",extensions:[St.il.define(at.r),be],value:q.content,onChange:q.onUpdate}),(q.onSave||q.onReload)&&v.createElement("div",{className:ae.floatingButtons},v.createElement(rt.Z,null,q.onSave&&v.createElement(je.ZP,{title:"Save file"},v.createElement(Ze.Z,{className:ae.floatingButton,onClick:()=>{var Pe;return(Pe=q.onSave)==null?void 0:Pe.call(q)}},v.createElement(Gt.Z,null))),q.onReload&&v.createElement(je.ZP,{title:"Reload file"},v.createElement(Ze.Z,{className:ae.floatingButton,onClick:()=>{var Pe;return(Pe=q.onReload)==null?void 0:Pe.call(q)}},v.createElement(or.Z,null))))))}function zi(q){var X,ae;const be=bi(),Pe=(X=be.selectedFile)!=null&&X.dirty?{onSave:()=>be.save(),onReload:()=>be.reload()}:{onReload:()=>be.reload()};return v.createElement(fi,{errorText:q.errorText,content:(ae=be.selectedFile)==null?void 0:ae.content,onUpdate:ct=>{var it;return(it=be.selectedFile)==null?void 0:it.updateContent(ct)},...Pe})}fi.DirectoryEditor=zi;const Us=[{component:Ln.x,name:"EntityPicker",schema:Ln.y},{component:Ln.z,name:"EntityNamePicker",validation:Ln.A,schema:Ln.B},{component:Ln.C,name:"EntityTagsPicker",schema:Ln.D},{component:Ln.F,name:"RepoUrlPicker",validation:Ln.h,schema:Ln.G},{component:Ln.H,name:"OwnerPicker",schema:Ln.I},{component:Ln.J,name:"OwnedEntityPicker",schema:Ln.K},{component:Ln.L,name:"MyGroupsPicker",schema:Ln.k}],ts=(0,I.Z)(q=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:q.spacing(1,0,1,0)},title:{margin:q.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:q.palette.text.primary},menuItem:{minHeight:q.spacing(6)},groupWrapper:{margin:q.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"});function Ts(){return[{name:"Task Owner",items:[{id:"owned",label:"Owned",icon:ai.Z},{id:"all",label:"All",icon:Dn.Z}]}]}const Ks=q=>{const{filter:X,onSelectOwner:ae}=q,be=ts(),Pe=Ts();return v.createElement(Xe.Z,{className:be.root},Pe.map(ct=>v.createElement(v.Fragment,{key:ct.name},v.createElement(De.Z,{variant:"subtitle2",component:"span",className:be.title},ct.name),v.createElement(Xe.Z,{className:be.groupWrapper},v.createElement(Ye.Z,{disablePadding:!0,dense:!0,role:"menu"},ct.items.map(it=>v.createElement(K.Z,{key:it.id,button:!0,divider:!0,ContainerProps:{role:"menuitem"},onClick:()=>ae(it.id),selected:it.id===X,className:be.menuItem,"data-testid":`owner-picker-${it.id}`},it.icon&&v.createElement(yt.Z,{className:be.listIcon},v.createElement(it.icon,{fontSize:"small"})),v.createElement(le.Z,null,v.createElement(De.Z,{variant:"body1"},it.label)))))))))},ns=({createdAt:q})=>{const X=yr.ou.fromISO(q),ae=yr.Xp.fromDateTimes(X,yr.ou.local()).toDuration().valueOf();return v.createElement(De.Z,{paragraph:!0},kn()(ae,{round:!0})," ago")},rs=({entityRef:q})=>{var X,ae,be;const Pe=(0,Ue.h_)(gr.Ah),{value:ct,loading:it,error:Nt}=(0,ke.default)(()=>Pe.getEntityByRef(q||""),[Pe,q]);return q?it||Nt?null:v.createElement(gr.dx,{entityRef:(0,tr.of)(q),title:(be=(ae=(X=ct==null?void 0:ct.spec)==null?void 0:X.profile)==null?void 0:ae.displayName)!=null?be:ct==null?void 0:ct.metadata.name}):v.createElement(De.Z,{paragraph:!0},"Unknown")},Js=({status:q})=>{switch(q){case"processing":return v.createElement(Ge.wA,null,q);case"completed":return v.createElement(Ge.Kq,null,q);case"error":default:return v.createElement(Ge.vK,null,q)}},Gs=({entityRef:q})=>{const X=(0,Ue.h_)(me.lc),{value:ae,loading:be,error:Pe}=(0,ke.default)(()=>X.getTemplateParameterSchema(q||""),[X,q]);return be||Pe||!q?null:v.createElement(gr.dx,{entityRef:(0,tr.of)(q),title:ae==null?void 0:ae.title})},Cn=q=>{var X;const{initiallySelectedFilter:ae="owned"}=q,be=(0,Ue.h_)(me.lc),Pe=(0,Ue.tg)(Ln.r),[ct,it]=(0,v.useState)(ae),{value:Nt,loading:On,error:qt}=(0,ke.default)(()=>{var Dt;return be.listTasks?(Dt=be.listTasks)==null?void 0:Dt.call(be,{filterByOwnership:ct}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[]}))},[be,ct]);return On?v.createElement(Ge.Ex,null):qt?v.createElement(v.Fragment,null,v.createElement(Ge.yu,{error:qt}),v.createElement(Ge.ub,{missing:"info",title:"No information to display",description:"There is no Tasks or there was an issue communicating with backend."})):v.createElement(gr._i,null,v.createElement(gr._i.Filters,null,v.createElement(Ks,{filter:ct,onSelectOwner:Dt=>it(Dt)})),v.createElement(gr._i.Content,null,v.createElement(Ge.iA,{data:(X=Nt==null?void 0:Nt.tasks)!=null?X:[],title:"Tasks",columns:[{title:"Task ID",field:"id",render:Dt=>v.createElement(Ge.rU,{to:`${Pe()}/tasks/${Dt.id}`},Dt.id)},{title:"Template",render:Dt=>{var xt;return v.createElement(Gs,{entityRef:(xt=Dt.spec.templateInfo)==null?void 0:xt.entityRef})}},{title:"Created",field:"createdAt",render:Dt=>v.createElement(ns,{createdAt:Dt.createdAt})},{title:"Owner",field:"createdBy",render:Dt=>{var xt,At;return v.createElement(rs,{entityRef:(At=(xt=Dt.spec)==null?void 0:xt.user)==null?void 0:At.ref})}},{title:"Status",field:"status",render:Dt=>v.createElement(Js,{status:Dt.status})}]})))},Ms=q=>v.createElement(Ge.T3,{themeId:"home"},v.createElement(Ge.h4,{pageTitleOverride:"Templates Tasks",title:v.createElement(v.Fragment,null,"List template tasks ",v.createElement(Ge.Fw,{shorthand:!0,alpha:!0})),subtitle:"All tasks that have been started"}),v.createElement(Ge.VY,null,v.createElement(Cn,{...q})))},34812:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M16.59 7.58L10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"CheckCircleOutline");pt.Z=Ne},82726:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");pt.Z=Ne},5075:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"}),"List");pt.Z=Ne},34063:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"PanoramaFishEye");pt.Z=Ne},49423:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");pt.Z=Ne},71140:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"RemoveCircleOutline");pt.Z=Ne},27057:function(Bn,pt,z){"use strict";var v,ke=z(71600),me=z(34590);v={value:!0},pt.Z=void 0;var I=me(z(2784)),se=ke(z(50175)),Ne=(0,se.default)(I.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z"}),"Web");pt.Z=Ne},51967:function(Bn,pt,z){"use strict";z.d(pt,{r:function(){return se}});var v=z(2784),ke=z(78887),me=z(77246),I=function(){return I=Object.assign||function(Ne){for(var De,Tt=1,rt=arguments.length;Tt<rt;Tt++){De=arguments[Tt];for(var st in De)Object.prototype.hasOwnProperty.call(De,st)&&(Ne[st]=De[st])}return Ne},I.apply(this,arguments)};function se(Ne,De){var Tt=(0,ke.F)({status:"not-executed",error:void 0,result:De}),rt=Tt[0],st=Tt[1],He=(0,v.useRef)(),gt=(0,v.useRef)(),tt=(0,me.x)({execute:function(){for(var Je=[],It=0;It<arguments.length;It++)Je[It]=arguments[It];gt.current=Je;var ee=Ne.apply(void 0,Je);return He.current=ee,st(function(Me){return I(I({},Me),{status:"loading"})}),ee.then(function(Me){ee===He.current&&st(function(ge){return I(I({},ge),{status:"success",error:void 0,result:Me})})},function(Me){ee===He.current&&st(function(ge){return I(I({},ge),{status:"error",error:Me})})}),ee},reset:function(){st({status:"not-executed",error:void 0,result:De}),He.current=void 0,gt.current=void 0}});return[rt,(0,v.useMemo)(function(){return{reset:function(){tt.current.reset()},execute:function(){for(var Je,It=[],ee=0;ee<arguments.length;ee++)It[ee]=arguments[ee];return(Je=tt.current).execute.apply(Je,It)}}},[]),{promise:He.current,lastArgs:gt.current}]}},78887:function(Bn,pt,z){"use strict";z.d(pt,{F:function(){return me}});var v=z(2784),ke=z(29862);function me(I){var se=(0,v.useState)(I),Ne=se[0],De=se[1],Tt=(0,ke.t)(!0);return[Ne,(0,v.useCallback)(function(rt){Tt()&&De(rt)},[])]}},67142:function(Bn){(function(pt,z){Bn.exports=z()})(typeof self!="undefined"?self:this,()=>(()=>{"use strict";var pt={d:(le,Ie)=>{for(var ze in Ie)pt.o(Ie,ze)&&!pt.o(le,ze)&&Object.defineProperty(le,ze,{enumerable:!0,get:Ie[ze]})},o:(le,Ie)=>Object.prototype.hasOwnProperty.call(le,Ie),r:le=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(le,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(le,"__esModule",{value:!0})}},z={};function v(le){return le==="#"||le===""||Array.isArray(le)&&le.length===0||!1}pt.r(z),pt.d(z,{default:()=>yt,get:()=>rt,isRoot:()=>v,join:()=>Ye,remove:()=>ge,removeUndefinedItems:()=>Me,set:()=>Je,split:()=>Tt,splitLast:()=>K});const ke=/~1/g,me=/~0/g,I=/\/+/g,se=/(^[#/]*|\/+$)/g;function Ne(le){return le.replace(ke,"/").replace(me,"~")}function De(le){return Ne(decodeURIComponent(le))}function Tt(le){if(le==null||typeof le!="string"||v(le))return Array.isArray(le)?le:[];const Ie=le.indexOf("#")>=0?De:Ne,ze=(le=(le=le.replace(I,"/")).replace(se,"")).split("/");for(let ot=0,Ae=ze.length;ot<Ae;ot+=1)ze[ot]=Ie(ze[ot]);return ze}function rt(le,Ie,ze=void 0){if(Ie==null||le==null)return ze;if(v(Ie))return le;const ot=st(le,Tt(Ie));return ot===void 0?ze:ot}function st(le,Ie){const ze=Ie.shift();if(le!==void 0)return ze!==void 0?st(le[ze],Ie):le}const He=/^\[.*\]$/,gt=/^\[(.+)\]$/;function tt(le,Ie){return le==="__proto__"||le=="constructor"&&Ie.length>0&&Ie[0]=="prototype"}function Je(le,Ie,ze){if(Ie==null)return le;const ot=Tt(Ie);if(ot.length===0)return le;le==null&&(le=He.test(ot[0])?[]:{});let Ae,Ue,Ge=le;for(;ot.length>1;)Ae=ot.shift(),Ue=He.test(ot[0]),tt(Ae,ot)||(Ge=ee(Ge,Ae,Ue));return Ae=ot.pop(),It(Ge,Ae,ze),le}function It(le,Ie,ze){let ot;const Ae=Ie.match(gt);Ie==="[]"&&Array.isArray(le)?le.push(ze):Ae?(ot=Ae.pop(),le[ot]=ze):le[Ie]=ze}function ee(le,Ie,ze){if(le[Ie]!=null)return le[Ie];const ot=ze?[]:{};return It(le,Ie,ot),ot}function Me(le){let Ie=0,ze=0;for(;Ie+ze<le.length;)le[Ie+ze]===void 0&&(ze+=1),le[Ie]=le[Ie+ze],Ie+=1;return le.length=le.length-ze,le}function ge(le,Ie,ze){const ot=Tt(Ie),Ae=ot.pop(),Ue=rt(le,ot);return Ue&&delete Ue[Ae],Array.isArray(Ue)&&ze!==!0&&Me(Ue),le}const je=/\/+/g,Ze=/~/g,Oe=/\//g;function Xe(le,Ie){if(le.length===0)return Ie?"#":"";for(let ze=0,ot=le.length;ze<ot;ze+=1)le[ze]=le[ze].replace(Ze,"~0").replace(Oe,"~1"),Ie&&(le[ze]=encodeURIComponent(le[ze]));return((Ie?"#/":"/")+le.join("/")).replace(je,"/")}function Ye(le,...Ie){const ze=[];if(Array.isArray(le))return Xe(le,arguments[1]===!0);const ot=arguments[arguments.length-1],Ae=typeof ot=="boolean"?ot:le&&le[0]==="#";for(let Ge=0,lt=arguments.length;Ge<lt;Ge+=1)ze.push.apply(ze,Tt(arguments[Ge]));const Ue=[];for(let Ge=0,lt=ze.length;Ge<lt;Ge+=1)if(ze[Ge]===".."){if(Ue.length===0)return Ae?"#":"";Ue.pop()}else Ue.push(ze[Ge]);return Xe(Ue,Ae)}function K(le){const Ie=Tt(le);if(Ie.length===0)return typeof le=="string"&&le[0]==="#"?["#",Ie[0]]:["",void 0];if(Ie.length===1)return le[0]==="#"?["#",Ie[0]]:["",Ie[0]];const ze=Ie.pop();return[Ye(Ie,le[0]==="#"),ze]}const yt={get:rt,set:Je,remove:ge,join:Ye,split:Tt,splitLast:K,isRoot:v,removeUndefinedItems:Me};return z})())},2552:function(Bn,pt,z){"use strict";z.d(pt,{ZP:function(){return Tl}});var v=z(7896),ke=z(31461),me=z(2784),I=z(1727),se=z(65329),Ne=z(77120),De=z(21649);const Tt=i=>{let{state:n}=i,l=n.doc.lineAt(n.selection.main.from),c=Me(i.state,l.from);return c.line?st(i):c.block?ee(i):!1};function rt(i,n){return({state:l,dispatch:c})=>{if(l.readOnly)return!1;let p=i(n,l);return p?(c(l.update(p)),!0):!1}}const st=rt(Xe,0),He=null,gt=null,tt=rt(Oe,0),Je=null,It=null,ee=rt((i,n)=>Oe(i,n,Ze(n)),0);function Me(i,n){let l=i.languageDataAt("commentTokens",n);return l.length?l[0]:{}}const ge=50;function je(i,{open:n,close:l},c,p){let y=i.sliceDoc(c-ge,c),T=i.sliceDoc(p,p+ge),L=/\s*$/.exec(y)[0].length,V=/^\s*/.exec(T)[0].length,re=y.length-L;if(y.slice(re-n.length,re)==n&&T.slice(V,V+l.length)==l)return{open:{pos:c-L,margin:L&&1},close:{pos:p+V,margin:V&&1}};let fe,Fe;p-c<=2*ge?fe=Fe=i.sliceDoc(c,p):(fe=i.sliceDoc(c,c+ge),Fe=i.sliceDoc(p-ge,p));let Et=/^\s*/.exec(fe)[0].length,nn=/\s*$/.exec(Fe)[0].length,sr=Fe.length-nn-l.length;return fe.slice(Et,Et+n.length)==n&&Fe.slice(sr,sr+l.length)==l?{open:{pos:c+Et+n.length,margin:/\s/.test(fe.charAt(Et+n.length))?1:0},close:{pos:p-nn-l.length,margin:/\s/.test(Fe.charAt(sr-1))?1:0}}:null}function Ze(i){let n=[];for(let l of i.selection.ranges){let c=i.doc.lineAt(l.from),p=l.to<=c.to?c:i.doc.lineAt(l.to),y=n.length-1;y>=0&&n[y].to>c.from?n[y].to=p.to:n.push({from:c.from+/^\s*/.exec(c.text)[0].length,to:p.to})}return n}function Oe(i,n,l=n.selection.ranges){let c=l.map(y=>Me(n,y.from).block);if(!c.every(y=>y))return null;let p=l.map((y,T)=>je(n,c[T],y.from,y.to));if(i!=2&&!p.every(y=>y))return{changes:n.changes(l.map((y,T)=>p[T]?[]:[{from:y.from,insert:c[T].open+" "},{from:y.to,insert:" "+c[T].close}]))};if(i!=1&&p.some(y=>y)){let y=[];for(let T=0,L;T<p.length;T++)if(L=p[T]){let V=c[T],{open:re,close:fe}=L;y.push({from:re.pos-V.open.length,to:re.pos+re.margin},{from:fe.pos-fe.margin,to:fe.pos+V.close.length})}return{changes:y}}return null}function Xe(i,n,l=n.selection.ranges){let c=[],p=-1;for(let{from:y,to:T}of l){let L=c.length,V=1e9,re=Me(n,y).line;if(re){for(let fe=y;fe<=T;){let Fe=n.doc.lineAt(fe);if(Fe.from>p&&(y==T||T>Fe.from)){p=Fe.from;let Et=/^\s*/.exec(Fe.text)[0].length,nn=Et==Fe.length,sr=Fe.text.slice(Et,Et+re.length)==re?Et:-1;Et<Fe.text.length&&Et<V&&(V=Et),c.push({line:Fe,comment:sr,token:re,indent:Et,empty:nn,single:!1})}fe=Fe.to+1}if(V<1e9)for(let fe=L;fe<c.length;fe++)c[fe].indent<c[fe].line.text.length&&(c[fe].indent=V);c.length==L+1&&(c[L].single=!0)}}if(i!=2&&c.some(y=>y.comment<0&&(!y.empty||y.single))){let y=[];for(let{line:L,token:V,indent:re,empty:fe,single:Fe}of c)(Fe||!fe)&&y.push({from:L.from+re,insert:V+" "});let T=n.changes(y);return{changes:T,selection:n.selection.map(T,1)}}else if(i!=1&&c.some(y=>y.comment>=0)){let y=[];for(let{line:T,comment:L,token:V}of c)if(L>=0){let re=T.from+L,fe=re+V.length;T.text[fe-T.from]==" "&&fe++,y.push({from:re,to:fe})}return{changes:y}}return null}const Ye=I.q6.define(),K=I.q6.define(),yt=I.r$.define(),le=I.r$.define({combine(i){return(0,I.BO)(i,{minDepth:100,newGroupDelay:500,joinToEvent:(n,l)=>l},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(n,l)=>(c,p)=>n(c,p)||l(c,p)})}});function Ie(i){let n=0;return i.iterChangedRanges((l,c)=>n=c),n}const ze=I.QQ.define({create(){return ne.empty},update(i,n){let l=n.state.facet(le),c=n.annotation(Ye);if(c){let V=n.docChanged?I.jT.single(Ie(n.changes)):void 0,re=Wt.fromTransaction(n,V),fe=c.side,Fe=fe==0?i.undone:i.done;return re?Fe=Zt(Fe,Fe.length,l.minDepth,re):Fe=Ee(Fe,n.startState.selection),new ne(fe==0?c.rest:Fe,fe==0?Fe:c.rest)}let p=n.annotation(K);if((p=="full"||p=="before")&&(i=i.isolate()),n.annotation(I.YW.addToHistory)===!1)return n.changes.empty?i:i.addMapping(n.changes.desc);let y=Wt.fromTransaction(n),T=n.annotation(I.YW.time),L=n.annotation(I.YW.userEvent);return y?i=i.addChanges(y,T,L,l,n):n.selection&&(i=i.addSelection(n.startState.selection,T,L,l.newGroupDelay)),(p=="full"||p=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(n=>n.toJSON()),undone:i.undone.map(n=>n.toJSON())}},fromJSON(i){return new ne(i.done.map(Wt.fromJSON),i.undone.map(Wt.fromJSON))}});function ot(i={}){return[ze,le.of(i),se.tk.domEventHandlers({beforeinput(n,l){let c=n.inputType=="historyUndo"?Ge:n.inputType=="historyRedo"?lt:null;return c?(n.preventDefault(),c(l)):!1}})]}const Ae=null;function Ue(i,n){return function({state:l,dispatch:c}){if(!n&&l.readOnly)return!1;let p=l.field(ze,!1);if(!p)return!1;let y=p.pop(i,l,n);return y?(c(y),!0):!1}}const Ge=Ue(0,!1),lt=Ue(1,!1),ye=Ue(0,!0),xe=Ue(1,!0);function We(i){return function(n){let l=n.field(ze,!1);if(!l)return 0;let c=i==0?l.done:l.undone;return c.length-(c.length&&!c[0].changes?1:0)}}const vt=null,Pt=null;class Wt{constructor(n,l,c,p,y){this.changes=n,this.effects=l,this.mapped=c,this.startSelection=p,this.selectionsAfter=y}setSelAfter(n){return new Wt(this.changes,this.effects,this.mapped,this.startSelection,n)}toJSON(){var n,l,c;return{changes:(n=this.changes)===null||n===void 0?void 0:n.toJSON(),mapped:(l=this.mapped)===null||l===void 0?void 0:l.toJSON(),startSelection:(c=this.startSelection)===null||c===void 0?void 0:c.toJSON(),selectionsAfter:this.selectionsAfter.map(p=>p.toJSON())}}static fromJSON(n){return new Wt(n.changes&&I.as.fromJSON(n.changes),[],n.mapped&&I.n0.fromJSON(n.mapped),n.startSelection&&I.jT.fromJSON(n.startSelection),n.selectionsAfter.map(I.jT.fromJSON))}static fromTransaction(n,l){let c=Lt;for(let p of n.startState.facet(yt)){let y=p(n);y.length&&(c=c.concat(y))}return!c.length&&n.changes.empty?null:new Wt(n.changes.invert(n.startState.doc),c,void 0,l||n.startState.selection,Lt)}static selection(n){return new Wt(void 0,Lt,void 0,void 0,n)}}function Zt(i,n,l,c){let p=n+1>l+20?n-l-1:0,y=i.slice(p,n);return y.push(c),y}function In(i,n){let l=[],c=!1;return i.iterChangedRanges((p,y)=>l.push(p,y)),n.iterChangedRanges((p,y,T,L)=>{for(let V=0;V<l.length;){let re=l[V++],fe=l[V++];L>=re&&T<=fe&&(c=!0)}}),c}function xn(i,n){return i.ranges.length==n.ranges.length&&i.ranges.filter((l,c)=>l.empty!=n.ranges[c].empty).length===0}function er(i,n){return i.length?n.length?i.concat(n):i:n}const Lt=[],rn=200;function Ee(i,n){if(i.length){let l=i[i.length-1],c=l.selectionsAfter.slice(Math.max(0,l.selectionsAfter.length-rn));return c.length&&c[c.length-1].eq(n)?i:(c.push(n),Zt(i,i.length-1,1e9,l.setSelAfter(c)))}else return[Wt.selection([n])]}function O(i){let n=i[i.length-1],l=i.slice();return l[i.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),l}function N(i,n){if(!i.length)return i;let l=i.length,c=Lt;for(;l;){let p=W(i[l-1],n,c);if(p.changes&&!p.changes.empty||p.effects.length){let y=i.slice(0,l);return y[l-1]=p,y}else n=p.mapped,l--,c=p.selectionsAfter}return c.length?[Wt.selection(c)]:Lt}function W(i,n,l){let c=er(i.selectionsAfter.length?i.selectionsAfter.map(L=>L.map(n)):Lt,l);if(!i.changes)return Wt.selection(c);let p=i.changes.map(n),y=n.mapDesc(i.changes,!0),T=i.mapped?i.mapped.composeDesc(y):y;return new Wt(p,I.Py.mapEffects(i.effects,n),T,i.startSelection.map(y),c)}const G=/^(input\.type|delete)($|\.)/;class ne{constructor(n,l,c=0,p=void 0){this.done=n,this.undone=l,this.prevTime=c,this.prevUserEvent=p}isolate(){return this.prevTime?new ne(this.done,this.undone):this}addChanges(n,l,c,p,y){let T=this.done,L=T[T.length-1];return L&&L.changes&&!L.changes.empty&&n.changes&&(!c||G.test(c))&&(!L.selectionsAfter.length&&l-this.prevTime<p.newGroupDelay&&p.joinToEvent(y,In(L.changes,n.changes))||c=="input.type.compose")?T=Zt(T,T.length-1,p.minDepth,new Wt(n.changes.compose(L.changes),er(n.effects,L.effects),L.mapped,L.startSelection,Lt)):T=Zt(T,T.length,p.minDepth,n),new ne(T,Lt,l,c)}addSelection(n,l,c,p){let y=this.done.length?this.done[this.done.length-1].selectionsAfter:Lt;return y.length>0&&l-this.prevTime<p&&c==this.prevUserEvent&&c&&/^select($|\.)/.test(c)&&xn(y[y.length-1],n)?this:new ne(Ee(this.done,n),this.undone,l,c)}addMapping(n){return new ne(N(this.done,n),N(this.undone,n),this.prevTime,this.prevUserEvent)}pop(n,l,c){let p=n==0?this.done:this.undone;if(p.length==0)return null;let y=p[p.length-1];if(c&&y.selectionsAfter.length)return l.update({selection:y.selectionsAfter[y.selectionsAfter.length-1],annotations:Ye.of({side:n,rest:O(p)}),userEvent:n==0?"select.undo":"select.redo",scrollIntoView:!0});if(y.changes){let T=p.length==1?Lt:p.slice(0,p.length-1);return y.mapped&&(T=N(T,y.mapped)),l.update({changes:y.changes,selection:y.startSelection,effects:y.effects,annotations:Ye.of({side:n,rest:T}),filter:!1,userEvent:n==0?"undo":"redo",scrollIntoView:!0})}else return null}}ne.empty=new ne(Lt,Lt);const pe=[{key:"Mod-z",run:Ge,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:lt,preventDefault:!0},{linux:"Ctrl-Shift-z",run:lt,preventDefault:!0},{key:"Mod-u",run:ye,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:xe,preventDefault:!0}];function Se(i,n){return I.jT.create(i.ranges.map(n),i.mainIndex)}function $e(i,n){return i.update({selection:n,scrollIntoView:!0,userEvent:"select"})}function ve({state:i,dispatch:n},l){let c=Se(i.selection,l);return c.eq(i.selection)?!1:(n($e(i,c)),!0)}function ut(i,n){return I.jT.cursor(n?i.to:i.from)}function St(i,n){return ve(i,l=>l.empty?i.moveByChar(l,n):ut(l,n))}function at(i){return i.textDirectionAt(i.state.selection.main.head)==se.Nm.LTR}const zt=i=>St(i,!at(i)),Ft=i=>St(i,at(i)),Qt=i=>St(i,!0),Jn=i=>St(i,!1);function En(i,n){return ve(i,l=>l.empty?i.moveByGroup(l,n):ut(l,n))}const or=i=>En(i,!at(i)),Gt=i=>En(i,at(i)),Mt=i=>En(i,!0),yn=i=>En(i,!1);function Ct(i,n,l){let c=i.state.charCategorizer(n.from);return i.moveByChar(n,l,p=>{let y=CharCategory.Space,T=n.from,L=!1,V=!1,re=!1,fe=Fe=>{if(L)return!1;T+=l?Fe.length:-Fe.length;let Et=c(Fe),nn;if(Et==CharCategory.Word&&Fe.charCodeAt(0)<128&&/[\W_]/.test(Fe)&&(Et=-1),y==CharCategory.Space&&(y=Et),y!=Et)return!1;if(y==CharCategory.Word)if(Fe.toLowerCase()==Fe){if(!l&&V)return!1;re=!0}else if(re){if(l)return!1;L=!0}else{if(V&&l&&c(nn=i.state.sliceDoc(T,T+1))==CharCategory.Word&&nn.toLowerCase()==nn)return!1;V=!0}return!0};return fe(p),fe})}function Kt(i,n){return ve(i,l=>l.empty?Ct(i,l,n):ut(l,n))}const Xt=i=>Kt(i,!0),Jt=i=>Kt(i,!1);function bt(i,n,l){if(n.type.prop(l))return!0;let c=n.to-n.from;return c&&(c>2||/[^\s,.;:]/.test(i.sliceDoc(n.from,n.to)))||n.firstChild}function wt(i,n,l){let c=(0,Ne.qz)(i).resolveInner(n.head),p=l?De.md.closedBy:De.md.openedBy;for(let V=n.head;;){let re=l?c.childAfter(V):c.childBefore(V);if(!re)break;bt(i,re,p)?c=re:V=l?re.to:re.from}let y=c.type.prop(p),T,L;return y&&(T=l?(0,Ne.Um)(i,c.from,1):(0,Ne.Um)(i,c.to,-1))&&T.matched?L=l?T.end.to:T.end.from:L=l?c.to:c.from,I.jT.cursor(L,l?-1:1)}const an=i=>ve(i,n=>wt(i.state,n,!at(i))),hn=i=>ve(i,n=>wt(i.state,n,at(i)));function Vn(i,n){return ve(i,l=>{if(!l.empty)return ut(l,n);let c=i.moveVertically(l,n);return c.head!=l.head?c:i.moveToLineBoundary(l,n)})}const Hn=i=>Vn(i,!1),cr=i=>Vn(i,!0);function wr(i){let n=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,l=0,c=0,p;if(n){for(let y of i.state.facet(se.tk.scrollMargins)){let T=y(i);T!=null&&T.top&&(l=Math.max(T==null?void 0:T.top,l)),T!=null&&T.bottom&&(c=Math.max(T==null?void 0:T.bottom,c))}p=i.scrollDOM.clientHeight-l-c}else p=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:l,marginBottom:c,selfScroll:n,height:Math.max(i.defaultLineHeight,p-5)}}function Bt(i,n){let l=wr(i),{state:c}=i,p=Se(c.selection,T=>T.empty?i.moveVertically(T,n,l.height):ut(T,n));if(p.eq(c.selection))return!1;let y;if(l.selfScroll){let T=i.coordsAtPos(c.selection.main.head),L=i.scrollDOM.getBoundingClientRect(),V=L.top+l.marginTop,re=L.bottom-l.marginBottom;T&&T.top>V&&T.bottom<re&&(y=se.tk.scrollIntoView(p.main.head,{y:"start",yMargin:T.top-V}))}return i.dispatch($e(c,p),{effects:y}),!0}const Pn=i=>Bt(i,!1),Yt=i=>Bt(i,!0);function un(i,n,l){let c=i.lineBlockAt(n.head),p=i.moveToLineBoundary(n,l);if(p.head==n.head&&p.head!=(l?c.to:c.from)&&(p=i.moveToLineBoundary(n,l,!1)),!l&&p.head==c.from&&c.length){let y=/^\s*/.exec(i.state.sliceDoc(c.from,Math.min(c.from+100,c.to)))[0].length;y&&n.head!=c.from+y&&(p=I.jT.cursor(c.from+y))}return p}const Xn=i=>ve(i,n=>un(i,n,!0)),fr=i=>ve(i,n=>un(i,n,!1)),zn=i=>ve(i,n=>un(i,n,!at(i))),Hi=i=>ve(i,n=>un(i,n,at(i))),$r=i=>ve(i,n=>I.jT.cursor(i.lineBlockAt(n.head).from,1)),ri=i=>ve(i,n=>I.jT.cursor(i.lineBlockAt(n.head).to,-1));function Ln(i,n,l){let c=!1,p=Se(i.selection,y=>{let T=(0,Ne.Um)(i,y.head,-1)||(0,Ne.Um)(i,y.head,1)||y.head>0&&(0,Ne.Um)(i,y.head-1,1)||y.head<i.doc.length&&(0,Ne.Um)(i,y.head+1,-1);if(!T||!T.end)return y;c=!0;let L=T.start.from==y.head?T.end.to:T.end.from;return l?I.jT.range(y.anchor,L):I.jT.cursor(L)});return c?(n($e(i,p)),!0):!1}const gr=({state:i,dispatch:n})=>Ln(i,n,!1),ai=({state:i,dispatch:n})=>Ln(i,n,!0);function Dn(i,n){let l=Se(i.state.selection,c=>{let p=n(c);return I.jT.range(c.anchor,p.head,p.goalColumn,p.bidiLevel||void 0)});return l.eq(i.state.selection)?!1:(i.dispatch($e(i.state,l)),!0)}function yr(i,n){return Dn(i,l=>i.moveByChar(l,n))}const Gr=i=>yr(i,!at(i)),kn=i=>yr(i,at(i)),tr=i=>yr(i,!0),qi=i=>yr(i,!1);function Cr(i,n){return Dn(i,l=>i.moveByGroup(l,n))}const Zn=i=>Cr(i,!at(i)),j=i=>Cr(i,at(i)),f=i=>Cr(i,!0),g=i=>Cr(i,!1);function S(i,n){return Dn(i,l=>Ct(i,l,n))}const C=i=>S(i,!0),P=i=>S(i,!1),M=i=>Dn(i,n=>wt(i.state,n,!at(i))),Z=i=>Dn(i,n=>wt(i.state,n,at(i)));function U(i,n){return Dn(i,l=>i.moveVertically(l,n))}const he=i=>U(i,!1),ue=i=>U(i,!0);function Be(i,n){return Dn(i,l=>i.moveVertically(l,n,wr(i).height))}const ft=i=>Be(i,!1),_e=i=>Be(i,!0),on=i=>Dn(i,n=>un(i,n,!0)),Gn=i=>Dn(i,n=>un(i,n,!1)),sn=i=>Dn(i,n=>un(i,n,!at(i))),Rn=i=>Dn(i,n=>un(i,n,at(i))),Vr=i=>Dn(i,n=>I.jT.cursor(i.lineBlockAt(n.head).from)),Di=i=>Dn(i,n=>I.jT.cursor(i.lineBlockAt(n.head).to)),nr=({state:i,dispatch:n})=>(n($e(i,{anchor:0})),!0),Sn=({state:i,dispatch:n})=>(n($e(i,{anchor:i.doc.length})),!0),Ri=({state:i,dispatch:n})=>(n($e(i,{anchor:i.selection.main.anchor,head:0})),!0),Ii=({state:i,dispatch:n})=>(n($e(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),ci=({state:i,dispatch:n})=>(n(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),bi=({state:i,dispatch:n})=>{let l=vr(i).map(({from:c,to:p})=>I.jT.range(c,Math.min(p+1,i.doc.length)));return n(i.update({selection:I.jT.create(l),userEvent:"select"})),!0},_i=({state:i,dispatch:n})=>{let l=Se(i.selection,c=>{var p;let y=(0,Ne.qz)(i).resolveInner(c.head,1);for(;!(y.from<c.from&&y.to>=c.to||y.to>c.to&&y.from<=c.from||!(!((p=y.parent)===null||p===void 0)&&p.parent));)y=y.parent;return I.jT.range(y.to,y.from)});return n($e(i,l)),!0},B=({state:i,dispatch:n})=>{let l=i.selection,c=null;return l.ranges.length>1?c=I.jT.create([l.main]):l.main.empty||(c=I.jT.create([I.jT.cursor(l.main.head)])),c?(n($e(i,c)),!0):!1};function b(i,n){if(i.state.readOnly)return!1;let l="delete.selection",{state:c}=i,p=c.changeByRange(y=>{let{from:T,to:L}=y;if(T==L){let V=n(T);V<T?(l="delete.backward",V=k(i,V,!1)):V>T&&(l="delete.forward",V=k(i,V,!0)),T=Math.min(T,V),L=Math.max(L,V)}else T=k(i,T,!1),L=k(i,L,!0);return T==L?{range:y}:{changes:{from:T,to:L},range:I.jT.cursor(T)}});return p.changes.empty?!1:(i.dispatch(c.update(p,{scrollIntoView:!0,userEvent:l,effects:l=="delete.selection"?se.tk.announce.of(c.phrase("Selection deleted")):void 0})),!0)}function k(i,n,l){if(i instanceof se.tk)for(let c of i.state.facet(se.tk.atomicRanges).map(p=>p(i)))c.between(n,n,(p,y)=>{p<n&&y>n&&(n=l?y:p)});return n}const $=(i,n)=>b(i,l=>{let{state:c}=i,p=c.doc.lineAt(l),y,T;if(!n&&l>p.from&&l<p.from+200&&!/[^ \t]/.test(y=p.text.slice(0,l-p.from))){if(y[y.length-1]=="	")return l-1;let L=(0,I.IS)(y,c.tabSize),V=L%(0,Ne.y1)(c)||(0,Ne.y1)(c);for(let re=0;re<V&&y[y.length-1-re]==" ";re++)l--;T=l}else T=(0,I.cp)(p.text,l-p.from,n,n)+p.from,T==l&&p.number!=(n?c.doc.lines:1)&&(T+=n?1:-1);return T}),H=i=>$(i,!1),te=i=>$(i,!0),oe=(i,n)=>b(i,l=>{let c=l,{state:p}=i,y=p.doc.lineAt(c),T=p.charCategorizer(c);for(let L=null;;){if(c==(n?y.to:y.from)){c==l&&y.number!=(n?p.doc.lines:1)&&(c+=n?1:-1);break}let V=(0,I.cp)(y.text,c-y.from,n)+y.from,re=y.text.slice(Math.min(c,V)-y.from,Math.max(c,V)-y.from),fe=T(re);if(L!=null&&fe!=L)break;(re!=" "||c!=l)&&(L=fe),c=V}return c}),Re=i=>oe(i,!1),Te=i=>oe(i,!0),kt=i=>b(i,n=>{let l=i.lineBlockAt(n).to;return n<l?l:Math.min(i.state.doc.length,n+1)}),Ot=i=>b(i,n=>{let l=i.lineBlockAt(n).from;return n>l?l:Math.max(0,n-1)}),cn=({state:i,dispatch:n})=>{if(i.readOnly)return!1;let l=[];for(let c=0,p="",y=i.doc.iter();;){if(y.next(),y.lineBreak||y.done){let T=p.search(/\s+$/);if(T>-1&&l.push({from:c-(p.length-T),to:c}),y.done)break;p=""}else p=y.value;c+=y.value.length}return l.length?(n(i.update({changes:l,userEvent:"delete"})),!0):!1},Yn=({state:i,dispatch:n})=>{if(i.readOnly)return!1;let l=i.changeByRange(c=>({changes:{from:c.from,to:c.to,insert:I.xv.of(["",""])},range:I.jT.cursor(c.from)}));return n(i.update(l,{scrollIntoView:!0,userEvent:"input"})),!0},Qn=({state:i,dispatch:n})=>{if(i.readOnly)return!1;let l=i.changeByRange(c=>{if(!c.empty||c.from==0||c.from==i.doc.length)return{range:c};let p=c.from,y=i.doc.lineAt(p),T=p==y.from?p-1:(0,I.cp)(y.text,p-y.from,!1)+y.from,L=p==y.to?p+1:(0,I.cp)(y.text,p-y.from,!0)+y.from;return{changes:{from:T,to:L,insert:i.doc.slice(p,L).append(i.doc.slice(T,p))},range:I.jT.cursor(L)}});return l.changes.empty?!1:(n(i.update(l,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function vr(i){let n=[],l=-1;for(let c of i.selection.ranges){let p=i.doc.lineAt(c.from),y=i.doc.lineAt(c.to);if(!c.empty&&c.to==y.from&&(y=i.doc.lineAt(c.to-1)),l>=p.number){let T=n[n.length-1];T.to=y.to,T.ranges.push(c)}else n.push({from:p.from,to:y.to,ranges:[c]});l=y.number+1}return n}function Un(i,n,l){if(i.readOnly)return!1;let c=[],p=[];for(let y of vr(i)){if(l?y.to==i.doc.length:y.from==0)continue;let T=i.doc.lineAt(l?y.to+1:y.from-1),L=T.length+1;if(l){c.push({from:y.to,to:T.to},{from:y.from,insert:T.text+i.lineBreak});for(let V of y.ranges)p.push(I.jT.range(Math.min(i.doc.length,V.anchor+L),Math.min(i.doc.length,V.head+L)))}else{c.push({from:T.from,to:y.from},{from:y.to,insert:i.lineBreak+T.text});for(let V of y.ranges)p.push(I.jT.range(V.anchor-L,V.head-L))}}return c.length?(n(i.update({changes:c,scrollIntoView:!0,selection:I.jT.create(p,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const xi=({state:i,dispatch:n})=>Un(i,n,!1),Si=({state:i,dispatch:n})=>Un(i,n,!0);function ms(i,n,l){if(i.readOnly)return!1;let c=[];for(let p of vr(i))l?c.push({from:p.from,insert:i.doc.slice(p.from,p.to)+i.lineBreak}):c.push({from:p.to,insert:i.lineBreak+i.doc.slice(p.from,p.to)});return n(i.update({changes:c,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Ws=({state:i,dispatch:n})=>ms(i,n,!1),Hs=({state:i,dispatch:n})=>ms(i,n,!0),es=i=>{if(i.state.readOnly)return!1;let{state:n}=i,l=n.changes(vr(n).map(({from:p,to:y})=>(p>0?p--:y<n.doc.length&&y++,{from:p,to:y}))),c=Se(n.selection,p=>i.moveVertically(p,!0)).map(l);return i.dispatch({changes:l,selection:c,scrollIntoView:!0,userEvent:"delete.line"}),!0},As=({state:i,dispatch:n})=>(n(i.update(i.replaceSelection(i.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function zs(i,n){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(n-1,n+1)))return{from:n,to:n};let l=(0,Ne.qz)(i).resolveInner(n),c=l.childBefore(n),p=l.childAfter(n),y;return c&&p&&c.to<=n&&p.from>=n&&(y=c.type.prop(De.md.closedBy))&&y.indexOf(p.name)>-1&&i.doc.lineAt(c.to).from==i.doc.lineAt(p.from).from?{from:c.to,to:p.from}:null}const dn=fi(!1),Zs=fi(!0);function fi(i){return({state:n,dispatch:l})=>{if(n.readOnly)return!1;let c=n.changeByRange(p=>{let{from:y,to:T}=p,L=n.doc.lineAt(y),V=!i&&y==T&&zs(n,y);i&&(y=T=(T<=L.to?L:n.doc.lineAt(T)).to);let re=new Ne.Gn(n,{simulateBreak:y,simulateDoubleBreak:!!V}),fe=(0,Ne.K0)(re,y);for(fe==null&&(fe=/^\s*/.exec(n.doc.lineAt(y).text)[0].length);T<L.to&&/\s/.test(L.text[T-L.from]);)T++;V?{from:y,to:T}=V:y>L.from&&y<L.from+100&&!/\S/.test(L.text.slice(0,y))&&(y=L.from);let Fe=["",(0,Ne.SS)(n,fe)];return V&&Fe.push((0,Ne.SS)(n,re.lineIndent(L.from,-1))),{changes:{from:y,to:T,insert:I.xv.of(Fe)},range:I.jT.cursor(y+1+Fe[1].length)}});return l(n.update(c,{scrollIntoView:!0,userEvent:"input"})),!0}}function zi(i,n){let l=-1;return i.changeByRange(c=>{let p=[];for(let T=c.from;T<=c.to;){let L=i.doc.lineAt(T);L.number>l&&(c.empty||c.to>L.from)&&(n(L,p,c),l=L.number),T=L.to+1}let y=i.changes(p);return{changes:p,range:I.jT.range(y.mapPos(c.anchor,1),y.mapPos(c.head,1))}})}const Us=({state:i,dispatch:n})=>{if(i.readOnly)return!1;let l=Object.create(null),c=new Ne.Gn(i,{overrideIndentation:y=>{let T=l[y];return T==null?-1:T}}),p=zi(i,(y,T,L)=>{let V=(0,Ne.K0)(c,y.from);if(V==null)return;/\S/.test(y.text)||(V=0);let re=/^\s*/.exec(y.text)[0],fe=(0,Ne.SS)(i,V);(re!=fe||L.from<y.from+re.length)&&(l[y.from]=V,T.push({from:y.from,to:y.from+re.length,insert:fe}))});return p.changes.empty||n(i.update(p,{userEvent:"indent"})),!0},ts=({state:i,dispatch:n})=>i.readOnly?!1:(n(i.update(zi(i,(l,c)=>{c.push({from:l.from,insert:i.facet(Ne.c)})}),{userEvent:"input.indent"})),!0),Ts=({state:i,dispatch:n})=>i.readOnly?!1:(n(i.update(zi(i,(l,c)=>{let p=/^\s*/.exec(l.text)[0];if(!p)return;let y=(0,I.IS)(p,i.tabSize),T=0,L=(0,Ne.SS)(i,Math.max(0,y-(0,Ne.y1)(i)));for(;T<p.length&&T<L.length&&p.charCodeAt(T)==L.charCodeAt(T);)T++;c.push({from:l.from+T,to:l.from+p.length,insert:L.slice(T)})}),{userEvent:"delete.dedent"})),!0),Ks=({state:i,dispatch:n})=>i.selection.ranges.some(l=>!l.empty)?ts({state:i,dispatch:n}):(n(i.update(i.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),ns=[{key:"Ctrl-b",run:zt,shift:Gr,preventDefault:!0},{key:"Ctrl-f",run:Ft,shift:kn},{key:"Ctrl-p",run:Hn,shift:he},{key:"Ctrl-n",run:cr,shift:ue},{key:"Ctrl-a",run:$r,shift:Vr},{key:"Ctrl-e",run:ri,shift:Di},{key:"Ctrl-d",run:te},{key:"Ctrl-h",run:H},{key:"Ctrl-k",run:kt},{key:"Ctrl-Alt-h",run:Re},{key:"Ctrl-o",run:Yn},{key:"Ctrl-t",run:Qn},{key:"Ctrl-v",run:Yt}],rs=[{key:"ArrowLeft",run:zt,shift:Gr,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:or,shift:Zn,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:zn,shift:sn,preventDefault:!0},{key:"ArrowRight",run:Ft,shift:kn,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Gt,shift:j,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Hi,shift:Rn,preventDefault:!0},{key:"ArrowUp",run:Hn,shift:he,preventDefault:!0},{mac:"Cmd-ArrowUp",run:nr,shift:Ri},{mac:"Ctrl-ArrowUp",run:Pn,shift:ft},{key:"ArrowDown",run:cr,shift:ue,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Sn,shift:Ii},{mac:"Ctrl-ArrowDown",run:Yt,shift:_e},{key:"PageUp",run:Pn,shift:ft},{key:"PageDown",run:Yt,shift:_e},{key:"Home",run:fr,shift:Gn,preventDefault:!0},{key:"Mod-Home",run:nr,shift:Ri},{key:"End",run:Xn,shift:on,preventDefault:!0},{key:"Mod-End",run:Sn,shift:Ii},{key:"Enter",run:dn},{key:"Mod-a",run:ci},{key:"Backspace",run:H,shift:H},{key:"Delete",run:te},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Re},{key:"Mod-Delete",mac:"Alt-Delete",run:Te},{mac:"Mod-Backspace",run:Ot},{mac:"Mod-Delete",run:kt}].concat(ns.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),Js=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:an,shift:M},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:hn,shift:Z},{key:"Alt-ArrowUp",run:xi},{key:"Shift-Alt-ArrowUp",run:Ws},{key:"Alt-ArrowDown",run:Si},{key:"Shift-Alt-ArrowDown",run:Hs},{key:"Escape",run:B},{key:"Mod-Enter",run:Zs},{key:"Alt-l",mac:"Ctrl-l",run:bi},{key:"Mod-i",run:_i,preventDefault:!0},{key:"Mod-[",run:Ts},{key:"Mod-]",run:ts},{key:"Mod-Alt-\\",run:Us},{key:"Shift-Mod-k",run:es},{key:"Shift-Mod-\\",run:gr},{key:"Mod-/",run:Tt},{key:"Alt-A",run:tt}].concat(rs),Gs={key:"Tab",run:ts,shift:Ts};function Cn(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var n=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var c in l)if(Object.prototype.hasOwnProperty.call(l,c)){var p=l[c];typeof p=="string"?i.setAttribute(c,p):p!=null&&(i[c]=p)}n++}for(;n<arguments.length;n++)Ms(i,arguments[n]);return i}function Ms(i,n){if(typeof n=="string")i.appendChild(document.createTextNode(n));else if(n!=null)if(n.nodeType!=null)i.appendChild(n);else if(Array.isArray(n))for(var l=0;l<n.length;l++)Ms(i,n[l]);else throw new RangeError("Unsupported child node: "+n)}const q=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class X{constructor(n,l,c=0,p=n.length,y,T){this.test=T,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=n.iterRange(c,p),this.bufferStart=c,this.normalize=y?L=>y(q(L)):q,this.query=this.normalize(l)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,I.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let n=this.peek();if(n<0)return this.done=!0,this;let l=(0,I.bg)(n),c=this.bufferStart+this.bufferPos;this.bufferPos+=(0,I.nZ)(n);let p=this.normalize(l);for(let y=0,T=c;;y++){let L=p.charCodeAt(y),V=this.match(L,T);if(y==p.length-1){if(V)return this.value=V,this;break}T==c&&y<l.length&&l.charCodeAt(y)==L&&T++}}}match(n,l){let c=null;for(let p=0;p<this.matches.length;p+=2){let y=this.matches[p],T=!1;this.query.charCodeAt(y)==n&&(y==this.query.length-1?c={from:this.matches[p+1],to:l+1}:(this.matches[p]++,T=!0)),T||(this.matches.splice(p,2),p-=2)}return this.query.charCodeAt(0)==n&&(this.query.length==1?c={from:l,to:l+1}:this.matches.push(1,l)),c&&this.test&&!this.test(c.from,c.to,this.buffer,this.bufferPos)&&(c=null),c}}typeof Symbol!="undefined"&&(X.prototype[Symbol.iterator]=function(){return this});const ae={from:-1,to:-1,match:/.*/.exec("")},be="gm"+(/x/.unicode==null?"":"u");class Pe{constructor(n,l,c,p=0,y=n.length){if(this.text=n,this.to=y,this.curLine="",this.done=!1,this.value=ae,/\\[sWDnr]|\n|\r|\[\^/.test(l))return new Nt(n,l,c,p,y);this.re=new RegExp(l,be+(c!=null&&c.ignoreCase?"i":"")),this.test=c==null?void 0:c.test,this.iter=n.iter();let T=n.lineAt(p);this.curLineStart=T.from,this.matchPos=qt(n,p),this.getLine(this.curLineStart)}getLine(n){this.iter.next(n),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let n=this.matchPos-this.curLineStart;;){this.re.lastIndex=n;let l=this.matchPos<=this.to&&this.re.exec(this.curLine);if(l){let c=this.curLineStart+l.index,p=c+l[0].length;if(this.matchPos=qt(this.text,p+(c==p?1:0)),c==this.curLineStart+this.curLine.length&&this.nextLine(),(c<p||c>this.value.to)&&(!this.test||this.test(c,p,l)))return this.value={from:c,to:p,match:l},this;n=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),n=0;else return this.done=!0,this}}}const ct=new WeakMap;class it{constructor(n,l){this.from=n,this.text=l}get to(){return this.from+this.text.length}static get(n,l,c){let p=ct.get(n);if(!p||p.from>=c||p.to<=l){let L=new it(l,n.sliceString(l,c));return ct.set(n,L),L}if(p.from==l&&p.to==c)return p;let{text:y,from:T}=p;return T>l&&(y=n.sliceString(l,T)+y,T=l),p.to<c&&(y+=n.sliceString(p.to,c)),ct.set(n,new it(T,y)),new it(l,y.slice(l-T,c-T))}}class Nt{constructor(n,l,c,p,y){this.text=n,this.to=y,this.done=!1,this.value=ae,this.matchPos=qt(n,p),this.re=new RegExp(l,be+(c!=null&&c.ignoreCase?"i":"")),this.test=c==null?void 0:c.test,this.flat=it.get(n,p,this.chunkEnd(p+5e3))}chunkEnd(n){return n>=this.to?this.to:this.text.lineAt(n).to}next(){for(;;){let n=this.re.lastIndex=this.matchPos-this.flat.from,l=this.re.exec(this.flat.text);if(l&&!l[0]&&l.index==n&&(this.re.lastIndex=n+1,l=this.re.exec(this.flat.text)),l){let c=this.flat.from+l.index,p=c+l[0].length;if((this.flat.to>=this.to||l.index+l[0].length<=this.flat.text.length-10)&&(!this.test||this.test(c,p,l)))return this.value={from:c,to:p,match:l},this.matchPos=qt(this.text,p+(c==p?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=it.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(Pe.prototype[Symbol.iterator]=Nt.prototype[Symbol.iterator]=function(){return this});function On(i){try{return new RegExp(i,be),!0}catch{return!1}}function qt(i,n){if(n>=i.length)return n;let l=i.lineAt(n),c;for(;n<l.to&&(c=l.text.charCodeAt(n-l.from))>=56320&&c<57344;)n++;return n}function Dt(i){let n=Cn("input",{class:"cm-textfield",name:"line"}),l=Cn("form",{class:"cm-gotoLine",onkeydown:p=>{p.keyCode==27?(p.preventDefault(),i.dispatch({effects:xt.of(!1)}),i.focus()):p.keyCode==13&&(p.preventDefault(),c())},onsubmit:p=>{p.preventDefault(),c()}},Cn("label",i.state.phrase("Go to line"),": ",n)," ",Cn("button",{class:"cm-button",type:"submit"},i.state.phrase("go")));function c(){let p=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!p)return;let{state:y}=i,T=y.doc.lineAt(y.selection.main.head),[,L,V,re,fe]=p,Fe=re?+re.slice(1):0,Et=V?+V:T.number;if(V&&fe){let ni=Et/100;L&&(ni=ni*(L=="-"?-1:1)+T.number/y.doc.lines),Et=Math.round(y.doc.lines*ni)}else V&&L&&(Et=Et*(L=="-"?-1:1)+T.number);let nn=y.doc.line(Math.max(1,Math.min(y.doc.lines,Et))),sr=I.jT.cursor(nn.from+Math.max(0,Math.min(Fe,nn.length)));i.dispatch({effects:[xt.of(!1),se.tk.scrollIntoView(sr.from,{y:"center"})],selection:sr}),i.focus()}return{dom:l}}const xt=I.Py.define(),At=I.QQ.define({create(){return!0},update(i,n){for(let l of n.effects)l.is(xt)&&(i=l.value);return i},provide:i=>se.mH.from(i,n=>n?Dt:null)}),ln=i=>{let n=(0,se.Sd)(i,Dt);if(!n){let l=[xt.of(!0)];i.state.field(At,!1)==null&&l.push(I.Py.appendConfig.of([At,Nn])),i.dispatch({effects:l}),n=(0,se.Sd)(i,Dt)}return n&&n.dom.querySelector("input").focus(),!0},Nn=se.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Fn={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},rr=I.r$.define({combine(i){return(0,I.BO)(i,Fn,{highlightWordAroundCursor:(n,l)=>n||l,minSelectionLength:Math.min,maxMatches:Math.min})}});function Or(i){let n=[Li,fn];return i&&n.push(rr.of(i)),n}const Rr=se.p.mark({class:"cm-selectionMatch"}),ir=se.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function hr(i,n,l,c){return(l==0||i(n.sliceDoc(l-1,l))!=I.D0.Word)&&(c==n.doc.length||i(n.sliceDoc(c,c+1))!=I.D0.Word)}function ii(i,n,l,c){return i(n.sliceDoc(l,l+1))==I.D0.Word&&i(n.sliceDoc(c-1,c))==I.D0.Word}const fn=se.lg.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let n=i.state.facet(rr),{state:l}=i,c=l.selection;if(c.ranges.length>1)return se.p.none;let p=c.main,y,T=null;if(p.empty){if(!n.highlightWordAroundCursor)return se.p.none;let V=l.wordAt(p.head);if(!V)return se.p.none;T=l.charCategorizer(p.head),y=l.sliceDoc(V.from,V.to)}else{let V=p.to-p.from;if(V<n.minSelectionLength||V>200)return se.p.none;if(n.wholeWords){if(y=l.sliceDoc(p.from,p.to),T=l.charCategorizer(p.head),!(hr(T,l,p.from,p.to)&&ii(T,l,p.from,p.to)))return se.p.none}else if(y=l.sliceDoc(p.from,p.to).trim(),!y)return se.p.none}let L=[];for(let V of i.visibleRanges){let re=new X(l.doc,y,V.from,V.to);for(;!re.next().done;){let{from:fe,to:Fe}=re.value;if((!T||hr(T,l,fe,Fe))&&(p.empty&&fe<=p.from&&Fe>=p.to?L.push(ir.range(fe,Fe)):(fe>=p.to||Fe<=p.from)&&L.push(Rr.range(fe,Fe)),L.length>n.maxMatches))return se.p.none}}return se.p.set(L)}},{decorations:i=>i.decorations}),Li=se.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Ar=({state:i,dispatch:n})=>{let{selection:l}=i,c=I.jT.create(l.ranges.map(p=>i.wordAt(p.head)||I.jT.cursor(p.head)),l.mainIndex);return c.eq(l)?!1:(n(i.update({selection:c})),!0)};function Wr(i,n){let{main:l,ranges:c}=i.selection,p=i.wordAt(l.head),y=p&&p.from==l.from&&p.to==l.to;for(let T=!1,L=new X(i.doc,n,c[c.length-1].to);;)if(L.next(),L.done){if(T)return null;L=new X(i.doc,n,0,Math.max(0,c[c.length-1].from-1)),T=!0}else{if(T&&c.some(V=>V.from==L.value.from))continue;if(y){let V=i.wordAt(L.value.from);if(!V||V.from!=L.value.from||V.to!=L.value.to)continue}return L.value}}const Xr=({state:i,dispatch:n})=>{let{ranges:l}=i.selection;if(l.some(y=>y.from===y.to))return Ar({state:i,dispatch:n});let c=i.sliceDoc(l[0].from,l[0].to);if(i.selection.ranges.some(y=>i.sliceDoc(y.from,y.to)!=c))return!1;let p=Wr(i,c);return p?(n(i.update({selection:i.selection.addRange(I.jT.range(p.from,p.to),!1),effects:se.tk.scrollIntoView(p.to)})),!0):!1},Kn=I.r$.define({combine(i){return(0,I.BO)(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:n=>new is(n),scrollToMatch:n=>se.tk.scrollIntoView(n)})}});function Ni(i){return i?[Kn.of(i),An]:An}class pn{constructor(n){this.search=n.search,this.caseSensitive=!!n.caseSensitive,this.literal=!!n.literal,this.regexp=!!n.regexp,this.replace=n.replace||"",this.valid=!!this.search&&(!this.regexp||On(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!n.wholeWord}unquote(n){return this.literal?n:n.replace(/\\([nrt\\])/g,(l,c)=>c=="n"?`
`:c=="r"?"\r":c=="t"?"	":"\\")}eq(n){return this.search==n.search&&this.replace==n.replace&&this.caseSensitive==n.caseSensitive&&this.regexp==n.regexp&&this.wholeWord==n.wholeWord}create(){return this.regexp?new ur(this):new Zi(this)}getCursor(n,l=0,c){let p=n.doc?n:I.yy.create({doc:n});return c==null&&(c=p.doc.length),this.regexp?wn(this,p,l,c):jn(this,p,l,c)}}class Ut{constructor(n){this.spec=n}}function jn(i,n,l,c){return new X(n.doc,i.unquoted,l,c,i.caseSensitive?void 0:p=>p.toLowerCase(),i.wholeWord?qn(n.doc,n.charCategorizer(n.selection.main.head)):void 0)}function qn(i,n){return(l,c,p,y)=>((y>l||y+p.length<c)&&(y=Math.max(0,l-2),p=i.sliceString(y,Math.min(i.length,c+2))),(n($n(p,l-y))!=I.D0.Word||n(hi(p,l-y))!=I.D0.Word)&&(n(hi(p,c-y))!=I.D0.Word||n($n(p,c-y))!=I.D0.Word))}class Zi extends Ut{constructor(n){super(n)}nextMatch(n,l,c){let p=jn(this.spec,n,c,n.doc.length).nextOverlapping();return p.done&&(p=jn(this.spec,n,0,l).nextOverlapping()),p.done?null:p.value}prevMatchInRange(n,l,c){for(let p=c;;){let y=Math.max(l,p-1e4-this.spec.unquoted.length),T=jn(this.spec,n,y,p),L=null;for(;!T.nextOverlapping().done;)L=T.value;if(L)return L;if(y==l)return null;p-=1e4}}prevMatch(n,l,c){return this.prevMatchInRange(n,0,l)||this.prevMatchInRange(n,c,n.doc.length)}getReplacement(n){return this.spec.unquote(this.spec.replace)}matchAll(n,l){let c=jn(this.spec,n,0,n.doc.length),p=[];for(;!c.next().done;){if(p.length>=l)return null;p.push(c.value)}return p}highlight(n,l,c,p){let y=jn(this.spec,n,Math.max(0,l-this.spec.unquoted.length),Math.min(c+this.spec.unquoted.length,n.doc.length));for(;!y.next().done;)p(y.value.from,y.value.to)}}function wn(i,n,l,c){return new Pe(n.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?Ui(n.charCategorizer(n.selection.main.head)):void 0},l,c)}function $n(i,n){return i.slice((0,I.cp)(i,n,!1),n)}function hi(i,n){return i.slice(n,(0,I.cp)(i,n))}function Ui(i){return(n,l,c)=>!c[0].length||(i($n(c.input,c.index))!=I.D0.Word||i(hi(c.input,c.index))!=I.D0.Word)&&(i(hi(c.input,c.index+c[0].length))!=I.D0.Word||i($n(c.input,c.index+c[0].length))!=I.D0.Word)}class ur extends Ut{nextMatch(n,l,c){let p=wn(this.spec,n,c,n.doc.length).next();return p.done&&(p=wn(this.spec,n,0,l).next()),p.done?null:p.value}prevMatchInRange(n,l,c){for(let p=1;;p++){let y=Math.max(l,c-p*1e4),T=wn(this.spec,n,y,c),L=null;for(;!T.next().done;)L=T.value;if(L&&(y==l||L.from>y+10))return L;if(y==l)return null}}prevMatch(n,l,c){return this.prevMatchInRange(n,0,l)||this.prevMatchInRange(n,c,n.doc.length)}getReplacement(n){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(l,c)=>c=="$"?"$":c=="&"?n.match[0]:c!="0"&&+c<n.match.length?n.match[c]:l))}matchAll(n,l){let c=wn(this.spec,n,0,n.doc.length),p=[];for(;!c.next().done;){if(p.length>=l)return null;p.push(c.value)}return p}highlight(n,l,c,p){let y=wn(this.spec,n,Math.max(0,l-250),Math.min(c+250,n.doc.length));for(;!y.next().done;)p(y.value.from,y.value.to)}}const br=I.Py.define(),Hr=I.Py.define(),Ir=I.QQ.define({create(i){return new si(li(i).create(),null)},update(i,n){for(let l of n.effects)l.is(br)?i=new si(l.value.create(),i.panel):l.is(Hr)&&(i=new si(i.query,l.value?wi:null));return i},provide:i=>se.mH.from(i,n=>n.panel)});function Ps(i){let n=i.field(Ir,!1);return n?n.query.spec:li(i)}function zr(i){var n;return((n=i.field(Ir,!1))===null||n===void 0?void 0:n.panel)!=null}class si{constructor(n,l){this.query=n,this.panel=l}}const Bi=se.p.mark({class:"cm-searchMatch"}),ui=se.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Yr=se.lg.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(Ir))}update(i){let n=i.state.field(Ir);(n!=i.startState.field(Ir)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(n))}highlight({query:i,panel:n}){if(!n||!i.spec.valid)return se.p.none;let{view:l}=this,c=new I.f_;for(let p=0,y=l.visibleRanges,T=y.length;p<T;p++){let{from:L,to:V}=y[p];for(;p<T-1&&V>y[p+1].from-2*250;)V=y[++p].to;i.highlight(l.state,L,V,(re,fe)=>{let Fe=l.state.selection.ranges.some(Et=>Et.from==re&&Et.to==fe);c.add(re,fe,Fe?ui:Bi)})}return c.finish()}},{decorations:i=>i.decorations});function Qr(i){return n=>{let l=n.state.field(Ir,!1);return l&&l.query.spec.valid?i(n,l):ei(n)}}const qr=Qr((i,{query:n})=>{let{to:l}=i.state.selection.main,c=n.nextMatch(i.state,l,l);if(!c)return!1;let p=I.jT.single(c.from,c.to),y=i.state.facet(Kn);return i.dispatch({selection:p,effects:[Wn(i,c),y.scrollToMatch(p.main,i)],userEvent:"select.search"}),Mr(i),!0}),Tr=Qr((i,{query:n})=>{let{state:l}=i,{from:c}=l.selection.main,p=n.prevMatch(l,c,c);if(!p)return!1;let y=I.jT.single(p.from,p.to),T=i.state.facet(Kn);return i.dispatch({selection:y,effects:[Wn(i,p),T.scrollToMatch(y.main,i)],userEvent:"select.search"}),Mr(i),!0}),oi=Qr((i,{query:n})=>{let l=n.matchAll(i.state,1e3);return!l||!l.length?!1:(i.dispatch({selection:I.jT.create(l.map(c=>I.jT.range(c.from,c.to))),userEvent:"select.search.matches"}),!0)}),di=({state:i,dispatch:n})=>{let l=i.selection;if(l.ranges.length>1||l.main.empty)return!1;let{from:c,to:p}=l.main,y=[],T=0;for(let L=new X(i.doc,i.sliceDoc(c,p));!L.next().done;){if(y.length>1e3)return!1;L.value.from==c&&(T=y.length),y.push(I.jT.range(L.value.from,L.value.to))}return n(i.update({selection:I.jT.create(y,T),userEvent:"select.search.matches"})),!0},pi=Qr((i,{query:n})=>{let{state:l}=i,{from:c,to:p}=l.selection.main;if(l.readOnly)return!1;let y=n.nextMatch(l,c,c);if(!y)return!1;let T=[],L,V,re=[];if(y.from==c&&y.to==p&&(V=l.toText(n.getReplacement(y)),T.push({from:y.from,to:y.to,insert:V}),y=n.nextMatch(l,y.from,y.to),re.push(se.tk.announce.of(l.phrase("replaced match on line $",l.doc.lineAt(c).number)+"."))),y){let fe=T.length==0||T[0].from>=y.to?0:y.to-y.from-V.length;L=I.jT.single(y.from-fe,y.to-fe),re.push(Wn(i,y)),re.push(l.facet(Kn).scrollToMatch(L.main,i))}return i.dispatch({changes:T,selection:L,effects:re,userEvent:"input.replace"}),!0}),_r=Qr((i,{query:n})=>{if(i.state.readOnly)return!1;let l=n.matchAll(i.state,1e9).map(p=>{let{from:y,to:T}=p;return{from:y,to:T,insert:n.getReplacement(p)}});if(!l.length)return!1;let c=i.state.phrase("replaced $ matches",l.length)+".";return i.dispatch({changes:l,effects:se.tk.announce.of(c),userEvent:"input.replace.all"}),!0});function wi(i){return i.state.facet(Kn).createPanel(i)}function li(i,n){var l,c,p,y,T;let L=i.selection.main,V=L.empty||L.to>L.from+100?"":i.sliceDoc(L.from,L.to);if(n&&!V)return n;let re=i.facet(Kn);return new pn({search:((l=n==null?void 0:n.literal)!==null&&l!==void 0?l:re.literal)?V:V.replace(/\n/g,"\\n"),caseSensitive:(c=n==null?void 0:n.caseSensitive)!==null&&c!==void 0?c:re.caseSensitive,literal:(p=n==null?void 0:n.literal)!==null&&p!==void 0?p:re.literal,regexp:(y=n==null?void 0:n.regexp)!==null&&y!==void 0?y:re.regexp,wholeWord:(T=n==null?void 0:n.wholeWord)!==null&&T!==void 0?T:re.wholeWord})}function vn(i){let n=(0,se.Sd)(i,wi);return n&&n.dom.querySelector("[main-field]")}function Mr(i){let n=vn(i);n&&n==i.root.activeElement&&n.select()}const ei=i=>{let n=i.state.field(Ir,!1);if(n&&n.panel){let l=vn(i);if(l&&l!=i.root.activeElement){let c=li(i.state,n.query.spec);c.valid&&i.dispatch({effects:br.of(c)}),l.focus(),l.select()}}else i.dispatch({effects:[Hr.of(!0),n?br.of(li(i.state,n.query.spec)):I.Py.appendConfig.of(An)]});return!0},Er=i=>{let n=i.state.field(Ir,!1);if(!n||!n.panel)return!1;let l=(0,se.Sd)(i,wi);return l&&l.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:Hr.of(!1)}),!0},Fi=[{key:"Mod-f",run:ei,scope:"editor search-panel"},{key:"F3",run:qr,shift:Tr,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:qr,shift:Tr,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Er,scope:"editor search-panel"},{key:"Mod-Shift-l",run:di},{key:"Alt-g",run:ln},{key:"Mod-d",run:Xr,preventDefault:!0}];class is{constructor(n){this.view=n;let l=this.query=n.state.field(Ir).query.spec;this.commit=this.commit.bind(this),this.searchField=Cn("input",{value:l.search,placeholder:xr(n,"Find"),"aria-label":xr(n,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Cn("input",{value:l.replace,placeholder:xr(n,"Replace"),"aria-label":xr(n,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Cn("input",{type:"checkbox",name:"case",form:"",checked:l.caseSensitive,onchange:this.commit}),this.reField=Cn("input",{type:"checkbox",name:"re",form:"",checked:l.regexp,onchange:this.commit}),this.wordField=Cn("input",{type:"checkbox",name:"word",form:"",checked:l.wholeWord,onchange:this.commit});function c(p,y,T){return Cn("button",{class:"cm-button",name:p,onclick:y,type:"button"},T)}this.dom=Cn("div",{onkeydown:p=>this.keydown(p),class:"cm-search"},[this.searchField,c("next",()=>qr(n),[xr(n,"next")]),c("prev",()=>Tr(n),[xr(n,"previous")]),c("select",()=>oi(n),[xr(n,"all")]),Cn("label",null,[this.caseField,xr(n,"match case")]),Cn("label",null,[this.reField,xr(n,"regexp")]),Cn("label",null,[this.wordField,xr(n,"by word")]),...n.state.readOnly?[]:[Cn("br"),this.replaceField,c("replace",()=>pi(n),[xr(n,"replace")]),c("replaceAll",()=>_r(n),[xr(n,"replace all")])],Cn("button",{name:"close",onclick:()=>Er(n),"aria-label":xr(n,"close"),type:"button"},["\xD7"])])}commit(){let n=new pn({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});n.eq(this.query)||(this.query=n,this.view.dispatch({effects:br.of(n)}))}keydown(n){(0,se.$1)(this.view,n,"search-panel")?n.preventDefault():n.keyCode==13&&n.target==this.searchField?(n.preventDefault(),(n.shiftKey?Tr:qr)(this.view)):n.keyCode==13&&n.target==this.replaceField&&(n.preventDefault(),pi(this.view))}update(n){for(let l of n.transactions)for(let c of l.effects)c.is(br)&&!c.value.eq(this.query)&&this.setQuery(c.value)}setQuery(n){this.query=n,this.searchField.value=n.search,this.replaceField.value=n.replace,this.caseField.checked=n.caseSensitive,this.reField.checked=n.regexp,this.wordField.checked=n.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Kn).top}}function xr(i,n){return i.state.phrase(n)}const mi=30,Zr=/[\s\.,:;?!]/;function Wn(i,{from:n,to:l}){let c=i.state.doc.lineAt(n),p=i.state.doc.lineAt(l).to,y=Math.max(c.from,n-mi),T=Math.min(p,l+mi),L=i.state.sliceDoc(y,T);if(y!=c.from){for(let V=0;V<mi;V++)if(!Zr.test(L[V+1])&&Zr.test(L[V])){L=L.slice(V);break}}if(T!=p){for(let V=L.length-1;V>L.length-mi;V--)if(!Zr.test(L[V-1])&&Zr.test(L[V])){L=L.slice(0,V);break}}return se.tk.announce.of(`${i.state.phrase("current match")}. ${L} ${i.state.phrase("on line")} ${c.number}.`)}const mt=se.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),An=[Ir,I.Wl.lowest(Yr),mt];class Ur{constructor(n,l,c){this.state=n,this.pos=l,this.explicit=c,this.abortListeners=[]}tokenBefore(n){let l=(0,Ne.qz)(this.state).resolveInner(this.pos,-1);for(;l&&n.indexOf(l.name)<0;)l=l.parent;return l?{from:l.from,to:this.pos,text:this.state.sliceDoc(l.from,this.pos),type:l.type}:null}matchBefore(n){let l=this.state.doc.lineAt(this.pos),c=Math.max(l.from,this.pos-250),p=l.text.slice(c-l.from,this.pos-l.from),y=p.search(ki(n,!1));return y<0?null:{from:c+y,to:this.pos,text:p.slice(y)}}get aborted(){return this.abortListeners==null}addEventListener(n,l){n=="abort"&&this.abortListeners&&this.abortListeners.push(l)}}function Ei(i){let n=Object.keys(i).join(""),l=/\w/.test(n);return l&&(n=n.replace(/\w/g,"")),`[${l?"\\w":""}${n.replace(/[^\w\s]/g,"\\$&")}]`}function Ds(i){let n=Object.create(null),l=Object.create(null);for(let{label:p}of i){n[p[0]]=!0;for(let y=1;y<p.length;y++)l[p[y]]=!0}let c=Ei(n)+Ei(l)+"*$";return[new RegExp("^"+c),new RegExp(c)]}function Xs(i){let n=i.map(p=>typeof p=="string"?{label:p}:p),[l,c]=n.every(p=>/^\w+$/.test(p.label))?[/\w*$/,/\w+$/]:Ds(n);return p=>{let y=p.matchBefore(c);return y||p.explicit?{from:y?y.from:p.pos,options:n,validFor:l}:null}}function bn(i,n){return l=>{for(let c=syntaxTree(l.state).resolveInner(l.pos,-1);c;c=c.parent){if(i.indexOf(c.name)>-1)return n(l);if(c.type.isTop)break}return null}}function Ys(i,n){return l=>{for(let c=syntaxTree(l.state).resolveInner(l.pos,-1);c;c=c.parent){if(i.indexOf(c.name)>-1)return null;if(c.type.isTop)break}return n(l)}}class gs{constructor(n,l,c,p){this.completion=n,this.source=l,this.match=c,this.score=p}}function Kr(i){return i.selection.main.from}function ki(i,n){var l;let{source:c}=i,p=n&&c[0]!="^",y=c[c.length-1]!="$";return!p&&!y?i:new RegExp(`${p?"^":""}(?:${c})${y?"$":""}`,(l=i.flags)!==null&&l!==void 0?l:i.ignoreCase?"i":"")}const ys=I.q6.define();function Rs(i,n,l,c){let{main:p}=i.selection,y=l-p.from,T=c-p.from;return Object.assign(Object.assign({},i.changeByRange(L=>L!=p&&l!=c&&i.sliceDoc(L.from+y,L.from+T)!=i.sliceDoc(l,c)?{range:L}:{changes:{from:L.from+y,to:c==p.from?L.to:L.from+T,insert:n},range:I.jT.cursor(L.from+y+n.length)})),{userEvent:"input.complete"})}const Ki=new WeakMap;function Ci(i){if(!Array.isArray(i))return i;let n=Ki.get(i);return n||Ki.set(i,n=Xs(i)),n}const Rt=I.Py.define(),qe=I.Py.define();class nt{constructor(n){this.pattern=n,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let l=0;l<n.length;){let c=(0,I.gm)(n,l),p=(0,I.nZ)(c);this.chars.push(c);let y=n.slice(l,l+p),T=y.toUpperCase();this.folded.push((0,I.gm)(T==y?y.toLowerCase():T,0)),l+=p}this.astral=n.length!=this.chars.length}ret(n,l){return this.score=n,this.matched=l,!0}match(n){if(this.pattern.length==0)return this.ret(-100,[]);if(n.length<this.pattern.length)return!1;let{chars:l,folded:c,any:p,precise:y,byWord:T}=this;if(l.length==1){let mr=(0,I.gm)(n,0),Yi=(0,I.nZ)(mr),vi=Yi==n.length?0:-100;if(mr!=l[0])if(mr==c[0])vi+=-200;else return!1;return this.ret(vi,[0,Yi])}let L=n.indexOf(this.pattern);if(L==0)return this.ret(n.length==this.pattern.length?0:-100,[0,this.pattern.length]);let V=l.length,re=0;if(L<0){for(let mr=0,Yi=Math.min(n.length,200);mr<Yi&&re<V;){let vi=(0,I.gm)(n,mr);(vi==l[re]||vi==c[re])&&(p[re++]=mr),mr+=(0,I.nZ)(vi)}if(re<V)return!1}let fe=0,Fe=0,Et=!1,nn=0,sr=-1,ni=-1,vo=/[a-z]/.test(n),Vs=!0;for(let mr=0,Yi=Math.min(n.length,200),vi=0;mr<Yi&&Fe<V;){let Fr=(0,I.gm)(n,mr);L<0&&(fe<V&&Fr==l[fe]&&(y[fe++]=mr),nn<V&&(Fr==l[nn]||Fr==c[nn]?(nn==0&&(sr=mr),ni=mr+1,nn++):nn=0));let ds,ps=Fr<255?Fr>=48&&Fr<=57||Fr>=97&&Fr<=122?2:Fr>=65&&Fr<=90?1:0:(ds=(0,I.bg)(Fr))!=ds.toLowerCase()?1:ds!=ds.toUpperCase()?2:0;(!mr||ps==1&&vo||vi==0&&ps!=0)&&(l[Fe]==Fr||c[Fe]==Fr&&(Et=!0)?T[Fe++]=mr:T.length&&(Vs=!1)),vi=ps,mr+=(0,I.nZ)(Fr)}return Fe==V&&T[0]==0&&Vs?this.result(-100+(Et?-200:0),T,n):nn==V&&sr==0?this.ret(-200-n.length+(ni==n.length?0:-100),[0,ni]):L>-1?this.ret(-700-n.length,[L,L+this.pattern.length]):nn==V?this.ret(-200+-700-n.length,[sr,ni]):Fe==V?this.result(-100+(Et?-200:0)+-700+(Vs?0:-1100),T,n):l.length==2?!1:this.result((p[0]?-700:0)+-200+-1100,p,n)}result(n,l,c){let p=[],y=0;for(let T of l){let L=T+(this.astral?(0,I.nZ)((0,I.gm)(c,T)):1);y&&p[y-1]==T?p[y-1]=L:(p[y++]=T,p[y++]=L)}return this.ret(n-c.length,p)}}const ht=I.r$.define({combine(i){return(0,I.BO)(i,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:_t,compareCompletions:(n,l)=>n.label.localeCompare(l.label),interactionDelay:75},{defaultKeymap:(n,l)=>n&&l,closeOnBlur:(n,l)=>n&&l,icons:(n,l)=>n&&l,tooltipClass:(n,l)=>c=>jt(n(c),l(c)),optionClass:(n,l)=>c=>jt(n(c),l(c)),addToOptions:(n,l)=>n.concat(l)})}});function jt(i,n){return i?n?i+" "+n:i:n}function _t(i,n,l,c,p){let y=i.textDirection==se.Nm.RTL,T=y,L=!1,V="top",re,fe,Fe=n.left-p.left,Et=p.right-n.right,nn=c.right-c.left,sr=c.bottom-c.top;if(T&&Fe<Math.min(nn,Et)?T=!1:!T&&Et<Math.min(nn,Fe)&&(T=!0),nn<=(T?Fe:Et))re=Math.max(p.top,Math.min(l.top,p.bottom-sr))-n.top,fe=Math.min(400,T?Fe:Et);else{L=!0,fe=Math.min(400,(y?n.right:p.right-n.left)-30);let ni=p.bottom-n.bottom;ni>=sr||ni>n.top?re=l.bottom-n.top:(V="bottom",re=n.bottom-l.top)}return{style:`${V}: ${re}px; max-width: ${fe}px`,class:"cm-completionInfo-"+(L?y?"left-narrow":"right-narrow":T?"left":"right")}}function Tn(i){let n=i.addToOptions.slice();return i.icons&&n.push({render(l){let c=document.createElement("div");return c.classList.add("cm-completionIcon"),l.type&&c.classList.add(...l.type.split(/\s+/g).map(p=>"cm-completionIcon-"+p)),c.setAttribute("aria-hidden","true"),c},position:20}),n.push({render(l,c,p){let y=document.createElement("span");y.className="cm-completionLabel";let T=l.displayLabel||l.label,L=0;for(let V=0;V<p.length;){let re=p[V++],fe=p[V++];re>L&&y.appendChild(document.createTextNode(T.slice(L,re)));let Fe=y.appendChild(document.createElement("span"));Fe.appendChild(document.createTextNode(T.slice(re,fe))),Fe.className="cm-completionMatchedText",L=fe}return L<T.length&&y.appendChild(document.createTextNode(T.slice(L))),y},position:50},{render(l){if(!l.detail)return null;let c=document.createElement("span");return c.className="cm-completionDetail",c.textContent=l.detail,c},position:80}),n.sort((l,c)=>l.position-c.position).map(l=>l.render)}function Mn(i,n,l){if(i<=l)return{from:0,to:i};if(n<0&&(n=0),n<=i>>1){let p=Math.floor(n/l);return{from:p*l,to:(p+1)*l}}let c=Math.floor((i-n)/l);return{from:i-(c+1)*l,to:i-c*l}}class lr{constructor(n,l,c){this.view=n,this.stateField=l,this.applyCompletion=c,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:V=>this.placeInfo(V),key:this},this.space=null,this.currentClass="";let p=n.state.field(l),{options:y,selected:T}=p.open,L=n.state.facet(ht);this.optionContent=Tn(L),this.optionClass=L.optionClass,this.tooltipClass=L.tooltipClass,this.range=Mn(y.length,T,L.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(n.state),this.dom.addEventListener("mousedown",V=>{for(let re=V.target,fe;re&&re!=this.dom;re=re.parentNode)if(re.nodeName=="LI"&&(fe=/-(\d+)$/.exec(re.id))&&+fe[1]<y.length){this.applyCompletion(n,y[+fe[1]]),V.preventDefault();return}}),this.dom.addEventListener("focusout",V=>{let re=n.state.field(this.stateField,!1);re&&re.tooltip&&n.state.facet(ht).closeOnBlur&&V.relatedTarget!=n.contentDOM&&n.dispatch({effects:qe.of(null)})}),this.list=this.dom.appendChild(this.createListBox(y,p.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}mount(){this.updateSel()}update(n){var l,c,p;let y=n.state.field(this.stateField),T=n.startState.field(this.stateField);this.updateTooltipClass(n.state),y!=T&&(this.updateSel(),((l=y.open)===null||l===void 0?void 0:l.disabled)!=((c=T.open)===null||c===void 0?void 0:c.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((p=y.open)===null||p===void 0)&&p.disabled)))}updateTooltipClass(n){let l=this.tooltipClass(n);if(l!=this.currentClass){for(let c of this.currentClass.split(" "))c&&this.dom.classList.remove(c);for(let c of l.split(" "))c&&this.dom.classList.add(c);this.currentClass=l}}positioned(n){this.space=n,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let n=this.view.state.field(this.stateField),l=n.open;if((l.selected>-1&&l.selected<this.range.from||l.selected>=this.range.to)&&(this.range=Mn(l.options.length,l.selected,this.view.state.facet(ht).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(l.options,n.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})),this.updateSelectedOption(l.selected)){this.destroyInfo();let{completion:c}=l.options[l.selected],{info:p}=c;if(!p)return;let y=typeof p=="string"?document.createTextNode(p):p(c);if(!y)return;"then"in y?y.then(T=>{T&&this.view.state.field(this.stateField,!1)==n&&this.addInfoPane(T,c)}).catch(T=>(0,se.OO)(this.view.state,T,"completion info")):this.addInfoPane(y,c)}}addInfoPane(n,l){this.destroyInfo();let c=this.info=document.createElement("div");if(c.className="cm-tooltip cm-completionInfo",n.nodeType!=null)c.appendChild(n),this.infoDestroy=null;else{let{dom:p,destroy:y}=n;c.appendChild(p),this.infoDestroy=y||null}this.dom.appendChild(c),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(n){let l=null;for(let c=this.list.firstChild,p=this.range.from;c;c=c.nextSibling,p++)c.nodeName!="LI"||!c.id?p--:p==n?c.hasAttribute("aria-selected")||(c.setAttribute("aria-selected","true"),l=c):c.hasAttribute("aria-selected")&&c.removeAttribute("aria-selected");return l&&vs(this.list,l),l}measureInfo(){let n=this.dom.querySelector("[aria-selected]");if(!n||!this.info)return null;let l=this.dom.getBoundingClientRect(),c=this.info.getBoundingClientRect(),p=n.getBoundingClientRect(),y=this.space;if(!y){let T=this.dom.ownerDocument.defaultView||window;y={left:0,top:0,right:T.innerWidth,bottom:T.innerHeight}}return p.top>Math.min(y.bottom,l.bottom)-10||p.bottom<Math.max(y.top,l.top)+10?null:this.view.state.facet(ht).positionInfo(this.view,l,p,c,y)}placeInfo(n){this.info&&(n?(n.style&&(this.info.style.cssText=n.style),this.info.className="cm-tooltip cm-completionInfo "+(n.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(n,l,c){const p=document.createElement("ul");p.id=l,p.setAttribute("role","listbox"),p.setAttribute("aria-expanded","true"),p.setAttribute("aria-label",this.view.state.phrase("Completions"));let y=null;for(let T=c.from;T<c.to;T++){let{completion:L,match:V}=n[T],{section:re}=L;if(re){let Et=typeof re=="string"?re:re.name;if(Et!=y&&(T>c.from||c.from==0))if(y=Et,typeof re!="string"&&re.header)p.appendChild(re.header(re));else{let nn=p.appendChild(document.createElement("completion-section"));nn.textContent=Et}}const fe=p.appendChild(document.createElement("li"));fe.id=l+"-"+T,fe.setAttribute("role","option");let Fe=this.optionClass(L);Fe&&(fe.className=Fe);for(let Et of this.optionContent){let nn=Et(L,this.view.state,V);nn&&fe.appendChild(nn)}}return c.from&&p.classList.add("cm-completionListIncompleteTop"),c.to<n.length&&p.classList.add("cm-completionListIncompleteBottom"),p}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function ss(i,n){return l=>new lr(l,i,n)}function vs(i,n){let l=i.getBoundingClientRect(),c=n.getBoundingClientRect();c.top<l.top?i.scrollTop-=l.top-c.top:c.bottom>l.bottom&&(i.scrollTop+=c.bottom-l.bottom)}function Is(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function So(i,n){let l=[],c=null,p=V=>{l.push(V);let{section:re}=V.completion;if(re){c||(c=[]);let fe=typeof re=="string"?re:re.name;c.some(Fe=>Fe.name==fe)||c.push(typeof re=="string"?{name:fe}:re)}};for(let V of i)if(V.hasResult()){let re=V.result.getMatch;if(V.result.filter===!1)for(let fe of V.result.options)p(new gs(fe,V.source,re?re(fe):[],1e9-l.length));else{let fe=new nt(n.sliceDoc(V.from,V.to));for(let Fe of V.result.options)if(fe.match(Fe.label)){let Et=Fe.displayLabel?re?re(Fe,fe.matched):[]:fe.matched;p(new gs(Fe,V.source,Et,fe.score+(Fe.boost||0)))}}}if(c){let V=Object.create(null),re=0,fe=(Fe,Et)=>{var nn,sr;return((nn=Fe.rank)!==null&&nn!==void 0?nn:1e9)-((sr=Et.rank)!==null&&sr!==void 0?sr:1e9)||(Fe.name<Et.name?-1:1)};for(let Fe of c.sort(fe))re-=1e5,V[Fe.name]=re;for(let Fe of l){let{section:Et}=Fe.completion;Et&&(Fe.score+=V[typeof Et=="string"?Et:Et.name])}}let y=[],T=null,L=n.facet(ht).compareCompletions;for(let V of l.sort((re,fe)=>fe.score-re.score||L(re.completion,fe.completion))){let re=V.completion;!T||T.label!=re.label||T.detail!=re.detail||T.type!=null&&re.type!=null&&T.type!=re.type||T.apply!=re.apply||T.boost!=re.boost?y.push(V):Is(V.completion)>Is(T)&&(y[y.length-1]=V),T=V.completion}return y}class os{constructor(n,l,c,p,y,T){this.options=n,this.attrs=l,this.tooltip=c,this.timestamp=p,this.selected=y,this.disabled=T}setSelected(n,l){return n==this.selected||n>=this.options.length?this:new os(this.options,Lr(l,n),this.tooltip,this.timestamp,n,this.disabled)}static build(n,l,c,p,y){let T=So(n,l);if(!T.length)return p&&n.some(V=>V.state==1)?new os(p.options,p.attrs,p.tooltip,p.timestamp,p.selected,!0):null;let L=l.facet(ht).selectOnOpen?0:-1;if(p&&p.selected!=L&&p.selected!=-1){let V=p.options[p.selected].completion;for(let re=0;re<T.length;re++)if(T[re].completion==V){L=re;break}}return new os(T,Lr(c,L),{pos:n.reduce((V,re)=>re.hasResult()?Math.min(V,re.from):V,1e8),create:ss(dr,ls),above:y.aboveCursor},p?p.timestamp:Date.now(),L,!1)}map(n){return new os(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:n.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Ji{constructor(n,l,c){this.active=n,this.id=l,this.open=c}static start(){return new Ji(Ls,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(n){let{state:l}=n,c=l.facet(ht),y=(c.override||l.languageDataAt("autocomplete",Kr(l)).map(Ci)).map(L=>(this.active.find(re=>re.source==L)||new Nr(L,this.active.some(re=>re.state!=0)?1:0)).update(n,c));y.length==this.active.length&&y.every((L,V)=>L==this.active[V])&&(y=this.active);let T=this.open;T&&n.docChanged&&(T=T.map(n.changes)),n.selection||y.some(L=>L.hasResult()&&n.changes.touchesRange(L.from,L.to))||!wo(y,this.active)?T=os.build(y,l,this.id,T,c):T&&T.disabled&&!y.some(L=>L.state==1)&&(T=null),!T&&y.every(L=>L.state!=1)&&y.some(L=>L.hasResult())&&(y=y.map(L=>L.hasResult()?new Nr(L.source,0):L));for(let L of n.effects)L.is(qs)&&(T=T&&T.setSelected(L.value,this.id));return y==this.active&&T==this.open?this:new Ji(y,this.id,T)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:ti}}function wo(i,n){if(i==n)return!0;for(let l=0,c=0;;){for(;l<i.length&&!i[l].hasResult;)l++;for(;c<n.length&&!n[c].hasResult;)c++;let p=l==i.length,y=c==n.length;if(p||y)return p==y;if(i[l++].result!=n[c++].result)return!1}}const ti={"aria-autocomplete":"list"};function Lr(i,n){let l={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return n>-1&&(l["aria-activedescendant"]=i+"-"+n),l}const Ls=[];function Ns(i){return i.isUserEvent("input.type")?"input":i.isUserEvent("delete.backward")?"delete":null}class Nr{constructor(n,l,c=-1){this.source=n,this.state=l,this.explicitPos=c}hasResult(){return!1}update(n,l){let c=Ns(n),p=this;c?p=p.handleUserEvent(n,c,l):n.docChanged?p=p.handleChange(n):n.selection&&p.state!=0&&(p=new Nr(p.source,0));for(let y of n.effects)if(y.is(Rt))p=new Nr(p.source,1,y.value?Kr(n.state):-1);else if(y.is(qe))p=new Nr(p.source,0);else if(y.is(Qs))for(let T of y.value)T.source==p.source&&(p=T);return p}handleUserEvent(n,l,c){return l=="delete"||!c.activateOnTyping?this.map(n.changes):new Nr(this.source,1)}handleChange(n){return n.changes.touchesRange(Kr(n.startState))?new Nr(this.source,0):this.map(n.changes)}map(n){return n.empty||this.explicitPos<0?this:new Nr(this.source,this.state,n.mapPos(this.explicitPos))}}class ji extends Nr{constructor(n,l,c,p,y){super(n,2,l),this.result=c,this.from=p,this.to=y}hasResult(){return!0}handleUserEvent(n,l,c){var p;let y=n.changes.mapPos(this.from),T=n.changes.mapPos(this.to,1),L=Kr(n.state);if((this.explicitPos<0?L<=y:L<this.from)||L>T||l=="delete"&&Kr(n.startState)==this.from)return new Nr(this.source,l=="input"&&c.activateOnTyping?1:0);let V=this.explicitPos<0?-1:n.changes.mapPos(this.explicitPos),re;return Eo(this.result.validFor,n.state,y,T)?new ji(this.source,V,this.result,y,T):this.result.update&&(re=this.result.update(this.result,y,T,new Ur(n.state,L,V>=0)))?new ji(this.source,V,re,re.from,(p=re.to)!==null&&p!==void 0?p:Kr(n.state)):new Nr(this.source,1,V)}handleChange(n){return n.changes.touchesRange(this.from,this.to)?new Nr(this.source,0):this.map(n.changes)}map(n){return n.empty?this:new ji(this.source,this.explicitPos<0?-1:n.mapPos(this.explicitPos),this.result,n.mapPos(this.from),n.mapPos(this.to,1))}}function Eo(i,n,l,c){if(!i)return!1;let p=n.sliceDoc(l,c);return typeof i=="function"?i(p,l,c,n):ki(i,!0).test(p)}const Qs=I.Py.define({map(i,n){return i.map(l=>l.map(n))}}),qs=I.Py.define(),dr=I.QQ.define({create(){return Ji.start()},update(i,n){return i.update(n)},provide:i=>[se.hJ.from(i,n=>n.tooltip),se.tk.contentAttributes.from(i,n=>n.attrs)]});function ls(i,n){const l=n.completion.apply||n.completion.label;let c=i.state.field(dr).active.find(p=>p.source==n.source);return c instanceof ji?(typeof l=="string"?i.dispatch(Object.assign(Object.assign({},Rs(i.state,l,c.from,c.to)),{annotations:ys.of(n.completion)})):l(i,n.completion,c.from,c.to),!0):!1}function Bs(i,n="option"){return l=>{let c=l.state.field(dr,!1);if(!c||!c.open||c.open.disabled||Date.now()-c.open.timestamp<l.state.facet(ht).interactionDelay)return!1;let p=1,y;n=="page"&&(y=(0,se.gB)(l,c.open.tooltip))&&(p=Math.max(2,Math.floor(y.dom.offsetHeight/y.dom.querySelector("li").offsetHeight)-1));let{length:T}=c.open.options,L=c.open.selected>-1?c.open.selected+p*(i?1:-1):i?0:T-1;return L<0?L=n=="page"?0:T-1:L>=T&&(L=n=="page"?T-1:0),l.dispatch({effects:qs.of(L)}),!0}}const ko=i=>{let n=i.state.field(dr,!1);return i.state.readOnly||!n||!n.open||n.open.selected<0||n.open.disabled||Date.now()-n.open.timestamp<i.state.facet(ht).interactionDelay?!1:ls(i,n.open.options[n.open.selected])},Co=i=>i.state.field(dr,!1)?(i.dispatch({effects:Rt.of(!0)}),!0):!1,Oo=i=>{let n=i.state.field(dr,!1);return!n||!n.active.some(l=>l.state!=0)?!1:(i.dispatch({effects:qe.of(null)}),!0)};class _s{constructor(n,l){this.active=n,this.context=l,this.time=Date.now(),this.updates=[],this.done=void 0}}const Fs=50,Ao=50,To=1e3,eo=se.lg.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let n of i.state.field(dr).active)n.state==1&&this.startQuery(n)}update(i){let n=i.state.field(dr);if(!i.selectionSet&&!i.docChanged&&i.startState.field(dr)==n)return;let l=i.transactions.some(c=>(c.selection||c.docChanged)&&!Ns(c));for(let c=0;c<this.running.length;c++){let p=this.running[c];if(l||p.updates.length+i.transactions.length>Ao&&Date.now()-p.time>To){for(let y of p.context.abortListeners)try{y()}catch(T){(0,se.OO)(this.view.state,T)}p.context.abortListeners=null,this.running.splice(c--,1)}else p.updates.push(...i.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=n.active.some(c=>c.state==1&&!this.running.some(p=>p.active.source==c.source))?setTimeout(()=>this.startUpdate(),Fs):-1,this.composing!=0)for(let c of i.transactions)Ns(c)=="input"?this.composing=2:this.composing==2&&c.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:i}=this.view,n=i.field(dr);for(let l of n.active)l.state==1&&!this.running.some(c=>c.active.source==l.source)&&this.startQuery(l)}startQuery(i){let{state:n}=this.view,l=Kr(n),c=new Ur(n,l,i.explicitPos==l),p=new _s(i,c);this.running.push(p),Promise.resolve(i.source(c)).then(y=>{p.context.aborted||(p.done=y||null,this.scheduleAccept())},y=>{this.view.dispatch({effects:qe.of(null)}),(0,se.OO)(this.view.state,y)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),Fs))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let n=[],l=this.view.state.facet(ht);for(let c=0;c<this.running.length;c++){let p=this.running[c];if(p.done===void 0)continue;if(this.running.splice(c--,1),p.done){let T=new ji(p.active.source,p.active.explicitPos,p.done,p.done.from,(i=p.done.to)!==null&&i!==void 0?i:Kr(p.updates.length?p.updates[0].startState:this.view.state));for(let L of p.updates)T=T.update(L,l);if(T.hasResult()){n.push(T);continue}}let y=this.view.state.field(dr).active.find(T=>T.source==p.active.source);if(y&&y.state==1)if(p.done==null){let T=new Nr(p.active.source,0);for(let L of p.updates)T=T.update(L,l);T.state!=1&&n.push(T)}else this.startQuery(y)}n.length&&this.view.dispatch({effects:Qs.of(n)})}},{eventHandlers:{blur(i){let n=this.view.state.field(dr,!1);if(n&&n.tooltip&&this.view.state.facet(ht).closeOnBlur){let l=n.open&&(0,se.gB)(this.view,n.open.tooltip);(!l||!l.dom.contains(i.relatedTarget))&&this.view.dispatch({effects:qe.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Rt.of(!1)}),20),this.composing=0}}}),lo=se.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class bs{constructor(n,l,c,p){this.field=n,this.line=l,this.from=c,this.to=p}}class to{constructor(n,l,c){this.field=n,this.from=l,this.to=c}map(n){let l=n.mapPos(this.from,-1,MapMode.TrackDel),c=n.mapPos(this.to,1,MapMode.TrackDel);return l==null||c==null?null:new to(this.field,l,c)}}class xs{constructor(n,l){this.lines=n,this.fieldPositions=l}instantiate(n,l){let c=[],p=[l],y=n.doc.lineAt(l),T=/^\s*/.exec(y.text)[0];for(let V of this.lines){if(c.length){let re=T,fe=/^\t*/.exec(V)[0].length;for(let Fe=0;Fe<fe;Fe++)re+=n.facet(indentUnit);p.push(l+re.length-fe),V=re+V.slice(fe)}c.push(V),l+=V.length+1}let L=this.fieldPositions.map(V=>new to(V.field,p[V.line]+V.from,p[V.line]+V.to));return{text:c,ranges:L}}static parse(n){let l=[],c=[],p=[],y;for(let T of n.split(/\r\n?|\n/)){for(;y=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(T);){let L=y[1]?+y[1]:null,V=y[2]||y[3]||"",re=-1;for(let fe=0;fe<l.length;fe++)(L!=null?l[fe].seq==L:V&&l[fe].name==V)&&(re=fe);if(re<0){let fe=0;for(;fe<l.length&&(L==null||l[fe].seq!=null&&l[fe].seq<L);)fe++;l.splice(fe,0,{seq:L,name:V}),re=fe;for(let Fe of p)Fe.field>=re&&Fe.field++}p.push(new bs(re,c.length,y.index,y.index+V.length)),T=T.slice(0,y.index)+V+T.slice(y.index+y[0].length)}for(let L;L=/\\([{}])/.exec(T);){T=T.slice(0,L.index)+L[1]+T.slice(L.index+L[0].length);for(let V of p)V.line==c.length&&V.from>L.index&&(V.from--,V.to--)}c.push(T)}return new xs(c,p)}}let Mo=se.p.widget({widget:new class extends se.l9{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),Po=se.p.mark({class:"cm-snippetField"});class as{constructor(n,l){this.ranges=n,this.active=l,this.deco=se.p.set(n.map(c=>(c.from==c.to?Mo:Po).range(c.from,c.to)))}map(n){let l=[];for(let c of this.ranges){let p=c.map(n);if(!p)return null;l.push(p)}return new as(l,this.active)}selectionInsideField(n){return n.ranges.every(l=>this.ranges.some(c=>c.field==this.active&&c.from<=l.from&&c.to>=l.to))}}const cs=I.Py.define({map(i,n){return i&&i.map(n)}}),Do=I.Py.define(),$i=I.QQ.define({create(){return null},update(i,n){for(let l of n.effects){if(l.is(cs))return l.value;if(l.is(Do)&&i)return new as(i.ranges,l.value)}return i&&n.docChanged&&(i=i.map(n.changes)),i&&n.selection&&!i.selectionInsideField(n.selection)&&(i=null),i},provide:i=>se.tk.decorations.from(i,n=>n?n.deco:se.p.none)});function no(i,n){return I.jT.create(i.filter(l=>l.field==n).map(l=>I.jT.range(l.from,l.to)))}function Ro(i){let n=xs.parse(i);return(l,c,p,y)=>{let{text:T,ranges:L}=n.instantiate(l.state,p),V={changes:{from:p,to:y,insert:Text.of(T)},scrollIntoView:!0,annotations:c?ys.of(c):void 0};if(L.length&&(V.selection=no(L,0)),L.length>1){let re=new as(L,0),fe=V.effects=[cs.of(re)];l.state.field($i,!1)===void 0&&fe.push(StateEffect.appendConfig.of([$i,No,Bo,lo]))}l.dispatch(l.state.update(V))}}function ao(i){return({state:n,dispatch:l})=>{let c=n.field($i,!1);if(!c||i<0&&c.active==0)return!1;let p=c.active+i,y=i>0&&!c.ranges.some(T=>T.field==p+i);return l(n.update({selection:no(c.ranges,p),effects:cs.of(y?null:new as(c.ranges,p))})),!0}}const co=({state:i,dispatch:n})=>i.field($i,!1)?(n(i.update({effects:cs.of(null)})),!0):!1,Jo=ao(1),Io=ao(-1);function fo(i){let n=i.field($i,!1);return!!(n&&n.ranges.some(l=>l.field==n.active+1))}function Go(i){let n=i.field($i,!1);return!!(n&&n.active>0)}const Lo=[{key:"Tab",run:Jo,shift:Io},{key:"Escape",run:co}],ro=I.r$.define({combine(i){return i.length?i[0]:Lo}}),No=I.Wl.highest(se.$f.compute([ro],i=>i.facet(ro)));function Xo(i,n){return Object.assign(Object.assign({},n),{apply:Ro(i)})}const Bo=se.tk.domEventHandlers({mousedown(i,n){let l=n.state.field($i,!1),c;if(!l||(c=n.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let p=l.ranges.find(y=>y.from<=c&&y.to>=c);return!p||p.field==l.active?!1:(n.dispatch({selection:no(l.ranges,p.field),effects:cs.of(l.ranges.some(y=>y.field>p.field)?new as(l.ranges,p.field):null)}),!0)}});function Fo(i){let n=i.replace(/[\\[.+*?(){|^$]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${n}]+`,"ug")}catch{return new RegExp(`[w${n}]`,"g")}}function ho(i,n){return new RegExp(n(i.source),i.unicode?"u":"")}const Ss=null;function uo(i){return Ss[i]||(Ss[i]=new WeakMap)}function jo(i,n,l,c,p){for(let y=i.iterLines(),T=0;!y.next().done;){let{value:L}=y,V;for(n.lastIndex=0;V=n.exec(L);)if(!c[V[0]]&&T+V.index!=p&&(l.push({type:"text",label:V[0]}),c[V[0]]=!0,l.length>=2e3))return;T+=L.length+1}}function po(i,n,l,c,p){let y=i.length>=1e3,T=y&&n.get(i);if(T)return T;let L=[],V=Object.create(null);if(i.children){let re=0;for(let fe of i.children){if(fe.length>=1e3)for(let Fe of po(fe,n,l,c-re,p-re))V[Fe.label]||(V[Fe.label]=!0,L.push(Fe));else jo(fe,l,L,V,p-re);re+=fe.length+1}}else jo(i,l,L,V,p);return y&&L.length<2e3&&n.set(i,L),L}const io=i=>{let n=i.state.languageDataAt("wordChars",i.pos).join(""),l=Fo(n),c=i.matchBefore(ho(l,T=>T+"$"));if(!c&&!i.explicit)return null;let p=c?c.from:i.pos,y=po(i.state.doc,uo(n),l,5e4,p);return{from:p,options:y,validFor:ho(l,T=>"^"+T)}},fs={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Oi=I.Py.define({map(i,n){let l=n.mapPos(i,-1,I.gc.TrackAfter);return l==null?void 0:l}}),mo=new class extends I.uU{};mo.startSide=1,mo.endSide=-1;const h=I.QQ.define({create(){return I.Xs.empty},update(i,n){if(n.selection){let l=n.state.doc.lineAt(n.selection.main.head).from,c=n.startState.doc.lineAt(n.startState.selection.main.head).from;l!=n.changes.mapPos(c,-1)&&(i=I.Xs.empty)}i=i.map(n.changes);for(let l of n.effects)l.is(Oi)&&(i=i.update({add:[mo.range(l.value,l.value+1)]}));return i}});function a(){return[J,h]}const d="()[]{}<>";function x(i){for(let n=0;n<d.length;n+=2)if(d.charCodeAt(n)==i)return d.charAt(n+1);return(0,I.bg)(i<128?i:i+1)}function E(i,n){return i.languageDataAt("closeBrackets",n)[0]||fs}const F=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),J=se.tk.inputHandler.of((i,n,l,c)=>{if((F?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let p=i.state.selection.main;if(c.length>2||c.length==2&&(0,I.nZ)((0,I.gm)(c,0))==1||n!=p.from||l!=p.to)return!1;let y=ie(i.state,c);return y?(i.dispatch(y),!0):!1}),de=[{key:"Backspace",run:({state:i,dispatch:n})=>{if(i.readOnly)return!1;let c=E(i,i.selection.main.head).brackets||fs.brackets,p=null,y=i.changeByRange(T=>{if(T.empty){let L=dt(i.doc,T.head);for(let V of c)if(V==L&&Ve(i.doc,T.head)==x((0,I.gm)(V,0)))return{changes:{from:T.head-V.length,to:T.head+V.length},range:I.jT.cursor(T.head-V.length)}}return{range:p=T}});return p||n(i.update(y,{scrollIntoView:!0,userEvent:"delete.backward"})),!p}}];function ie(i,n){let l=E(i,i.selection.main.head),c=l.brackets||fs.brackets;for(let p of c){let y=x((0,I.gm)(p,0));if(n==p)return y==p?en(i,p,c.indexOf(p+p+p)>-1,l):Ht(i,p,y,l.before||fs.before);if(n==y&&Ce(i,i.selection.main.from))return mn(i,p,y)}return null}function Ce(i,n){let l=!1;return i.field(h).between(0,i.doc.length,c=>{c==n&&(l=!0)}),l}function Ve(i,n){let l=i.sliceString(n,n+2);return l.slice(0,(0,I.nZ)((0,I.gm)(l,0)))}function dt(i,n){let l=i.sliceString(n-2,n);return(0,I.nZ)((0,I.gm)(l,0))==l.length?l:l.slice(1)}function Ht(i,n,l,c){let p=null,y=i.changeByRange(T=>{if(!T.empty)return{changes:[{insert:n,from:T.from},{insert:l,from:T.to}],effects:Oi.of(T.to+n.length),range:I.jT.range(T.anchor+n.length,T.head+n.length)};let L=Ve(i.doc,T.head);return!L||/\s/.test(L)||c.indexOf(L)>-1?{changes:{insert:n+l,from:T.head},effects:Oi.of(T.head+n.length),range:I.jT.cursor(T.head+n.length)}:{range:p=T}});return p?null:i.update(y,{scrollIntoView:!0,userEvent:"input.type"})}function mn(i,n,l){let c=null,p=i.changeByRange(y=>y.empty&&Ve(i.doc,y.head)==l?{changes:{from:y.head,to:y.head+l.length,insert:l},range:I.jT.cursor(y.head+l.length)}:c={range:y});return c?null:i.update(p,{scrollIntoView:!0,userEvent:"input.type"})}function en(i,n,l,c){let p=c.stringPrefixes||fs.stringPrefixes,y=null,T=i.changeByRange(L=>{if(!L.empty)return{changes:[{insert:n,from:L.from},{insert:n,from:L.to}],effects:Oi.of(L.to+n.length),range:I.jT.range(L.anchor+n.length,L.head+n.length)};let V=L.head,re=Ve(i.doc,V),fe;if(re==n){if(_n(i,V))return{changes:{insert:n+n,from:V},effects:Oi.of(V+n.length),range:I.jT.cursor(V+n.length)};if(Ce(i,V)){let Et=l&&i.sliceDoc(V,V+n.length*3)==n+n+n?n+n+n:n;return{changes:{from:V,to:V+Et.length,insert:Et},range:I.jT.cursor(V+Et.length)}}}else{if(l&&i.sliceDoc(V-2*n.length,V)==n+n&&(fe=Sr(i,V-2*n.length,p))>-1&&_n(i,fe))return{changes:{insert:n+n+n+n,from:V},effects:Oi.of(V+n.length),range:I.jT.cursor(V+n.length)};if(i.charCategorizer(V)(re)!=I.D0.Word&&Sr(i,V,p)>-1&&!Pr(i,V,n,p))return{changes:{insert:n+n,from:V},effects:Oi.of(V+n.length),range:I.jT.cursor(V+n.length)}}return{range:y=L}});return y?null:i.update(T,{scrollIntoView:!0,userEvent:"input.type"})}function _n(i,n){let l=(0,Ne.qz)(i).resolveInner(n+1);return l.parent&&l.from==n}function Pr(i,n,l,c){let p=(0,Ne.qz)(i).resolveInner(n,-1),y=c.reduce((T,L)=>Math.max(T,L.length),0);for(let T=0;T<5;T++){let L=i.sliceDoc(p.from,Math.min(p.to,p.from+l.length+y)),V=L.indexOf(l);if(!V||V>-1&&c.indexOf(L.slice(0,V))>-1){let fe=p.firstChild;for(;fe&&fe.from==p.from&&fe.to-fe.from>l.length+V;){if(i.sliceDoc(fe.to-l.length,fe.to)==l)return!1;fe=fe.firstChild}return!0}let re=p.to==n&&p.parent;if(!re)break;p=re}return!1}function Sr(i,n,l){let c=i.charCategorizer(n);if(c(i.sliceDoc(n-1,n))!=I.D0.Word)return n;for(let p of l){let y=n-p.length;if(i.sliceDoc(y,n)==p&&c(i.sliceDoc(y-1,y))!=I.D0.Word)return y}return-1}function Br(i={}){return[dr,ht.of(i),eo,ar,lo]}const Ai=[{key:"Ctrl-Space",run:Co},{key:"Escape",run:Oo},{key:"ArrowDown",run:Bs(!0)},{key:"ArrowUp",run:Bs(!1)},{key:"PageDown",run:Bs(!0,"page")},{key:"PageUp",run:Bs(!1,"page")},{key:"Enter",run:ko}],ar=I.Wl.highest(se.$f.computeN([ht],i=>i.facet(ht).defaultKeymap?[Ai]:[]));function Ti(i){let n=i.field(dr,!1);return n&&n.active.some(l=>l.state==1)?"pending":n&&n.active.some(l=>l.state!=0)?"active":null}const Gi=new WeakMap;function js(i){var n;let l=(n=i.field(dr,!1))===null||n===void 0?void 0:n.open;if(!l||l.disabled)return[];let c=Gi.get(l.options);return c||Gi.set(l.options,c=l.options.map(p=>p.completion)),c}function $o(i){var n;let l=(n=i.field(dr,!1))===null||n===void 0?void 0:n.open;return l&&!l.disabled&&l.selected>=0?l.options[l.selected].completion:null}function go(i){var n;let l=(n=i.field(dr,!1))===null||n===void 0?void 0:n.open;return l&&!l.disabled&&l.selected>=0?l.selected:null}function pr(i){return qs.of(i)}class Jr{constructor(n,l,c){this.from=n,this.to=l,this.diagnostic=c}}class gi{constructor(n,l,c){this.diagnostics=n,this.panel=l,this.selected=c}static init(n,l,c){let p=n,y=c.facet(Zo).markerFilter;y&&(p=y(p));let T=se.p.set(p.map(L=>L.from==L.to||L.from==L.to-1&&c.doc.lineAt(L.from).to==L.from?se.p.widget({widget:new s(L),diagnostic:L}).range(L.from):se.p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+L.severity+(L.markClass?" "+L.markClass:"")},diagnostic:L}).range(L.from,L.to)),!0);return new gi(T,l,Mi(T))}}function Mi(i,n=null,l=0){let c=null;return i.between(l,1e9,(p,y,{spec:T})=>{if(!(n&&T.diagnostic!=n))return c=new Jr(p,y,T.diagnostic),!1}),c}function Yo(i,n){let l=i.startState.doc.lineAt(n.pos);return!!(i.effects.some(c=>c.is(yo))||i.changes.touchesRange(l.from,l.to))}function Vo(i,n){return i.field(kr,!1)?n:n.concat(I.Py.appendConfig.of(Le))}function tl(i,n){return{effects:Vo(i,[yo.of(n)])}}const yo=I.Py.define(),Wo=I.Py.define(),ws=I.Py.define(),kr=I.QQ.define({create(){return new gi(se.p.none,null,null)},update(i,n){if(n.docChanged){let l=i.diagnostics.map(n.changes),c=null;if(i.selected){let p=n.changes.mapPos(i.selected.from,1);c=Mi(l,i.selected.diagnostic,p)||Mi(l,null,p)}i=new gi(l,i.panel,c)}for(let l of n.effects)l.is(yo)?i=gi.init(l.value,i.panel,n.state):l.is(Wo)?i=new gi(i.diagnostics,l.value?t.open:null,i.selected):l.is(ws)&&(i=new gi(i.diagnostics,i.panel,l.value));return i},provide:i=>[se.mH.from(i,n=>n.panel),se.tk.decorations.from(i,n=>n.diagnostics)]});function Qo(i){let n=i.field(kr,!1);return n?n.diagnostics.size:0}const nl=se.p.mark({class:"cm-lintRange cm-lintRange-active"});function rl(i,n,l){let{diagnostics:c}=i.state.field(kr),p=[],y=2e8,T=0;c.between(n-(l<0?1:0),n+(l>0?1:0),(V,re,{spec:fe})=>{n>=V&&n<=re&&(V==re||(n>V||l>0)&&(n<re||l<0))&&(p.push(fe.diagnostic),y=Math.min(V,y),T=Math.max(re,T))});let L=i.state.facet(Zo).tooltipFilter;return L&&(p=L(p)),p.length?{pos:y,end:T,above:i.state.doc.lineAt(y).to<T,create(){return{dom:Ho(i,p)}}}:null}function Ho(i,n){return Cn("ul",{class:"cm-tooltip-lint"},n.map(l=>cl(i,l,!1)))}const il=i=>{let n=i.state.field(kr,!1);(!n||!n.panel)&&i.dispatch({effects:Vo(i.state,[Wo.of(!0)])});let l=(0,se.Sd)(i,t.open);return l&&l.dom.querySelector(".cm-panel-lint ul").focus(),!0},qo=i=>{let n=i.state.field(kr,!1);return!n||!n.panel?!1:(i.dispatch({effects:Wo.of(!1)}),!0)},sl=i=>{let n=i.state.field(kr,!1);if(!n)return!1;let l=i.state.selection.main,c=n.diagnostics.iter(l.to+1);return!c.value&&(c=n.diagnostics.iter(0),!c.value||c.from==l.from&&c.to==l.to)?!1:(i.dispatch({selection:{anchor:c.from,head:c.to},scrollIntoView:!0}),!0)},ol=i=>{let{state:n}=i,l=n.field(kr,!1);if(!l)return!1;let c=n.selection.main,p,y,T,L;return l.diagnostics.between(0,n.doc.length,(V,re)=>{re<c.to&&(p==null||p<V)&&(p=V,y=re),(T==null||V>T)&&(T=V,L=re)}),T==null||p==null&&T==c.from?!1:(i.dispatch({selection:{anchor:p!=null?p:T,head:y!=null?y:L},scrollIntoView:!0}),!0)},ll=[{key:"Mod-Shift-m",run:il,preventDefault:!0},{key:"F8",run:sl}],zo=null,Zo=I.r$.define({combine(i){return Object.assign({sources:i.map(n=>n.source)},(0,I.BO)(i.map(n=>n.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(n,l)=>n?l?c=>n(c)||l(c):n:l}))}});function yl(i,n={}){return[Zo.of({source:i,config:n}),zo,Le]}function dl(i){let n=i.plugin(zo);n&&n.force()}function al(i){let n=[];if(i)e:for(let{name:l}of i){for(let c=0;c<l.length;c++){let p=l[c];if(/[a-zA-Z]/.test(p)&&!n.some(y=>y.toLowerCase()==p.toLowerCase())){n.push(p);continue e}}n.push("")}return n}function cl(i,n,l){var c;let p=l?al(n.actions):[];return Cn("li",{class:"cm-diagnostic cm-diagnostic-"+n.severity},Cn("span",{class:"cm-diagnosticText"},n.renderMessage?n.renderMessage():n.message),(c=n.actions)===null||c===void 0?void 0:c.map((y,T)=>{let L=!1,V=Et=>{if(Et.preventDefault(),L)return;L=!0;let nn=Mi(i.state.field(kr).diagnostics,n);nn&&y.apply(i,nn.from,nn.to)},{name:re}=y,fe=p[T]?re.indexOf(p[T]):-1,Fe=fe<0?re:[re.slice(0,fe),Cn("u",re.slice(fe,fe+1)),re.slice(fe+1)];return Cn("button",{type:"button",class:"cm-diagnosticAction",onclick:V,onmousedown:V,"aria-label":` Action: ${re}${fe<0?"":` (access key "${p[T]})"`}.`},Fe)}),n.source&&Cn("div",{class:"cm-diagnosticSource"},n.source))}class s extends se.l9{constructor(n){super(),this.diagnostic=n}eq(n){return n.diagnostic==this.diagnostic}toDOM(){return Cn("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class e{constructor(n,l){this.diagnostic=l,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=cl(n,l,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class t{constructor(n){this.view=n,this.items=[];let l=p=>{if(p.keyCode==27)qo(this.view),this.view.focus();else if(p.keyCode==38||p.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(p.keyCode==40||p.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(p.keyCode==36)this.moveSelection(0);else if(p.keyCode==35)this.moveSelection(this.items.length-1);else if(p.keyCode==13)this.view.focus();else if(p.keyCode>=65&&p.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:y}=this.items[this.selectedIndex],T=al(y.actions);for(let L=0;L<T.length;L++)if(T[L].toUpperCase().charCodeAt(0)==p.keyCode){let V=Mi(this.view.state.field(kr).diagnostics,y);V&&y.actions[L].apply(n,V.from,V.to)}}else return;p.preventDefault()},c=p=>{for(let y=0;y<this.items.length;y++)this.items[y].dom.contains(p.target)&&this.moveSelection(y)};this.list=Cn("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:l,onclick:c}),this.dom=Cn("div",{class:"cm-panel-lint"},this.list,Cn("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>qo(this.view)},"\xD7")),this.update()}get selectedIndex(){let n=this.view.state.field(kr).selected;if(!n)return-1;for(let l=0;l<this.items.length;l++)if(this.items[l].diagnostic==n.diagnostic)return l;return-1}update(){let{diagnostics:n,selected:l}=this.view.state.field(kr),c=0,p=!1,y=null;for(n.between(0,this.view.state.doc.length,(T,L,{spec:V})=>{let re=-1,fe;for(let Fe=c;Fe<this.items.length;Fe++)if(this.items[Fe].diagnostic==V.diagnostic){re=Fe;break}re<0?(fe=new e(this.view,V.diagnostic),this.items.splice(c,0,fe),p=!0):(fe=this.items[re],re>c&&(this.items.splice(c,re-c),p=!0)),l&&fe.diagnostic==l.diagnostic?fe.dom.hasAttribute("aria-selected")||(fe.dom.setAttribute("aria-selected","true"),y=fe):fe.dom.hasAttribute("aria-selected")&&fe.dom.removeAttribute("aria-selected"),c++});c<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)p=!0,this.items.pop();this.items.length==0&&(this.items.push(new e(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),p=!0),y?(this.list.setAttribute("aria-activedescendant",y.id),this.view.requestMeasure({key:this,read:()=>({sel:y.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:T,panel:L})=>{T.top<L.top?this.list.scrollTop-=L.top-T.top:T.bottom>L.bottom&&(this.list.scrollTop+=T.bottom-L.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),p&&this.sync()}sync(){let n=this.list.firstChild;function l(){let c=n;n=c.nextSibling,c.remove()}for(let c of this.items)if(c.dom.parentNode==this.list){for(;n!=c.dom;)l();n=c.dom.nextSibling}else this.list.insertBefore(c.dom,n);for(;n;)l()}moveSelection(n){if(this.selectedIndex<0)return;let l=this.view.state.field(kr),c=Mi(l.diagnostics,this.items[n].diagnostic);c&&this.view.dispatch({selection:{anchor:c.from,head:c.to},scrollIntoView:!0,effects:ws.of(c)})}static open(n){return new t(n)}}function r(i,n='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${n}>${encodeURIComponent(i)}</svg>')`}function o(i){return r(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const u=se.tk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:o("#d11")},".cm-lintRange-warning":{backgroundImage:o("orange")},".cm-lintRange-info":{backgroundImage:o("#999")},".cm-lintRange-hint":{backgroundImage:o("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function m(i){return i=="error"?4:i=="warning"?3:i=="info"?2:1}class w extends se.SJ{constructor(n){super(),this.diagnostics=n,this.severity=n.reduce((l,c)=>m(l)<m(c.severity)?c.severity:l,"hint")}toDOM(n){let l=document.createElement("div");l.className="cm-lint-marker cm-lint-marker-"+this.severity;let c=this.diagnostics,p=n.state.facet(Ke).tooltipFilter;return p&&(c=p(c)),c.length&&(l.onmouseover=()=>D(n,l,c)),l}}function A(i,n){let l=c=>{let p=n.getBoundingClientRect();if(!(c.clientX>p.left-10&&c.clientX<p.right+10&&c.clientY>p.top-10&&c.clientY<p.bottom+10)){for(let y=c.target;y;y=y.parentNode)if(y.nodeType==1&&y.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",l),i.state.field(we)&&i.dispatch({effects:ce.of(null)})}};window.addEventListener("mousemove",l)}function D(i,n,l){function c(){let T=i.elementAtHeight(n.getBoundingClientRect().top+5-i.documentTop);i.coordsAtPos(T.from)&&i.dispatch({effects:ce.of({pos:T.from,above:!1,create(){return{dom:Ho(i,l),getCoords:()=>n.getBoundingClientRect()}}})}),n.onmouseout=n.onmousemove=null,A(i,n)}let{hoverTime:p}=i.state.facet(Ke),y=setTimeout(c,p);n.onmouseout=()=>{clearTimeout(y),n.onmouseout=n.onmousemove=null},n.onmousemove=()=>{clearTimeout(y),y=setTimeout(c,p)}}function R(i,n){let l=Object.create(null);for(let p of n){let y=i.lineAt(p.from);(l[y.from]||(l[y.from]=[])).push(p)}let c=[];for(let p in l)c.push(new w(l[p]).range(+p));return I.Xs.of(c,!0)}const Y=(0,se.v5)({class:"cm-gutter-lint",markers:i=>i.state.field(Q)}),Q=I.QQ.define({create(){return I.Xs.empty},update(i,n){i=i.map(n.changes);let l=n.state.facet(Ke).markerFilter;for(let c of n.effects)if(c.is(yo)){let p=c.value;l&&(p=l(p||[])),i=R(n.state.doc,p.slice(0))}return i}}),ce=I.Py.define(),we=I.QQ.define({create(){return null},update(i,n){return i&&n.docChanged&&(i=Yo(n,i)?null:Object.assign(Object.assign({},i),{pos:n.changes.mapPos(i.pos)})),n.effects.reduce((l,c)=>c.is(ce)?c.value:l,i)},provide:i=>se.hJ.from(i)}),Qe=se.tk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:r('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:r('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:r('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Le=[kr,se.tk.decorations.compute([kr],i=>{let{selected:n,panel:l}=i.field(kr);return!n||!l||n.from==n.to?se.p.none:se.p.set([nl.range(n.from,n.to)])}),(0,se.bF)(rl,{hideOn:Yo}),u],Ke=I.r$.define({combine(i){return(0,I.BO)(i,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function Vt(i={}){return[Ke.of(i),Q,Y,Qe,we]}function gn(i,n){let l=i.field(kr,!1);if(l&&l.diagnostics.size)for(let c=RangeSet.iter([l.diagnostics]);c.value;c.next())n(c.value.spec.diagnostic,c.from,c.to)}var $t=function(n){n===void 0&&(n={});var l=[];n.closeBracketsKeymap!==!1&&(l=l.concat(de)),n.defaultKeymap!==!1&&(l=l.concat(Js)),n.searchKeymap!==!1&&(l=l.concat(Fi)),n.historyKeymap!==!1&&(l=l.concat(pe)),n.foldKeymap!==!1&&(l=l.concat(Ne.e7)),n.completionKeymap!==!1&&(l=l.concat(Ai)),n.lintKeymap!==!1&&(l=l.concat(ll));var c=[];return n.lineNumbers!==!1&&c.push((0,se.Eu)()),n.highlightActiveLineGutter!==!1&&c.push((0,se.HQ)()),n.highlightSpecialChars!==!1&&c.push((0,se.AE)()),n.history!==!1&&c.push(ot()),n.foldGutter!==!1&&c.push((0,Ne.mi)()),n.drawSelection!==!1&&c.push((0,se.Uw)()),n.dropCursor!==!1&&c.push((0,se.qr)()),n.allowMultipleSelections!==!1&&c.push(I.yy.allowMultipleSelections.of(!0)),n.indentOnInput!==!1&&c.push((0,Ne.nY)()),n.syntaxHighlighting!==!1&&c.push((0,Ne.nF)(Ne.R_,{fallback:!0})),n.bracketMatching!==!1&&c.push((0,Ne.n$)()),n.closeBrackets!==!1&&c.push(a()),n.autocompletion!==!1&&c.push(Br()),n.rectangularSelection!==!1&&c.push((0,se.Zs)()),n.crosshairCursor!==!1&&c.push((0,se.S2)()),n.highlightActiveLine!==!1&&c.push((0,se.ZO)()),n.highlightSelectionMatches!==!1&&c.push(Or()),n.tabSize&&typeof n.tabSize=="number"&&c.push(Ne.c.of(" ".repeat(n.tabSize))),c.concat([se.$f.of(l.flat())]).filter(Boolean)},tn=function(n){n===void 0&&(n={});var l=[];n.defaultKeymap!==!1&&(l=l.concat(defaultKeymap)),n.historyKeymap!==!1&&(l=l.concat(historyKeymap));var c=[];return n.highlightSpecialChars!==!1&&c.push(highlightSpecialChars()),n.history!==!1&&c.push(history()),n.drawSelection!==!1&&c.push(drawSelection()),n.syntaxHighlighting!==!1&&c.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),c.concat([keymap.of(l.flat())]).filter(Boolean)},et=z(86253);const Dr="#e5c07b",Vi="#e06c75",Xi="#56b6c2",so="#ffffff",$s="#abb2bf",Es="#7d8799",oo="#61afef",hs="#98c379",Wi="#d19a66",ks="#c678dd",us="#21252b",Cs="#2c313a",Pi="#282c34",yi="#353a42",pl="#3E4451",fl="#528bff",Dl={chalky:Dr,coral:Vi,cyan:Xi,invalid:so,ivory:$s,stone:Es,malibu:oo,sage:hs,whiskey:Wi,violet:ks,darkBackground:us,highlightBackground:Cs,background:Pi,tooltipBackground:yi,selection:pl,cursor:fl},vl=se.tk.theme({"&":{color:$s,backgroundColor:Pi},".cm-content":{caretColor:fl},".cm-cursor, .cm-dropCursor":{borderLeftColor:fl},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:pl},".cm-panels":{backgroundColor:us,color:$s},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Pi,color:Es,border:"none"},".cm-activeLineGutter":{backgroundColor:Cs},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:yi},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:yi,borderBottomColor:yi},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Cs,color:$s}}},{dark:!0}),bl=Ne.Qf.define([{tag:et.pJ.keyword,color:ks},{tag:[et.pJ.name,et.pJ.deleted,et.pJ.character,et.pJ.propertyName,et.pJ.macroName],color:Vi},{tag:[et.pJ.function(et.pJ.variableName),et.pJ.labelName],color:oo},{tag:[et.pJ.color,et.pJ.constant(et.pJ.name),et.pJ.standard(et.pJ.name)],color:Wi},{tag:[et.pJ.definition(et.pJ.name),et.pJ.separator],color:$s},{tag:[et.pJ.typeName,et.pJ.className,et.pJ.number,et.pJ.changed,et.pJ.annotation,et.pJ.modifier,et.pJ.self,et.pJ.namespace],color:Dr},{tag:[et.pJ.operator,et.pJ.operatorKeyword,et.pJ.url,et.pJ.escape,et.pJ.regexp,et.pJ.link,et.pJ.special(et.pJ.string)],color:Xi},{tag:[et.pJ.meta,et.pJ.comment],color:Es},{tag:et.pJ.strong,fontWeight:"bold"},{tag:et.pJ.emphasis,fontStyle:"italic"},{tag:et.pJ.strikethrough,textDecoration:"line-through"},{tag:et.pJ.link,color:Es,textDecoration:"underline"},{tag:et.pJ.heading,fontWeight:"bold",color:Vi},{tag:[et.pJ.atom,et.pJ.bool,et.pJ.special(et.pJ.variableName)],color:Wi},{tag:[et.pJ.processingInstruction,et.pJ.string,et.pJ.inserted],color:hs},{tag:et.pJ.invalid,color:so}]),xl=[vl,(0,Ne.nF)(bl)];var Sl=se.tk.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),wl=function(n){n===void 0&&(n={});var{indentWithTab:l=!0,editable:c=!0,readOnly:p=!1,theme:y="light",placeholder:T="",basicSetup:L=!0}=n,V=[];switch(l&&V.unshift(se.$f.of([Gs])),L&&(typeof L=="boolean"?V.unshift($t()):V.unshift($t(L))),T&&V.unshift((0,se.W$)(T)),y){case"light":V.push(Sl);break;case"dark":V.push(xl);break;case"none":break;default:V.push(y);break}return c===!1&&V.push(se.tk.editable.of(!1)),p&&V.push(I.yy.readOnly.of(!0)),[...V]},El=i=>({line:i.state.doc.lineAt(i.state.selection.main.from),lineCount:i.state.doc.lines,lineBreak:i.state.lineBreak,length:i.state.doc.length,readOnly:i.state.readOnly,tabSize:i.state.tabSize,selection:i.state.selection,selectionAsSingle:i.state.selection.asSingle().main,ranges:i.state.selection.ranges,selectionCode:i.state.sliceDoc(i.state.selection.main.from,i.state.selection.main.to),selections:i.state.selection.ranges.map(n=>i.state.sliceDoc(n.from,n.to)),selectedText:i.state.selection.ranges.some(n=>!n.empty)}),ml=I.q6.define(),kl=[];function Cl(i){var{value:n,selection:l,onChange:c,onStatistics:p,onCreateEditor:y,onUpdate:T,extensions:L=kl,autoFocus:V,theme:re="light",height:fe="",minHeight:Fe="",maxHeight:Et="",placeholder:nn="",width:sr="",minWidth:ni="",maxWidth:vo="",editable:Vs=!0,readOnly:mr=!1,indentWithTab:Yi=!0,basicSetup:vi=!0,root:Fr,initialState:ds}=i,[ps,_o]=(0,me.useState)(),[jr,Os]=(0,me.useState)(),[bo,xo]=(0,me.useState)(),hl=se.tk.theme({"&":{height:fe,minHeight:Fe,maxHeight:Et,width:sr,minWidth:ni,maxWidth:vo},"& .cm-scroller":{height:"100% !important"}}),ul=se.tk.updateListener.of(Qi=>{if(Qi.docChanged&&typeof c=="function"&&!Qi.transactions.some(Pl=>Pl.annotation(ml))){var Ko=Qi.state.doc,el=Ko.toString();c(el,Qi)}p&&p(El(Qi))}),Ml=wl({theme:re,editable:Vs,readOnly:mr,placeholder:nn,indentWithTab:Yi,basicSetup:vi}),Uo=[ul,hl,...Ml];return T&&typeof T=="function"&&Uo.push(se.tk.updateListener.of(T)),Uo=Uo.concat(L),(0,me.useEffect)(()=>{if(ps&&!bo){var Qi={doc:n,selection:l,extensions:Uo},Ko=ds?I.yy.fromJSON(ds.json,Qi,ds.fields):I.yy.create(Qi);if(xo(Ko),!jr){var el=new se.tk({state:Ko,parent:ps,root:Fr});Os(el),y&&y(el,Ko)}}return()=>{jr&&(xo(void 0),Os(void 0))}},[ps,bo]),(0,me.useEffect)(()=>_o(i.container),[i.container]),(0,me.useEffect)(()=>()=>{jr&&(jr.destroy(),Os(void 0))},[jr]),(0,me.useEffect)(()=>{V&&jr&&jr.focus()},[V,jr]),(0,me.useEffect)(()=>{jr&&jr.dispatch({effects:I.Py.reconfigure.of(Uo)})},[re,L,fe,Fe,Et,sr,ni,vo,nn,Vs,mr,Yi,vi,c,T]),(0,me.useEffect)(()=>{if(n!==void 0){var Qi=jr?jr.state.doc.toString():"";jr&&n!==Qi&&jr.dispatch({changes:{from:0,to:Qi.length,insert:n||""},annotations:[ml.of(!0)]})}},[n,jr]),{state:bo,setState:xo,view:jr,setView:Os,container:ps,setContainer:_o}}var Ol=z(52322),Al=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],gl=(0,me.forwardRef)((i,n)=>{var{className:l,value:c="",selection:p,extensions:y=[],onChange:T,onStatistics:L,onCreateEditor:V,onUpdate:re,autoFocus:fe,theme:Fe="light",height:Et,minHeight:nn,maxHeight:sr,width:ni,minWidth:vo,maxWidth:Vs,basicSetup:mr,placeholder:Yi,indentWithTab:vi,editable:Fr,readOnly:ds,root:ps,initialState:_o}=i,jr=(0,ke.Z)(i,Al),Os=(0,me.useRef)(null),{state:bo,view:xo,container:hl}=Cl({container:Os.current,root:ps,value:c,autoFocus:fe,theme:Fe,height:Et,minHeight:nn,maxHeight:sr,width:ni,minWidth:vo,maxWidth:Vs,basicSetup:mr,placeholder:Yi,indentWithTab:vi,editable:Fr,readOnly:ds,selection:p,onChange:T,onStatistics:L,onCreateEditor:V,onUpdate:re,extensions:y,initialState:_o});if((0,me.useImperativeHandle)(n,()=>({editor:Os.current,state:bo,view:xo}),[Os,hl,bo,xo]),typeof c!="string")throw new Error("value must be typeof string but got "+typeof c);var ul=typeof Fe=="string"?"cm-theme-"+Fe:"cm-theme";return(0,Ol.jsx)("div",(0,v.Z)({ref:Os,className:""+ul+(l?" "+l:"")},jr))});gl.displayName="CodeMirror";var Tl=gl},39714:function(Bn){"use strict";var pt=function(Me){return z(Me)&&!v(Me)};function z(ee){return!!ee&&typeof ee=="object"}function v(ee){var Me=Object.prototype.toString.call(ee);return Me==="[object RegExp]"||Me==="[object Date]"||I(ee)}var ke=typeof Symbol=="function"&&Symbol.for,me=ke?Symbol.for("react.element"):60103;function I(ee){return ee.$$typeof===me}function se(ee){return Array.isArray(ee)?[]:{}}function Ne(ee,Me){return Me.clone!==!1&&Me.isMergeableObject(ee)?Je(se(ee),ee,Me):ee}function De(ee,Me,ge){return ee.concat(Me).map(function(je){return Ne(je,ge)})}function Tt(ee,Me){if(!Me.customMerge)return Je;var ge=Me.customMerge(ee);return typeof ge=="function"?ge:Je}function rt(ee){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(ee).filter(function(Me){return Object.propertyIsEnumerable.call(ee,Me)}):[]}function st(ee){return Object.keys(ee).concat(rt(ee))}function He(ee,Me){try{return Me in ee}catch{return!1}}function gt(ee,Me){return He(ee,Me)&&!(Object.hasOwnProperty.call(ee,Me)&&Object.propertyIsEnumerable.call(ee,Me))}function tt(ee,Me,ge){var je={};return ge.isMergeableObject(ee)&&st(ee).forEach(function(Ze){je[Ze]=Ne(ee[Ze],ge)}),st(Me).forEach(function(Ze){gt(ee,Ze)||(He(ee,Ze)&&ge.isMergeableObject(Me[Ze])?je[Ze]=Tt(Ze,ge)(ee[Ze],Me[Ze],ge):je[Ze]=Ne(Me[Ze],ge))}),je}function Je(ee,Me,ge){ge=ge||{},ge.arrayMerge=ge.arrayMerge||De,ge.isMergeableObject=ge.isMergeableObject||pt,ge.cloneUnlessOtherwiseSpecified=Ne;var je=Array.isArray(Me),Ze=Array.isArray(ee),Oe=je===Ze;return Oe?je?ge.arrayMerge(ee,Me,ge):tt(ee,Me,ge):Ne(Me,ge)}Je.all=function(Me,ge){if(!Array.isArray(Me))throw new Error("first argument should be an array");return Me.reduce(function(je,Ze){return Je(je,Ze,ge)},{})};var It=Je;Bn.exports=It},44091:function(Bn,pt,z){"use strict";var v;v={value:!0};const ke=z(73961);var me;(function(I){I.RULES=[{name:"Grammar",bnf:[["RULE_S*","%Atomic*","EOF"]]},{name:"%Atomic",bnf:[["Production","RULE_S*"]],fragment:!0},{name:"Production",bnf:[["NCName","RULE_S*",'"::="',"RULE_WHITESPACE*","Choice","RULE_WHITESPACE*","RULE_EOL+","RULE_S*"]]},{name:"NCName",bnf:[[/[a-zA-Z][a-zA-Z_0-9]*/]]},{name:"Choice",bnf:[["SequenceOrDifference","%_Choice_1*"]],fragment:!0},{name:"%_Choice_1",bnf:[["RULE_WHITESPACE*",'"|"',"RULE_WHITESPACE*","SequenceOrDifference"]],fragment:!0},{name:"SequenceOrDifference",bnf:[["Item","RULE_WHITESPACE*","%_Item_1?"]]},{name:"%_Item_1",bnf:[["Minus","Item"],["Item*"]],fragment:!0},{name:"Minus",bnf:[['"-"']]},{name:"Item",bnf:[["RULE_WHITESPACE*","%Primary","PrimaryDecoration?"]],fragment:!0},{name:"PrimaryDecoration",bnf:[['"?"'],['"*"'],['"+"']]},{name:"DecorationName",bnf:[['"ebnf://"',/[^\x5D#]+/]]},{name:"%Primary",bnf:[["NCName"],["StringLiteral"],["CharCode"],["CharClass"],["SubItem"]],fragment:!0},{name:"SubItem",bnf:[['"("',"RULE_WHITESPACE*","Choice","RULE_WHITESPACE*",'")"']]},{name:"StringLiteral",bnf:[[`'"'`,/[^"]*/,`'"'`],[`"'"`,/[^']*/,`"'"`]],pinned:1},{name:"CharCode",bnf:[['"#x"',/[0-9a-zA-Z]+/]]},{name:"CharClass",bnf:[["'['","'^'?","%RULE_CharClass_1+",'"]"']]},{name:"%RULE_CharClass_1",bnf:[["CharCodeRange"],["CharRange"],["CharCode"],["RULE_Char"]],fragment:!0},{name:"RULE_Char",bnf:[[/\x09/],[/\x0A/],[/\x0D/],[/[\x20-\x5c]/],[/[\x5e-\uD7FF]/],[/[\uE000-\uFFFD]/]]},{name:"CharRange",bnf:[["RULE_Char",'"-"',"RULE_Char"]]},{name:"CharCodeRange",bnf:[["CharCode",'"-"',"CharCode"]]},{name:"RULE_WHITESPACE",bnf:[["%RULE_WHITESPACE_CHAR*"],["Comment","RULE_WHITESPACE*"]]},{name:"RULE_S",bnf:[["RULE_WHITESPACE","RULE_S*"],["RULE_EOL","RULE_S*"]]},{name:"%RULE_WHITESPACE_CHAR",bnf:[[/\x09/],[/\x20/]],fragment:!0},{name:"Comment",bnf:[['"/*"',"%RULE_Comment_Body*",'"*/"']]},{name:"%RULE_Comment_Body",bnf:[['!"*/"',/[^*]/]],fragment:!0},{name:"RULE_EOL",bnf:[[/\x0D/,/\x0A/],[/\x0A/],[/\x0D/]]},{name:"Link",bnf:[["'['","Url","']'"]]},{name:"Url",bnf:[[/[^\x5D:/?#]/,'"://"',/[^\x5D#]+/,"%Url1?"]]},{name:"%Url1",bnf:[['"#"',"NCName"]],fragment:!0}],I.defaultParser=new ke.Parser(I.RULES,{debug:!1});const se=/^(!|&)/,Ne=/(\?|\+|\*)$/,De=/^%/;function Tt(Oe,Xe){if(typeof Oe=="string"){if(se.test(Oe))return"";if(De.test(Oe)){let K=Ne.exec(Oe),yt=K?K[0]+" ":"";return rt(Oe,Xe)?He(Oe,Xe)+yt:"("+He(Oe,Xe)+")"+yt}return Oe}else return Oe.source.replace(/\\(?:x|u)([a-zA-Z0-9]+)/g,"#x$1").replace(/\[\\(?:x|u)([a-zA-Z0-9]+)-\\(?:x|u)([a-zA-Z0-9]+)\]/g,"[#x$1-#x$2]")}function rt(Oe,Xe){let Ye=ke.findRuleByName(Oe,Xe);return Ye&&Ye.bnf.length==1&&Ye.bnf[0].length==1&&(Ye.bnf[0][0]instanceof RegExp||Ye.bnf[0][0][0]=='"'||Ye.bnf[0][0][0]=="'")}function st(Oe,Xe){return Oe.map(Ye=>Tt(Ye,Xe)).join(" ")}function He(Oe,Xe){let Ye=ke.findRuleByName(Oe,Xe);return Ye?Ye.bnf.map(K=>st(K,Xe)).join(" | "):"RULE_NOT_FOUND {"+Oe+"}"}function gt(Oe){let Xe=[];return Oe.grammarRules.forEach(Ye=>{if(!/^%/.test(Ye.name)){let K=Ye.recover?" /* { recoverUntil="+Ye.recover+" } */":"";Xe.push(Ye.name+" ::= "+He(Ye.name,Oe)+K)}}),Xe.join(`
`)}I.emit=gt;let tt=0;function Je(Oe,Xe){throw console.log("reberia restar "+Xe+" a "+Oe),new Error("Difference not supported yet")}function It(Oe){return new RegExp(Oe.replace(/#x([a-zA-Z0-9]{4})/g,"\\u$1").replace(/#x([a-zA-Z0-9]{3})/g,"\\u0$1").replace(/#x([a-zA-Z0-9]{2})/g,"\\x$1").replace(/#x([a-zA-Z0-9]{1})/g,"\\x0$1"))}function ee(Oe,Xe,Ye){let K=null,yt=[];return Xe.children.forEach((le,Ie)=>{le.type=="Minus"&&Je(K,le);let ze=Xe.children[Ie+1];ze=ze&&ze.type=="PrimaryDecoration"&&ze.text||"";let ot="";switch(le.type){case"SubItem":let Ae="%"+(Ye+tt++);Me(Oe,le,Ae),yt.push(ot+Ae+ze);break;case"NCName":case"StringLiteral":yt.push(ot+le.text+ze);break;case"CharCode":case"CharClass":if(ze||ot){let Ue={name:"%"+(Ye+tt++),bnf:[[It(le.text)]]};Oe.push(Ue),yt.push(ot+Ue.name+ze)}else yt.push(It(le.text));break;case"PrimaryDecoration":break;default:throw new Error(" HOW SHOULD I PARSE THIS? "+le.type+" -> "+JSON.stringify(le.text))}K=le}),yt}function Me(Oe,Xe,Ye){let K=Xe.children.filter(Ie=>Ie.type=="SequenceOrDifference").map(Ie=>ee(Oe,Ie,Ye)),yt={name:Ye,bnf:K},le=null;K.forEach(Ie=>{le=le||Ie.recover,delete Ie.recover}),Ye.indexOf("%")==0&&(yt.fragment=!0),le&&(yt.recover=le),Oe.push(yt)}function ge(Oe,Xe=I.defaultParser){let Ye=Xe.getAST(Oe);if(!Ye)throw new Error("Could not parse "+Oe);if(Ye.errors&&Ye.errors.length)throw Ye.errors[0];let K=[];return Ye.children.filter(yt=>yt.type=="Production").map(yt=>{let le=yt.children.filter(Ie=>Ie.type=="NCName")[0].text;Me(K,yt,le)}),K}I.getRules=ge;function je(Oe,Xe=I.defaultParser){return ge(Oe.join(""),Xe)}I.Transform=je;class Ze extends ke.Parser{constructor(Xe,Ye){const K=Ye&&Ye.debugRulesParser===!0?new ke.Parser(I.RULES,{debug:!0}):I.defaultParser;super(ge(Xe,K),Ye)}emitSource(){return gt(this)}}I.Parser=Ze})(me||(me={})),pt.Z=me},73961:function(Bn,pt,z){"use strict";Object.defineProperty(pt,"__esModule",{value:!0}),pt.Parser=pt.findRuleByName=pt.parseRuleName=pt.escapeRegExp=pt.readToken=void 0;const v=/^[A-Z0-9_]+$/,ke=/(\?|\+|\*)$/,me=/^(@|&|!)/,I="WS",se=z(80707);function Ne(ee,Me){let ge=Me.exec(ee);return ge&&ge.index==0?ge[0].length==0&&Me.source.length>0?null:{type:null,text:ge[0],rest:ee.substr(ge[0].length),start:0,end:ge[0].length-1,fullText:ge[0],errors:[],children:[],parent:null}:null}pt.readToken=Ne;function De(ee){return ee.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}pt.escapeRegExp=De;function Tt(ee){ee.rest="",ee.children&&ee.children.forEach(Me=>Tt(Me))}function rt(ee,Me){ee.start+=Me,ee.end+=Me,ee.children&&ee.children.forEach(ge=>rt(ge,ee.start))}function st(ee,Me){Me.errors&&Me.errors.length&&Me.errors.forEach(ge=>ee.push(ge)),Me.children&&Me.children.forEach(ge=>st(ee,ge))}function He(ee){let Me=ke.exec(ee),ge=me.exec(ee),je=Me&&Me[0]||"",Ze=ge&&ge[0]||"",Oe={raw:ee,name:ee.replace(ke,"").replace(me,""),isOptional:je=="?"||je=="*",allowRepetition:je=="+"||je=="*",atLeastOne:je=="+",lookupPositive:Ze=="&",lookupNegative:Ze=="!",pinned:Ze=="@",lookup:!1,isLiteral:!1};return Oe.isLiteral=Oe.name[0]=="'"||Oe.name[0]=='"',Oe.lookup=Oe.lookupNegative||Oe.lookupPositive,Oe}pt.parseRuleName=He;function gt(ee,Me){let ge=He(ee);return Me.cachedRules[ge.name]||null}pt.findRuleByName=gt;function tt(ee,Me){if(ee.children){let ge=ee.children.filter(je=>je.type&&Me.test(je.type));for(let je=0;je<ge.length;je++){let Ze=ee.children.indexOf(ge[je]);Ze!=-1&&ee.children.splice(Ze,1)}ee.children.forEach(je=>tt(je,Me))}}const Je=["EOF"];class It{constructor(Me,ge){this.grammarRules=Me,this.options=ge,this.cachedRules={},this.debug=ge?ge.debug===!0:!1;let je=[],Ze=[];if(Me.forEach(Oe=>{let Xe=He(Oe.name);if(Xe.name in this.cachedRules){je.push("Duplicated rule "+Xe.name);return}else this.cachedRules[Xe.name]=Oe;if(!Oe.bnf||!Oe.bnf.length){let Ye="Missing rule content, rule: "+Oe.name;je.indexOf(Ye)==-1&&je.push(Ye)}else Oe.bnf.forEach(Ye=>{if(typeof Ye[0]=="string"&&He(Ye[0]).name==Oe.name){let yt="Left recursion is not allowed, rule: "+Oe.name;je.indexOf(yt)==-1&&je.push(yt)}Ye.forEach(K=>{if(typeof K=="string"){let yt=He(K);!yt.isLiteral&&Ze.indexOf(yt.name)==-1&&Je.indexOf(yt.name)==-1&&Ze.push(yt.name)}})});I==Oe.name&&(Oe.implicitWs=!1),Oe.implicitWs&&Ze.indexOf(I)==-1&&Ze.push(I),Oe.recover&&Ze.indexOf(Oe.recover)==-1&&Ze.push(Oe.recover)}),Ze.forEach(Oe=>{Oe in this.cachedRules||je.push("Missing rule "+Oe)}),je.length)throw new Error(je.join(`
`))}getAST(Me,ge){ge||(ge=this.grammarRules.filter(Ze=>!Ze.fragment&&Ze.name.indexOf("%")!=0)[0].name);let je=this.parse(Me,ge);if(je){st(je.errors,je),rt(je,0),tt(je,/^%/),(!this.options||!this.options.keepUpperRules)&&tt(je,v);let Ze=je.rest;Ze&&new se.TokenError(`Unexpected end of input: 
`+Ze,je),Tt(je),je.rest=Ze}return je}emitSource(){return"CANNOT EMIT SOURCE FROM BASE Parser"}parse(Me,ge,je=0){let Ze=null,Oe=He(ge),Xe,Ye=this.debug&&!v.test(Oe.name);Ye&&console.log(new Array(je).join("\u2502  ")+"Trying to get "+ge+" from "+JSON.stringify(Me.split(`
`)[0]));let K=Oe.name,yt=gt(Oe.name,this);if(Oe.name=="EOF"){if(Me.length)return null;if(Me.length==0)return{type:"EOF",text:"",rest:"",start:0,end:0,fullText:"",errors:[],children:[],parent:null}}try{if(!yt&&Oe.isLiteral){let le=Oe.name.trim();if(le.startsWith('"')?le=JSON.parse(le):le.startsWith("'")&&(le=le.replace(/^'(.+)'$/,"$1").replace(/\\'/g,"'")),le==="")return{type:"%%EMPTY%%",text:"",rest:Me,start:0,end:0,fullText:"",errors:[],children:[],parent:null};Xe=new RegExp(De(le)),K=null}}catch(le){return le instanceof ReferenceError&&console.error(le),null}if(Xe){let le=Ne(Me,Xe);if(le)return le.type=K,le}else{let le=yt.bnf;le instanceof Array&&le.forEach(Ie=>{if(Ze)return;let ze=null,ot={type:Oe.name,text:"",children:[],end:0,errors:[],fullText:"",parent:null,start:0,rest:Me};yt.fragment&&(ot.fragment=!0);let Ae=Me,Ue=0,Ge=Ie.length>0,lt=!1;for(let ye=0;ye<Ie.length;ye++)if(typeof Ie[ye]=="string"){let xe=He(Ie[ye]);Ge=Ge&&xe.isOptional;let We,vt=!1;do{if(We=null,yt.implicitWs&&(We=this.parse(Ae,xe.name,je+1),!We)){let Pt;do if(Pt=this.parse(Ae,I,je+1),Pt)ot.text=ot.text+Pt.text,ot.end=ot.text.length,Pt.parent=ot,ot.children.push(Pt),Ae=Ae.substr(Pt.text.length),Ue+=Pt.text.length;else break;while(Pt&&Pt.text.length)}if(We=We||this.parse(Ae,xe.name,je+1),xe.lookupNegative){if(We)return;break}if(xe.lookupPositive&&!We)return;if(!We&&(xe.isOptional||xe.atLeastOne&&vt))break;if(We&&yt.pinned==ye+1&&(ze=We,Ye&&console.log(new Array(je+1).join("\u2502  ")+"\u2514\u2500 "+We.type+" PINNED")),We||(We=this.parseRecovery(yt,Ae,je+1)),!We)if(ze)Ze=ot,We={type:"SyntaxError",text:Ae,children:[],end:Ae.length,errors:[],fullText:"",parent:null,start:0,rest:""},Ae.length?new se.TokenError(`Unexpected end of input. Expecting ${xe.name} Got: ${Ae}`,We):new se.TokenError(`Unexpected end of input. Missing ${xe.name}`,We),Ye&&console.log(new Array(je+1).join("\u2502  ")+"\u2514\u2500 "+We.type+" "+JSON.stringify(We.text));else return;if(vt=!0,lt=!0,We.type=="%%EMPTY%%")break;We.start+=Ue,We.end+=Ue,!xe.lookupPositive&&We.type&&(We.fragment?We.children&&We.children.forEach(Pt=>{Pt.start+=Ue,Pt.end+=Ue,Pt.parent=ot,ot.children.push(Pt)}):(We.parent=ot,ot.children.push(We))),xe.lookup&&(We.lookup=!0),Ye&&console.log(new Array(je+1).join("\u2502  ")+"\u2514\u2500 "+We.type+" "+JSON.stringify(We.text)),!xe.lookup&&!We.lookup&&(ot.text=ot.text+We.text,ot.end=ot.text.length,Ae=Ae.substr(We.text.length),Ue+=We.text.length),ot.rest=Ae}while(We&&xe.allowRepetition&&Ae.length&&!We.lookup)}else{let xe=Ne(Ae,Ie[ye]);if(!xe)return;Ye&&console.log(new Array(je+1).join("\u2502  ")+"\u2514> "+JSON.stringify(xe.text)+Ie[ye].source),lt=!0,xe.start+=Ue,xe.end+=Ue,ot.text=ot.text+xe.text,ot.end=ot.text.length,Ae=Ae.substr(xe.text.length),Ue+=xe.text.length,ot.rest=Ae}lt&&(Ze=ot,Ye&&console.log(new Array(je).join("\u2502  ")+"\u251C<\u2500\u2534< PUSHING "+Ze.type+" "+JSON.stringify(Ze.text)))}),Ze&&yt.simplifyWhenOneChildren&&Ze.children.length==1&&(Ze=Ze.children[0])}return Ze||Ye&&console.log(ge+" NOT RESOLVED FROM "+Me),Ze}parseRecovery(Me,ge,je){if(Me.recover&&ge.length){let Ze=this.debug;Ze&&console.log(new Array(je+1).join("\u2502  ")+"Trying to recover until token "+Me.recover+" from "+JSON.stringify(ge.split(`
`)[0]+ge.split(`
`)[1]));let Oe={type:"SyntaxError",text:"",children:[],end:0,errors:[],fullText:"",parent:null,start:0,rest:""},Xe;do if(Xe=this.parse(ge,Me.recover,je+1),Xe){new se.TokenError('Unexpected input: "'+Oe.text+`" Expecting: ${Me.name}`,Oe);break}else Oe.text=Oe.text+ge[0],Oe.end=Oe.text.length,ge=ge.substr(1);while(!Xe&&ge.length>0);if(Oe.text.length>0&&Xe)return Ze&&console.log(new Array(je+1).join("\u2502  ")+"Recovered text: "+JSON.stringify(Oe.text)),Oe}return null}}pt.Parser=It,pt.default=It},80707:function(Bn,pt){"use strict";Object.defineProperty(pt,"__esModule",{value:!0}),pt.TokenError=void 0;class z extends Error{constructor(ke,me){if(super(ke),this.message=ke,this.token=me,me&&me.errors)me.errors.push(this);else throw this}inspect(){return"SyntaxError: "+this.message}}pt.TokenError=z},1170:function(Bn,pt,z){Bn=z.nmd(Bn),function(v){"use strict";v.exports.is_uri=me,v.exports.is_http_uri=I,v.exports.is_https_uri=se,v.exports.is_web_uri=Ne,v.exports.isUri=me,v.exports.isHttpUri=I,v.exports.isHttpsUri=se,v.exports.isWebUri=Ne;var ke=function(De){var Tt=De.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return Tt};function me(De){if(De&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(De)&&!/%[^0-9a-f]/i.test(De)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(De)){var Tt=[],rt="",st="",He="",gt="",tt="",Je="";if(Tt=ke(De),rt=Tt[1],st=Tt[2],He=Tt[3],gt=Tt[4],tt=Tt[5],!!(rt&&rt.length&&He.length>=0)){if(st&&st.length){if(!(He.length===0||/^\//.test(He)))return}else if(/^\/\//.test(He))return;if(/^[a-z][a-z0-9\+\-\.]*$/.test(rt.toLowerCase()))return Je+=rt+":",st&&st.length&&(Je+="//"+st),Je+=He,gt&&gt.length&&(Je+="?"+gt),tt&&tt.length&&(Je+="#"+tt),Je}}}function I(De,Tt){if(me(De)){var rt=[],st="",He="",gt="",tt="",Je="",It="",ee="";if(rt=ke(De),st=rt[1],He=rt[2],gt=rt[3],Je=rt[4],It=rt[5],!!st){if(Tt){if(st.toLowerCase()!="https")return}else if(st.toLowerCase()!="http")return;if(He)return/:(\d+)$/.test(He)&&(tt=He.match(/:(\d+)$/)[0],He=He.replace(/:\d+$/,"")),ee+=st+":",ee+="//"+He,tt&&(ee+=tt),ee+=gt,Je&&Je.length&&(ee+="?"+Je),It&&It.length&&(ee+="#"+It),ee}}}function se(De){return I(De,!0)}function Ne(De){return I(De)||se(De)}}(Bn)},77120:function(Bn,pt,z){"use strict";z.d(pt,{Gn:function(){return xe},K0:function(){return lt},Qf:function(){return Yt},R_:function(){return Ln},SS:function(){return Ge},Um:function(){return S},c:function(){return Ae},e7:function(){return wt},il:function(){return Be},mi:function(){return Bt},n$:function(){return Zn},nF:function(){return zn},nY:function(){return G},qz:function(){return tt},y1:function(){return Ue}});var v=z(21649),ke=z(1727),me=z(65329),I=z(86253),se=z(37207),Ne;const De=new v.md;function Tt(B){return ke.r$.define({combine:B?b=>b.concat(B):void 0})}const rt=new v.md;class st{constructor(b,k,$=[],H=""){this.data=b,this.name=H,ke.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(ke.yy.prototype,"tree",{get(){return tt(this)}}),this.parser=k,this.extension=[le.of(this),ke.yy.languageData.of((te,oe,Re)=>{let Te=He(te,oe,Re),kt=Te.type.prop(De);if(!kt)return[];let Ot=te.facet(kt),cn=Te.type.prop(rt);if(cn){let Yn=Te.resolve(oe-Te.from,Re);for(let Qn of cn)if(Qn.test(Yn,te)){let vr=te.facet(Qn.facet);return Qn.type=="replace"?vr:vr.concat(Ot)}}return Ot})].concat($)}isActiveAt(b,k,$=-1){return He(b,k,$).type.prop(De)==this.data}findRegions(b){let k=b.facet(le);if((k==null?void 0:k.data)==this.data)return[{from:0,to:b.doc.length}];if(!k||!k.allowsNesting)return[];let $=[],H=(te,oe)=>{if(te.prop(De)==this.data){$.push({from:oe,to:oe+te.length});return}let Re=te.prop(v.md.mounted);if(Re){if(Re.tree.prop(De)==this.data){if(Re.overlay)for(let Te of Re.overlay)$.push({from:Te.from+oe,to:Te.to+oe});else $.push({from:oe,to:oe+te.length});return}else if(Re.overlay){let Te=$.length;if(H(Re.tree,Re.overlay[0].from+oe),$.length>Te)return}}for(let Te=0;Te<te.children.length;Te++){let kt=te.children[Te];kt instanceof v.mp&&H(kt,te.positions[Te]+oe)}};return H(tt(b),0),$}get allowsNesting(){return!0}}st.setState=ke.Py.define();function He(B,b,k){let $=B.facet(le),H=tt(B).topNode;if(!$||$.allowsNesting)for(let te=H;te;te=te.enter(b,k,v.vj.ExcludeBuffers))te.type.isTop&&(H=te);return H}class gt extends null{constructor(b,k,$){super(b,k,[],$),this.parser=k}static define(b){let k=Tt(b.languageData);return new gt(k,b.parser.configure({props:[De.add($=>$.isTop?k:void 0)]}),b.name)}configure(b,k){return new gt(this.data,this.parser.configure(b),k||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function tt(B){let b=B.field(st.state,!1);return b?b.tree:v.mp.empty}function Je(B,b,k=50){var $;let H=($=B.field(st.state,!1))===null||$===void 0?void 0:$.context;if(!H)return null;let te=H.viewport;H.updateViewport({from:0,to:b});let oe=H.isDone(b)||H.work(k,b)?H.tree:null;return H.updateViewport(te),oe}function It(B,b=B.doc.length){var k;return((k=B.field(st.state,!1))===null||k===void 0?void 0:k.context.isDone(b))||!1}function ee(B,b=B.viewport.to,k=100){let $=Je(B.state,b,k);return $!=tt(B.state)&&B.dispatch({}),!!$}function Me(B){var b;return((b=B.plugin(yt))===null||b===void 0?void 0:b.isWorking())||!1}class ge{constructor(b){this.doc=b,this.cursorPos=0,this.string="",this.cursor=b.iter()}get length(){return this.doc.length}syncTo(b){return this.string=this.cursor.next(b-this.cursorPos).value,this.cursorPos=b+this.string.length,this.cursorPos-this.string.length}chunk(b){return this.syncTo(b),this.string}get lineChunks(){return!0}read(b,k){let $=this.cursorPos-this.string.length;return b<$||k>=this.cursorPos?this.doc.sliceString(b,k):this.string.slice(b-$,k-$)}}let je=null;class Ze{constructor(b,k,$=[],H,te,oe,Re,Te){this.parser=b,this.state=k,this.fragments=$,this.tree=H,this.treeLen=te,this.viewport=oe,this.skipped=Re,this.scheduleOn=Te,this.parse=null,this.tempSkipped=[]}static create(b,k,$){return new Ze(b,k,[],v.mp.empty,0,$,[],null)}startParse(){return this.parser.startParse(new ge(this.state.doc),this.fragments)}work(b,k){return k!=null&&k>=this.state.doc.length&&(k=void 0),this.tree!=v.mp.empty&&this.isDone(k!=null?k:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var $;if(typeof b=="number"){let H=Date.now()+b;b=()=>Date.now()>H}for(this.parse||(this.parse=this.startParse()),k!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>k)&&k<this.state.doc.length&&this.parse.stopAt(k);;){let H=this.parse.advance();if(H)if(this.fragments=this.withoutTempSkipped(v.i9.addTree(H,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=($=this.parse.stoppedAt)!==null&&$!==void 0?$:this.state.doc.length,this.tree=H,this.parse=null,this.treeLen<(k!=null?k:this.state.doc.length))this.parse=this.startParse();else return!0;if(b())return!1}})}takeTree(){let b,k;this.parse&&(b=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>b)&&this.parse.stopAt(b),this.withContext(()=>{for(;!(k=this.parse.advance()););}),this.treeLen=b,this.tree=k,this.fragments=this.withoutTempSkipped(v.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(b){let k=je;je=this;try{return b()}finally{je=k}}withoutTempSkipped(b){for(let k;k=this.tempSkipped.pop();)b=Oe(b,k.from,k.to);return b}changes(b,k){let{fragments:$,tree:H,treeLen:te,viewport:oe,skipped:Re}=this;if(this.takeTree(),!b.empty){let Te=[];if(b.iterChangedRanges((kt,Ot,cn,Yn)=>Te.push({fromA:kt,toA:Ot,fromB:cn,toB:Yn})),$=v.i9.applyChanges($,Te),H=v.mp.empty,te=0,oe={from:b.mapPos(oe.from,-1),to:b.mapPos(oe.to,1)},this.skipped.length){Re=[];for(let kt of this.skipped){let Ot=b.mapPos(kt.from,1),cn=b.mapPos(kt.to,-1);Ot<cn&&Re.push({from:Ot,to:cn})}}}return new Ze(this.parser,k,$,H,te,oe,Re,this.scheduleOn)}updateViewport(b){if(this.viewport.from==b.from&&this.viewport.to==b.to)return!1;this.viewport=b;let k=this.skipped.length;for(let $=0;$<this.skipped.length;$++){let{from:H,to:te}=this.skipped[$];H<b.to&&te>b.from&&(this.fragments=Oe(this.fragments,H,te),this.skipped.splice($--,1))}return this.skipped.length>=k?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(b,k){this.skipped.push({from:b,to:k})}static getSkippingParser(b){return new class extends v._b{createParse(k,$,H){let te=H[0].from,oe=H[H.length-1].to;return{parsedPos:te,advance(){let Te=je;if(Te){for(let kt of H)Te.tempSkipped.push(kt);b&&(Te.scheduleOn=Te.scheduleOn?Promise.all([Te.scheduleOn,b]):b)}return this.parsedPos=oe,new v.mp(v.Jq.none,[],[],oe-te)},stoppedAt:null,stopAt(){}}}}}isDone(b){b=Math.min(b,this.state.doc.length);let k=this.fragments;return this.treeLen>=b&&k.length&&k[0].from==0&&k[0].to>=b}static get(){return je}}function Oe(B,b,k){return v.i9.applyChanges(B,[{fromA:b,toA:k,fromB:b,toB:k}])}class Xe{constructor(b){this.context=b,this.tree=b.tree}apply(b){if(!b.docChanged&&this.tree==this.context.tree)return this;let k=this.context.changes(b.changes,b.state),$=this.context.treeLen==b.startState.doc.length?void 0:Math.max(b.changes.mapPos(this.context.treeLen),k.viewport.to);return k.work(20,$)||k.takeTree(),new Xe(k)}static init(b){let k=Math.min(3e3,b.doc.length),$=Ze.create(b.facet(le).parser,b,{from:0,to:k});return $.work(20,k)||$.takeTree(),new Xe($)}}st.state=ke.QQ.define({create:Xe.init,update(B,b){for(let k of b.effects)if(k.is(st.setState))return k.value;return b.startState.facet(le)!=b.state.facet(le)?Xe.init(b.state):B.apply(b)}});let Ye=B=>{let b=setTimeout(()=>B(),500);return()=>clearTimeout(b)};typeof requestIdleCallback!="undefined"&&(Ye=B=>{let b=-1,k=setTimeout(()=>{b=requestIdleCallback(B,{timeout:500-100})},100);return()=>b<0?clearTimeout(k):cancelIdleCallback(b)});const K=typeof navigator!="undefined"&&(!((Ne=navigator.scheduling)===null||Ne===void 0)&&Ne.isInputPending)?()=>navigator.scheduling.isInputPending():null,yt=me.lg.fromClass(class{constructor(b){this.view=b,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(b){let k=this.view.state.field(st.state).context;(k.updateViewport(b.view.viewport)||this.view.viewport.to>k.treeLen)&&this.scheduleWork(),b.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(k)}scheduleWork(){if(this.working)return;let{state:b}=this.view,k=b.field(st.state);(k.tree!=k.context.tree||!k.context.isDone(b.doc.length))&&(this.working=Ye(this.work))}work(b){this.working=null;let k=Date.now();if(this.chunkEnd<k&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=k+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:$,viewport:{to:H}}=this.view,te=$.field(st.state);if(te.tree==te.context.tree&&te.context.isDone(H+1e5))return;let oe=Date.now()+Math.min(this.chunkBudget,100,b&&!K?Math.max(25,b.timeRemaining()-5):1e9),Re=te.context.treeLen<H&&$.doc.length>H+1e3,Te=te.context.work(()=>K&&K()||Date.now()>oe,H+(Re?0:1e5));this.chunkBudget-=Date.now()-k,(Te||this.chunkBudget<=0)&&(te.context.takeTree(),this.view.dispatch({effects:st.setState.of(new Xe(te.context))})),this.chunkBudget>0&&!(Te&&!Re)&&this.scheduleWork(),this.checkAsyncSchedule(te.context)}checkAsyncSchedule(b){b.scheduleOn&&(this.workScheduled++,b.scheduleOn.then(()=>this.scheduleWork()).catch(k=>(0,me.OO)(this.view.state,k)).then(()=>this.workScheduled--),b.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),le=ke.r$.define({combine(B){return B.length?B[0]:null},enables:B=>[st.state,yt,me.tk.contentAttributes.compute([B],b=>{let k=b.facet(B);return k&&k.name?{"data-language":k.name}:{}})]});class Ie{constructor(b,k=[]){this.language=b,this.support=k,this.extension=[b,k]}}class ze{constructor(b,k,$,H,te,oe=void 0){this.name=b,this.alias=k,this.extensions=$,this.filename=H,this.loadFunc=te,this.support=oe,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(b=>this.support=b,b=>{throw this.loading=null,b}))}static of(b){let{load:k,support:$}=b;if(!k){if(!$)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");k=()=>Promise.resolve($)}return new ze(b.name,(b.alias||[]).concat(b.name).map(H=>H.toLowerCase()),b.extensions||[],b.filename,k,$)}static matchFilename(b,k){for(let H of b)if(H.filename&&H.filename.test(k))return H;let $=/\.([^.]+)$/.exec(k);if($){for(let H of b)if(H.extensions.indexOf($[1])>-1)return H}return null}static matchLanguageName(b,k,$=!0){k=k.toLowerCase();for(let H of b)if(H.alias.some(te=>te==k))return H;if($)for(let H of b)for(let te of H.alias){let oe=k.indexOf(te);if(oe>-1&&(te.length>2||!/\w/.test(k[oe-1])&&!/\w/.test(k[oe+te.length])))return H}return null}}const ot=ke.r$.define(),Ae=ke.r$.define({combine:B=>{if(!B.length)return"  ";let b=B[0];if(!b||/\S/.test(b)||Array.from(b).some(k=>k!=b[0]))throw new Error("Invalid indent unit: "+JSON.stringify(B[0]));return b}});function Ue(B){let b=B.facet(Ae);return b.charCodeAt(0)==9?B.tabSize*b.length:b.length}function Ge(B,b){let k="",$=B.tabSize,H=B.facet(Ae)[0];if(H=="	"){for(;b>=$;)k+="	",b-=$;H=" "}for(let te=0;te<b;te++)k+=H;return k}function lt(B,b){B instanceof ke.yy&&(B=new xe(B));for(let $ of B.state.facet(ot)){let H=$(B,b);if(H!==void 0)return H}let k=tt(B.state);return k?vt(B,k,b):null}function ye(B,b,k){let $=Object.create(null),H=new xe(B,{overrideIndentation:oe=>{var Re;return(Re=$[oe])!==null&&Re!==void 0?Re:-1}}),te=[];for(let oe=b;oe<=k;){let Re=B.doc.lineAt(oe);oe=Re.to+1;let Te=lt(H,Re.from);if(Te==null)continue;/\S/.test(Re.text)||(Te=0);let kt=/^\s*/.exec(Re.text)[0],Ot=Ge(B,Te);kt!=Ot&&($[Re.from]=Te,te.push({from:Re.from,to:Re.from+kt.length,insert:Ot}))}return B.changes(te)}class xe{constructor(b,k={}){this.state=b,this.options=k,this.unit=Ue(b)}lineAt(b,k=1){let $=this.state.doc.lineAt(b),{simulateBreak:H,simulateDoubleBreak:te}=this.options;return H!=null&&H>=$.from&&H<=$.to?te&&H==b?{text:"",from:b}:(k<0?H<b:H<=b)?{text:$.text.slice(H-$.from),from:H}:{text:$.text.slice(0,H-$.from),from:$.from}:$}textAfterPos(b,k=1){if(this.options.simulateDoubleBreak&&b==this.options.simulateBreak)return"";let{text:$,from:H}=this.lineAt(b,k);return $.slice(b-H,Math.min($.length,b+100-H))}column(b,k=1){let{text:$,from:H}=this.lineAt(b,k),te=this.countColumn($,b-H),oe=this.options.overrideIndentation?this.options.overrideIndentation(H):-1;return oe>-1&&(te+=oe-this.countColumn($,$.search(/\S|$/))),te}countColumn(b,k=b.length){return(0,ke.IS)(b,this.state.tabSize,k)}lineIndent(b,k=1){let{text:$,from:H}=this.lineAt(b,k),te=this.options.overrideIndentation;if(te){let oe=te(H);if(oe>-1)return oe}return this.countColumn($,$.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const We=new v.md;function vt(B,b,k){return Zt(b.resolveInner(k).enterUnfinishedNodesBefore(k),k,B)}function Pt(B){return B.pos==B.options.simulateBreak&&B.options.simulateDoubleBreak}function Wt(B){let b=B.type.prop(We);if(b)return b;let k=B.firstChild,$;if(k&&($=k.type.prop(v.md.closedBy))){let H=B.lastChild,te=H&&$.indexOf(H.name)>-1;return oe=>Ee(oe,!0,1,void 0,te&&!Pt(oe)?H.from:void 0)}return B.parent==null?In:null}function Zt(B,b,k){for(;B;B=B.parent){let $=Wt(B);if($)return $(xn.create(k,b,B))}return null}function In(){return 0}class xn extends xe{constructor(b,k,$){super(b.state,b.options),this.base=b,this.pos=k,this.node=$}static create(b,k,$){return new xn(b,k,$)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(b){let k=this.state.doc.lineAt(b.from);for(;;){let $=b.resolve(k.from);for(;$.parent&&$.parent.from==$.from;)$=$.parent;if(er($,b))break;k=this.state.doc.lineAt($.from)}return this.lineIndent(k.from)}continue(){let b=this.node.parent;return b?Zt(b,this.pos,this.base):0}}function er(B,b){for(let k=b;k;k=k.parent)if(B==k)return!0;return!1}function Lt(B){let b=B.node,k=b.childAfter(b.from),$=b.lastChild;if(!k)return null;let H=B.options.simulateBreak,te=B.state.doc.lineAt(k.from),oe=H==null||H<=te.from?te.to:Math.min(te.to,H);for(let Re=k.to;;){let Te=b.childAfter(Re);if(!Te||Te==$)return null;if(!Te.type.isSkipped)return Te.from<oe?k:null;Re=Te.to}}function rn({closing:B,align:b=!0,units:k=1}){return $=>Ee($,b,k,B)}function Ee(B,b,k,$,H){let te=B.textAfter,oe=te.match(/^\s*/)[0].length,Re=$&&te.slice(oe,oe+$.length)==$||H==B.pos+oe,Te=b?Lt(B):null;return Te?Re?B.column(Te.from):B.column(Te.to):B.baseIndent+(Re?0:B.unit*k)}const O=B=>B.baseIndent;function N({except:B,units:b=1}={}){return k=>{let $=B&&B.test(k.textAfter);return k.baseIndent+($?0:b*k.unit)}}const W=200;function G(){return ke.yy.transactionFilter.of(B=>{if(!B.docChanged||!B.isUserEvent("input.type")&&!B.isUserEvent("input.complete"))return B;let b=B.startState.languageDataAt("indentOnInput",B.startState.selection.main.head);if(!b.length)return B;let k=B.newDoc,{head:$}=B.newSelection.main,H=k.lineAt($);if($>H.from+W)return B;let te=k.sliceString(H.from,$);if(!b.some(kt=>kt.test(te)))return B;let{state:oe}=B,Re=-1,Te=[];for(let{head:kt}of oe.selection.ranges){let Ot=oe.doc.lineAt(kt);if(Ot.from==Re)continue;Re=Ot.from;let cn=lt(oe,Ot.from);if(cn==null)continue;let Yn=/^\s*/.exec(Ot.text)[0],Qn=Ge(oe,cn);Yn!=Qn&&Te.push({from:Ot.from,to:Ot.from+Yn.length,insert:Qn})}return Te.length?[B,{changes:Te,sequential:!0}]:B})}const ne=ke.r$.define(),pe=new v.md;function Se(B){let b=B.firstChild,k=B.lastChild;return b&&b.to<k.from?{from:b.to,to:k.type.isError?B.to:k.from}:null}function $e(B,b,k){let $=tt(B);if($.length<k)return null;let H=$.resolveInner(k,1),te=null;for(let oe=H;oe;oe=oe.parent){if(oe.to<=k||oe.from>k)continue;if(te&&oe.from<b)break;let Re=oe.type.prop(pe);if(Re&&(oe.to<$.length-50||$.length==B.doc.length||!ve(oe))){let Te=Re(oe,B);Te&&Te.from<=k&&Te.from>=b&&Te.to>k&&(te=Te)}}return te}function ve(B){let b=B.lastChild;return b&&b.to==B.to&&b.type.isError}function ut(B,b,k){for(let $ of B.facet(ne)){let H=$(B,b,k);if(H)return H}return $e(B,b,k)}function St(B,b){let k=b.mapPos(B.from,1),$=b.mapPos(B.to,-1);return k>=$?void 0:{from:k,to:$}}const at=ke.Py.define({map:St}),zt=ke.Py.define({map:St});function Ft(B){let b=[];for(let{head:k}of B.state.selection.ranges)b.some($=>$.from<=k&&$.to>=k)||b.push(B.lineBlockAt(k));return b}const Qt=ke.QQ.define({create(){return me.p.none},update(B,b){B=B.map(b.changes);for(let k of b.effects)k.is(at)&&!or(B,k.value.from,k.value.to)?B=B.update({add:[Hn.range(k.value.from,k.value.to)]}):k.is(zt)&&(B=B.update({filter:($,H)=>k.value.from!=$||k.value.to!=H,filterFrom:k.value.from,filterTo:k.value.to}));if(b.selection){let k=!1,{head:$}=b.selection.main;B.between($,$,(H,te)=>{H<$&&te>$&&(k=!0)}),k&&(B=B.update({filterFrom:$,filterTo:$,filter:(H,te)=>te<=$||H>=$}))}return B},provide:B=>me.tk.decorations.from(B),toJSON(B,b){let k=[];return B.between(0,b.doc.length,($,H)=>{k.push($,H)}),k},fromJSON(B){if(!Array.isArray(B)||B.length%2)throw new RangeError("Invalid JSON for fold state");let b=[];for(let k=0;k<B.length;){let $=B[k++],H=B[k++];if(typeof $!="number"||typeof H!="number")throw new RangeError("Invalid JSON for fold state");b.push(Hn.range($,H))}return me.p.set(b,!0)}});function Jn(B){return B.field(Qt,!1)||RangeSet.empty}function En(B,b,k){var $;let H=null;return($=B.field(Qt,!1))===null||$===void 0||$.between(b,k,(te,oe)=>{(!H||H.from>te)&&(H={from:te,to:oe})}),H}function or(B,b,k){let $=!1;return B.between(b,b,(H,te)=>{H==b&&te==k&&($=!0)}),$}function Gt(B,b){return B.field(Qt,!1)?b:b.concat(ke.Py.appendConfig.of(Vn()))}const Mt=B=>{for(let b of Ft(B)){let k=ut(B.state,b.from,b.to);if(k)return B.dispatch({effects:Gt(B.state,[at.of(k),Ct(B,k)])}),!0}return!1},yn=B=>{if(!B.state.field(Qt,!1))return!1;let b=[];for(let k of Ft(B)){let $=En(B.state,k.from,k.to);$&&b.push(zt.of($),Ct(B,$,!1))}return b.length&&B.dispatch({effects:b}),b.length>0};function Ct(B,b,k=!0){let $=B.state.doc.lineAt(b.from).number,H=B.state.doc.lineAt(b.to).number;return me.tk.announce.of(`${B.state.phrase(k?"Folded lines":"Unfolded lines")} ${$} ${B.state.phrase("to")} ${H}.`)}const Kt=B=>{let{state:b}=B,k=[];for(let $=0;$<b.doc.length;){let H=B.lineBlockAt($),te=ut(b,H.from,H.to);te&&k.push(at.of(te)),$=(te?B.lineBlockAt(te.to):H).to+1}return k.length&&B.dispatch({effects:Gt(B.state,k)}),!!k.length},Xt=B=>{let b=B.state.field(Qt,!1);if(!b||!b.size)return!1;let k=[];return b.between(0,B.state.doc.length,($,H)=>{k.push(zt.of({from:$,to:H}))}),B.dispatch({effects:k}),!0};function Jt(B,b){for(let k=b;;){let $=ut(B.state,k.from,k.to);if($&&$.to>b.from)return $;if(!k.from)return null;k=B.lineBlockAt(k.from-1)}}const bt=B=>{let b=[];for(let k of Ft(B)){let $=En(B.state,k.from,k.to);if($)b.push(zt.of($),Ct(B,$,!1));else{let H=Jt(B,k);H&&b.push(at.of(H),Ct(B,H))}}return b.length>0&&B.dispatch({effects:Gt(B.state,b)}),!!b.length},wt=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Mt},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:yn},{key:"Ctrl-Alt-[",run:Kt},{key:"Ctrl-Alt-]",run:Xt}],an={placeholderDOM:null,placeholderText:"\u2026"},hn=ke.r$.define({combine(B){return(0,ke.BO)(B,an)}});function Vn(B){let b=[Qt,Pn];return B&&b.push(hn.of(B)),b}const Hn=me.p.replace({widget:new class extends me.l9{toDOM(B){let{state:b}=B,k=b.facet(hn),$=te=>{let oe=B.lineBlockAt(B.posAtDOM(te.target)),Re=En(B.state,oe.from,oe.to);Re&&B.dispatch({effects:zt.of(Re)}),te.preventDefault()};if(k.placeholderDOM)return k.placeholderDOM(B,$);let H=document.createElement("span");return H.textContent=k.placeholderText,H.setAttribute("aria-label",b.phrase("folded code")),H.title=b.phrase("unfold"),H.className="cm-foldPlaceholder",H.onclick=$,H}}}),cr={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class wr extends me.SJ{constructor(b,k){super(),this.config=b,this.open=k}eq(b){return this.config==b.config&&this.open==b.open}toDOM(b){if(this.config.markerDOM)return this.config.markerDOM(this.open);let k=document.createElement("span");return k.textContent=this.open?this.config.openText:this.config.closedText,k.title=b.state.phrase(this.open?"Fold line":"Unfold line"),k}}function Bt(B={}){let b=Object.assign(Object.assign({},cr),B),k=new wr(b,!0),$=new wr(b,!1),H=me.lg.fromClass(class{constructor(oe){this.from=oe.viewport.from,this.markers=this.buildMarkers(oe)}update(oe){(oe.docChanged||oe.viewportChanged||oe.startState.facet(le)!=oe.state.facet(le)||oe.startState.field(Qt,!1)!=oe.state.field(Qt,!1)||tt(oe.startState)!=tt(oe.state)||b.foldingChanged(oe))&&(this.markers=this.buildMarkers(oe.view))}buildMarkers(oe){let Re=new ke.f_;for(let Te of oe.viewportLineBlocks){let kt=En(oe.state,Te.from,Te.to)?$:ut(oe.state,Te.from,Te.to)?k:null;kt&&Re.add(Te.from,Te.from,kt)}return Re.finish()}}),{domEventHandlers:te}=b;return[H,(0,me.v5)({class:"cm-foldGutter",markers(oe){var Re;return((Re=oe.plugin(H))===null||Re===void 0?void 0:Re.markers)||ke.Xs.empty},initialSpacer(){return new wr(b,!1)},domEventHandlers:Object.assign(Object.assign({},te),{click:(oe,Re,Te)=>{if(te.click&&te.click(oe,Re,Te))return!0;let kt=En(oe.state,Re.from,Re.to);if(kt)return oe.dispatch({effects:zt.of(kt)}),!0;let Ot=ut(oe.state,Re.from,Re.to);return Ot?(oe.dispatch({effects:at.of(Ot)}),!0):!1}})}),Vn()]}const Pn=me.tk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Yt{constructor(b,k){this.specs=b;let $;function H(Re){let Te=se.V.newName();return($||($=Object.create(null)))["."+Te]=Re,Te}const te=typeof k.all=="string"?k.all:k.all?H(k.all):void 0,oe=k.scope;this.scope=oe instanceof st?Re=>Re.prop(De)==oe.data:oe?Re=>Re==oe:void 0,this.style=(0,I.QR)(b.map(Re=>({tag:Re.tag,class:Re.class||H(Object.assign({},Re,{tag:null}))})),{all:te}).style,this.module=$?new se.V($):null,this.themeType=k.themeType}static define(b,k){return new Yt(b,k||{})}}const un=ke.r$.define(),Xn=ke.r$.define({combine(B){return B.length?[B[0]]:null}});function fr(B){let b=B.facet(un);return b.length?b:B.facet(Xn)}function zn(B,b){let k=[ri],$;return B instanceof Yt&&(B.module&&k.push(me.tk.styleModule.of(B.module)),$=B.themeType),b!=null&&b.fallback?k.push(Xn.of(B)):$?k.push(un.computeN([me.tk.darkTheme],H=>H.facet(me.tk.darkTheme)==($=="dark")?[B]:[])):k.push(un.of(B)),k}function Hi(B,b,k){let $=fr(B),H=null;if($){for(let te of $)if(!te.scope||k&&te.scope(k)){let oe=te.style(b);oe&&(H=H?H+" "+oe:oe)}}return H}class $r{constructor(b){this.markCache=Object.create(null),this.tree=tt(b.state),this.decorations=this.buildDeco(b,fr(b.state))}update(b){let k=tt(b.state),$=fr(b.state),H=$!=fr(b.startState);k.length<b.view.viewport.to&&!H&&k.type==this.tree.type?this.decorations=this.decorations.map(b.changes):(k!=this.tree||b.viewportChanged||H)&&(this.tree=k,this.decorations=this.buildDeco(b.view,$))}buildDeco(b,k){if(!k||!this.tree.length)return me.p.none;let $=new ke.f_;for(let{from:H,to:te}of b.visibleRanges)(0,I.bW)(this.tree,k,(oe,Re,Te)=>{$.add(oe,Re,this.markCache[Te]||(this.markCache[Te]=me.p.mark({class:Te})))},H,te);return $.finish()}}const ri=ke.Wl.high(me.lg.fromClass($r,{decorations:B=>B.decorations})),Ln=Yt.define([{tag:I.pJ.meta,color:"#404740"},{tag:I.pJ.link,textDecoration:"underline"},{tag:I.pJ.heading,textDecoration:"underline",fontWeight:"bold"},{tag:I.pJ.emphasis,fontStyle:"italic"},{tag:I.pJ.strong,fontWeight:"bold"},{tag:I.pJ.strikethrough,textDecoration:"line-through"},{tag:I.pJ.keyword,color:"#708"},{tag:[I.pJ.atom,I.pJ.bool,I.pJ.url,I.pJ.contentSeparator,I.pJ.labelName],color:"#219"},{tag:[I.pJ.literal,I.pJ.inserted],color:"#164"},{tag:[I.pJ.string,I.pJ.deleted],color:"#a11"},{tag:[I.pJ.regexp,I.pJ.escape,I.pJ.special(I.pJ.string)],color:"#e40"},{tag:I.pJ.definition(I.pJ.variableName),color:"#00f"},{tag:I.pJ.local(I.pJ.variableName),color:"#30a"},{tag:[I.pJ.typeName,I.pJ.namespace],color:"#085"},{tag:I.pJ.className,color:"#167"},{tag:[I.pJ.special(I.pJ.variableName),I.pJ.macroName],color:"#256"},{tag:I.pJ.definition(I.pJ.propertyName),color:"#00c"},{tag:I.pJ.comment,color:"#940"},{tag:I.pJ.invalid,color:"#f00"}]),gr=me.tk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),ai=1e4,Dn="()[]{}",yr=ke.r$.define({combine(B){return(0,ke.BO)(B,{afterCursor:!0,brackets:Dn,maxScanDistance:ai,renderMatch:tr})}}),Gr=me.p.mark({class:"cm-matchingBracket"}),kn=me.p.mark({class:"cm-nonmatchingBracket"});function tr(B){let b=[],k=B.matched?Gr:kn;return b.push(k.range(B.start.from,B.start.to)),B.end&&b.push(k.range(B.end.from,B.end.to)),b}const Cr=[ke.QQ.define({create(){return me.p.none},update(B,b){if(!b.docChanged&&!b.selection)return B;let k=[],$=b.state.facet(yr);for(let H of b.state.selection.ranges){if(!H.empty)continue;let te=S(b.state,H.head,-1,$)||H.head>0&&S(b.state,H.head-1,1,$)||$.afterCursor&&(S(b.state,H.head,1,$)||H.head<b.state.doc.length&&S(b.state,H.head+1,-1,$));te&&(k=k.concat($.renderMatch(te,b.state)))}return me.p.set(k,!0)},provide:B=>me.tk.decorations.from(B)}),gr];function Zn(B={}){return[yr.of(B),Cr]}const j=new v.md;function f(B,b,k){let $=B.prop(b<0?v.md.openedBy:v.md.closedBy);if($)return $;if(B.name.length==1){let H=k.indexOf(B.name);if(H>-1&&H%2==(b<0?1:0))return[k[H+b]]}return null}function g(B){let b=B.type.prop(j);return b?b(B.node):B}function S(B,b,k,$={}){let H=$.maxScanDistance||ai,te=$.brackets||Dn,oe=tt(B),Re=oe.resolveInner(b,k);for(let Te=Re;Te;Te=Te.parent){let kt=f(Te.type,k,te);if(kt&&Te.from<Te.to){let Ot=g(Te);if(Ot&&(k>0?b>=Ot.from&&b<Ot.to:b>Ot.from&&b<=Ot.to))return C(B,b,k,Te,Ot,kt,te)}}return P(B,b,k,oe,Re.type,H,te)}function C(B,b,k,$,H,te,oe){let Re=$.parent,Te={from:H.from,to:H.to},kt=0,Ot=Re==null?void 0:Re.cursor();if(Ot&&(k<0?Ot.childBefore($.from):Ot.childAfter($.to)))do if(k<0?Ot.to<=$.from:Ot.from>=$.to){if(kt==0&&te.indexOf(Ot.type.name)>-1&&Ot.from<Ot.to){let cn=g(Ot);return{start:Te,end:cn?{from:cn.from,to:cn.to}:void 0,matched:!0}}else if(f(Ot.type,k,oe))kt++;else if(f(Ot.type,-k,oe)){if(kt==0){let cn=g(Ot);return{start:Te,end:cn&&cn.from<cn.to?{from:cn.from,to:cn.to}:void 0,matched:!1}}kt--}}while(k<0?Ot.prevSibling():Ot.nextSibling());return{start:Te,matched:!1}}function P(B,b,k,$,H,te,oe){let Re=k<0?B.sliceDoc(b-1,b):B.sliceDoc(b,b+1),Te=oe.indexOf(Re);if(Te<0||Te%2==0!=k>0)return null;let kt={from:k<0?b-1:b,to:k>0?b+1:b},Ot=B.doc.iterRange(b,k>0?B.doc.length:0),cn=0;for(let Yn=0;!Ot.next().done&&Yn<=te;){let Qn=Ot.value;k<0&&(Yn+=Qn.length);let vr=b+Yn*k;for(let Un=k>0?0:Qn.length-1,xi=k>0?Qn.length:-1;Un!=xi;Un+=k){let Si=oe.indexOf(Qn[Un]);if(!(Si<0||$.resolveInner(vr+Un,1).type!=H))if(Si%2==0==k>0)cn++;else{if(cn==1)return{start:kt,end:{from:vr+Un,to:vr+Un+1},matched:Si>>1==Te>>1};cn--}}k>0&&(Yn+=Qn.length)}return Ot.done?{start:kt,matched:!1}:null}function M(B,b,k,$=0,H=0){b==null&&(b=B.search(/[^\s\u00a0]/),b==-1&&(b=B.length));let te=H;for(let oe=$;oe<b;oe++)B.charCodeAt(oe)==9?te+=k-te%k:te++;return te}class Z{constructor(b,k,$,H){this.string=b,this.tabSize=k,this.indentUnit=$,this.overrideIndent=H,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(b){let k=this.string.charAt(this.pos),$;if(typeof b=="string"?$=k==b:$=k&&(b instanceof RegExp?b.test(k):b(k)),$)return++this.pos,k}eatWhile(b){let k=this.pos;for(;this.eat(b););return this.pos>k}eatSpace(){let b=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>b}skipToEnd(){this.pos=this.string.length}skipTo(b){let k=this.string.indexOf(b,this.pos);if(k>-1)return this.pos=k,!0}backUp(b){this.pos-=b}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=M(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var b;return(b=this.overrideIndent)!==null&&b!==void 0?b:M(this.string,null,this.tabSize)}match(b,k,$){if(typeof b=="string"){let H=oe=>$?oe.toLowerCase():oe,te=this.string.substr(this.pos,b.length);return H(te)==H(b)?(k!==!1&&(this.pos+=b.length),!0):null}else{let H=this.string.slice(this.pos).match(b);return H&&H.index>0?null:(H&&k!==!1&&(this.pos+=H[0].length),H)}}current(){return this.string.slice(this.start,this.pos)}}function U(B){return{name:B.name||"",token:B.token,blankLine:B.blankLine||(()=>{}),startState:B.startState||(()=>!0),copyState:B.copyState||he,indent:B.indent||(()=>null),languageData:B.languageData||{},tokenTable:B.tokenTable||Rn}}function he(B){if(typeof B!="object")return B;let b={};for(let k in B){let $=B[k];b[k]=$ instanceof Array?$.slice():$}return b}const ue=new WeakMap;class Be extends st{constructor(b){let k=Tt(b.languageData),$=U(b),H,te=new class extends v._b{createParse(oe,Re,Te){return new Gn(H,oe,Re,Te)}};super(k,te,[ot.of((oe,Re)=>this.getIndent(oe,Re))],b.name),this.topNode=_i(k),H=this,this.streamParser=$,this.stateAfter=new v.md({perNode:!0}),this.tokenTable=b.tokenTable?new Ri($.tokenTable):Ii}static define(b){return new Be(b)}getIndent(b,k){let $=tt(b.state),H=$.resolve(k);for(;H&&H.type!=this.topNode;)H=H.parent;if(!H)return null;let te,{overrideIndentation:oe}=b.options;oe&&(te=ue.get(b.state),te!=null&&te<k-1e4&&(te=void 0));let Re=ft(this,$,0,H.from,te!=null?te:k),Te,kt;if(Re?(kt=Re.state,Te=Re.pos+1):(kt=this.streamParser.startState(b.unit),Te=0),k-Te>1e4)return null;for(;Te<k;){let cn=b.state.doc.lineAt(Te),Yn=Math.min(k,cn.to);if(cn.length){let Qn=oe?oe(cn.from):-1,vr=new Z(cn.text,b.state.tabSize,b.unit,Qn<0?void 0:Qn);for(;vr.pos<Yn-cn.from;)sn(this.streamParser.token,vr,kt)}else this.streamParser.blankLine(kt,b.unit);if(Yn==k)break;Te=cn.to+1}let Ot=b.lineAt(k);return oe&&te==null&&ue.set(b.state,Ot.from),this.streamParser.indent(kt,/^\s*(.*)/.exec(Ot.text)[1],b)}get allowsNesting(){return!1}}function ft(B,b,k,$,H){let te=k>=$&&k+b.length<=H&&b.prop(B.stateAfter);if(te)return{state:B.streamParser.copyState(te),pos:k+b.length};for(let oe=b.children.length-1;oe>=0;oe--){let Re=b.children[oe],Te=k+b.positions[oe],kt=Re instanceof v.mp&&Te<H&&ft(B,Re,Te,$,H);if(kt)return kt}return null}function _e(B,b,k,$,H){if(H&&k<=0&&$>=b.length)return b;!H&&b.type==B.topNode&&(H=!0);for(let te=b.children.length-1;te>=0;te--){let oe=b.positions[te],Re=b.children[te],Te;if(oe<$&&Re instanceof v.mp){if(!(Te=_e(B,Re,k-oe,$-oe,H)))break;return H?new v.mp(b.type,b.children.slice(0,te).concat(Te),b.positions.slice(0,te+1),oe+Te.length):Te}}return null}function on(B,b,k,$){for(let H of b){let te=H.from+(H.openStart?25:0),oe=H.to-(H.openEnd?25:0),Re=te<=k&&oe>k&&ft(B,H.tree,0-H.offset,k,oe),Te;if(Re&&(Te=_e(B,H.tree,k+H.offset,Re.pos+H.offset,!1)))return{state:Re.state,tree:Te}}return{state:B.streamParser.startState($?Ue($):4),tree:v.mp.empty}}class Gn{constructor(b,k,$,H){this.lang=b,this.input=k,this.fragments=$,this.ranges=H,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=H[H.length-1].to;let te=Ze.get(),oe=H[0].from,{state:Re,tree:Te}=on(b,$,oe,te==null?void 0:te.state);this.state=Re,this.parsedPos=this.chunkStart=oe+Te.length;for(let kt=0;kt<Te.children.length;kt++)this.chunks.push(Te.children[kt]),this.chunkPos.push(Te.positions[kt]);te&&this.parsedPos<te.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Ue(te.state)),te.skipUntilInView(this.parsedPos,te.viewport.from),this.parsedPos=te.viewport.from),this.moveRangeIndex()}advance(){let b=Ze.get(),k=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),$=Math.min(k,this.chunkStart+2048);for(b&&($=Math.min($,b.viewport.to));this.parsedPos<$;)this.parseLine(b);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=k?this.finish():b&&this.parsedPos>=b.viewport.to?(b.skipUntilInView(this.parsedPos,k),this.finish()):null}stopAt(b){this.stoppedAt=b}lineAfter(b){let k=this.input.chunk(b);if(this.input.lineChunks)k==`
`&&(k="");else{let $=k.indexOf(`
`);$>-1&&(k=k.slice(0,$))}return b+k.length<=this.to?k:k.slice(0,this.to-b)}nextLine(){let b=this.parsedPos,k=this.lineAfter(b),$=b+k.length;for(let H=this.rangeIndex;;){let te=this.ranges[H].to;if(te>=$||(k=k.slice(0,te-($-k.length)),H++,H==this.ranges.length))break;let oe=this.ranges[H].from,Re=this.lineAfter(oe);k+=Re,$=oe+Re.length}return{line:k,end:$}}skipGapsTo(b,k,$){for(;;){let H=this.ranges[this.rangeIndex].to,te=b+k;if($>0?H>te:H>=te)break;let oe=this.ranges[++this.rangeIndex].from;k+=oe-H}return k}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(b,k,$,H,te){if(this.ranges.length>1){te=this.skipGapsTo(k,te,1),k+=te;let oe=this.chunk.length;te=this.skipGapsTo($,te,-1),$+=te,H+=this.chunk.length-oe}return this.chunk.push(b,k,$,H),te}parseLine(b){let{line:k,end:$}=this.nextLine(),H=0,{streamParser:te}=this.lang,oe=new Z(k,b?b.state.tabSize:4,b?Ue(b.state):2);if(oe.eol())te.blankLine(this.state,oe.indentUnit);else for(;!oe.eol();){let Re=sn(te.token,oe,this.state);if(Re&&(H=this.emitToken(this.lang.tokenTable.resolve(Re),this.parsedPos+oe.start,this.parsedPos+oe.pos,4,H)),oe.start>1e4)break}this.parsedPos=$,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let b=v.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Di,topID:0,maxBufferLength:2048,reused:this.chunkReused});b=new v.mp(b.type,b.children,b.positions,b.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(b),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new v.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function sn(B,b,k){b.start=b.pos;for(let $=0;$<10;$++){let H=B(b,k);if(b.pos>b.start)return H}throw new Error("Stream parser failed to advance stream.")}const Rn=Object.create(null),Vr=[v.Jq.none],Di=new v.Lj(Vr),nr=[],Sn=Object.create(null);for(let[B,b]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Sn[B]=bi(Rn,b);class Ri{constructor(b){this.extra=b,this.table=Object.assign(Object.create(null),Sn)}resolve(b){return b?this.table[b]||(this.table[b]=bi(this.extra,b)):0}}const Ii=new Ri(Rn);function ci(B,b){nr.indexOf(B)>-1||(nr.push(B),console.warn(b))}function bi(B,b){let k=null;for(let te of b.split(".")){let oe=B[te]||I.pJ[te];oe?typeof oe=="function"?k?k=oe(k):ci(te,`Modifier ${te} used at start of tag`):k?ci(te,`Tag ${te} used as modifier`):k=oe:ci(te,`Unknown highlighting tag ${te}`)}if(!k)return 0;let $=b.replace(/ /g,"_"),H=v.Jq.define({id:Vr.length,name:$,props:[(0,I.Gv)({[$]:k})]});return Vr.push(H),H.id}function _i(B){let b=v.Jq.define({id:Vr.length,name:"Document",props:[De.add(()=>B)]});return Vr.push(b),b}},42123:function(Bn,pt,z){"use strict";z.d(pt,{r:function(){return me}});var v=["true","false","on","off","yes","no"],ke=new RegExp("\\b(("+v.join(")|(")+"))$","i");const me={name:"yaml",token:function(I,se){var Ne=I.peek(),De=se.escaped;if(se.escaped=!1,Ne=="#"&&(I.pos==0||/\s/.test(I.string.charAt(I.pos-1))))return I.skipToEnd(),"comment";if(I.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(se.literal&&I.indentation()>se.keyCol)return I.skipToEnd(),"string";if(se.literal&&(se.literal=!1),I.sol()){if(se.keyCol=0,se.pair=!1,se.pairStart=!1,I.match("---")||I.match("..."))return"def";if(I.match(/^\s*-\s+/))return"meta"}if(I.match(/^(\{|\}|\[|\])/))return Ne=="{"?se.inlinePairs++:Ne=="}"?se.inlinePairs--:Ne=="["?se.inlineList++:se.inlineList--,"meta";if(se.inlineList>0&&!De&&Ne==",")return I.next(),"meta";if(se.inlinePairs>0&&!De&&Ne==",")return se.keyCol=0,se.pair=!1,se.pairStart=!1,I.next(),"meta";if(se.pairStart){if(I.match(/^\s*(\||\>)\s*/))return se.literal=!0,"meta";if(I.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(se.inlinePairs==0&&I.match(/^\s*-?[0-9\.\,]+\s?$/)||se.inlinePairs>0&&I.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(I.match(ke))return"keyword"}return!se.pair&&I.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(se.pair=!0,se.keyCol=I.indentation(),"atom"):se.pair&&I.match(/^:\s*/)?(se.pairStart=!0,"meta"):(se.pairStart=!1,se.escaped=Ne=="\\",I.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},1727:function(Bn,pt,z){"use strict";z.d(pt,{BO:function(){return Pn},D0:function(){return hn},Gz:function(){return Zn},IS:function(){return Cr},Py:function(){return Gt},QQ:function(){return Lt},Wl:function(){return O},Xs:function(){return zn},YW:function(){return Mt},as:function(){return le},bg:function(){return Oe},cp:function(){return It},f_:function(){return $r},gc:function(){return K},gm:function(){return Ze},jT:function(){return ye},n0:function(){return yt},nZ:function(){return Xe},q6:function(){return Jn},r$:function(){return vt},uU:function(){return Yt},xv:function(){return v},yy:function(){return Bt}});class v{lineAt(f){if(f<0||f>this.length)throw new RangeError(`Invalid position ${f} in document of length ${this.length}`);return this.lineInner(f,!1,1,0)}line(f){if(f<1||f>this.lines)throw new RangeError(`Invalid line number ${f} in ${this.lines}-line document`);return this.lineInner(f,!0,1,0)}replace(f,g,S){let C=[];return this.decompose(0,f,C,2),S.length&&S.decompose(0,S.length,C,3),this.decompose(g,this.length,C,1),me.from(C,this.length-(g-f)+S.length)}append(f){return this.replace(this.length,this.length,f)}slice(f,g=this.length){let S=[];return this.decompose(f,g,S,0),me.from(S,g-f)}eq(f){if(f==this)return!0;if(f.length!=this.length||f.lines!=this.lines)return!1;let g=this.scanIdentical(f,1),S=this.length-this.scanIdentical(f,-1),C=new De(this),P=new De(f);for(let M=g,Z=g;;){if(C.next(M),P.next(M),M=0,C.lineBreak!=P.lineBreak||C.done!=P.done||C.value!=P.value)return!1;if(Z+=C.value.length,C.done||Z>=S)return!0}}iter(f=1){return new De(this,f)}iterRange(f,g=this.length){return new Tt(this,f,g)}iterLines(f,g){let S;if(f==null)S=this.iter();else{g==null&&(g=this.lines+1);let C=this.line(f).from;S=this.iterRange(C,Math.max(C,g==this.lines+1?this.length:g<=1?0:this.line(g-1).to))}return new rt(S)}toString(){return this.sliceString(0)}toJSON(){let f=[];return this.flatten(f),f}constructor(){}static of(f){if(f.length==0)throw new RangeError("A document must have at least one line");return f.length==1&&!f[0]?v.empty:f.length<=32?new ke(f):me.from(ke.split(f,[]))}}class ke extends v{constructor(f,g=I(f)){super(),this.text=f,this.length=g}get lines(){return this.text.length}get children(){return null}lineInner(f,g,S,C){for(let P=0;;P++){let M=this.text[P],Z=C+M.length;if((g?S:Z)>=f)return new st(C,Z,S,M);C=Z+1,S++}}decompose(f,g,S,C){let P=f<=0&&g>=this.length?this:new ke(Ne(this.text,f,g),Math.min(g,this.length)-Math.max(0,f));if(C&1){let M=S.pop(),Z=se(P.text,M.text.slice(),0,P.length);if(Z.length<=32)S.push(new ke(Z,M.length+P.length));else{let U=Z.length>>1;S.push(new ke(Z.slice(0,U)),new ke(Z.slice(U)))}}else S.push(P)}replace(f,g,S){if(!(S instanceof ke))return super.replace(f,g,S);let C=se(this.text,se(S.text,Ne(this.text,0,f)),g),P=this.length+S.length-(g-f);return C.length<=32?new ke(C,P):me.from(ke.split(C,[]),P)}sliceString(f,g=this.length,S=`
`){let C="";for(let P=0,M=0;P<=g&&M<this.text.length;M++){let Z=this.text[M],U=P+Z.length;P>f&&M&&(C+=S),f<U&&g>P&&(C+=Z.slice(Math.max(0,f-P),g-P)),P=U+1}return C}flatten(f){for(let g of this.text)f.push(g)}scanIdentical(){return 0}static split(f,g){let S=[],C=-1;for(let P of f)S.push(P),C+=P.length+1,S.length==32&&(g.push(new ke(S,C)),S=[],C=-1);return C>-1&&g.push(new ke(S,C)),g}}class me extends v{constructor(f,g){super(),this.children=f,this.length=g,this.lines=0;for(let S of f)this.lines+=S.lines}lineInner(f,g,S,C){for(let P=0;;P++){let M=this.children[P],Z=C+M.length,U=S+M.lines-1;if((g?U:Z)>=f)return M.lineInner(f,g,S,C);C=Z+1,S=U+1}}decompose(f,g,S,C){for(let P=0,M=0;M<=g&&P<this.children.length;P++){let Z=this.children[P],U=M+Z.length;if(f<=U&&g>=M){let he=C&((M<=f?1:0)|(U>=g?2:0));M>=f&&U<=g&&!he?S.push(Z):Z.decompose(f-M,g-M,S,he)}M=U+1}}replace(f,g,S){if(S.lines<this.lines)for(let C=0,P=0;C<this.children.length;C++){let M=this.children[C],Z=P+M.length;if(f>=P&&g<=Z){let U=M.replace(f-P,g-P,S),he=this.lines-M.lines+U.lines;if(U.lines<he>>5-1&&U.lines>he>>5+1){let ue=this.children.slice();return ue[C]=U,new me(ue,this.length-(g-f)+S.length)}return super.replace(P,Z,U)}P=Z+1}return super.replace(f,g,S)}sliceString(f,g=this.length,S=`
`){let C="";for(let P=0,M=0;P<this.children.length&&M<=g;P++){let Z=this.children[P],U=M+Z.length;M>f&&P&&(C+=S),f<U&&g>M&&(C+=Z.sliceString(f-M,g-M,S)),M=U+1}return C}flatten(f){for(let g of this.children)g.flatten(f)}scanIdentical(f,g){if(!(f instanceof me))return 0;let S=0,[C,P,M,Z]=g>0?[0,0,this.children.length,f.children.length]:[this.children.length-1,f.children.length-1,-1,-1];for(;;C+=g,P+=g){if(C==M||P==Z)return S;let U=this.children[C],he=f.children[P];if(U!=he)return S+U.scanIdentical(he,g);S+=U.length+1}}static from(f,g=f.reduce((S,C)=>S+C.length+1,-1)){let S=0;for(let _e of f)S+=_e.lines;if(S<32){let _e=[];for(let on of f)on.flatten(_e);return new ke(_e,g)}let C=Math.max(32,S>>5),P=C<<1,M=C>>1,Z=[],U=0,he=-1,ue=[];function Be(_e){let on;if(_e.lines>P&&_e instanceof me)for(let Gn of _e.children)Be(Gn);else _e.lines>M&&(U>M||!U)?(ft(),Z.push(_e)):_e instanceof ke&&U&&(on=ue[ue.length-1])instanceof ke&&_e.lines+on.lines<=32?(U+=_e.lines,he+=_e.length+1,ue[ue.length-1]=new ke(on.text.concat(_e.text),on.length+1+_e.length)):(U+_e.lines>C&&ft(),U+=_e.lines,he+=_e.length+1,ue.push(_e))}function ft(){U!=0&&(Z.push(ue.length==1?ue[0]:me.from(ue,he)),he=-1,U=ue.length=0)}for(let _e of f)Be(_e);return ft(),Z.length==1?Z[0]:new me(Z,g)}}v.empty=new ke([""],0);function I(j){let f=-1;for(let g of j)f+=g.length+1;return f}function se(j,f,g=0,S=1e9){for(let C=0,P=0,M=!0;P<j.length&&C<=S;P++){let Z=j[P],U=C+Z.length;U>=g&&(U>S&&(Z=Z.slice(0,S-C)),C<g&&(Z=Z.slice(g-C)),M?(f[f.length-1]+=Z,M=!1):f.push(Z)),C=U+1}return f}function Ne(j,f,g){return se(j,[""],f,g)}class De{constructor(f,g=1){this.dir=g,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[f],this.offsets=[g>0?1:(f instanceof ke?f.text.length:f.children.length)<<1]}nextInner(f,g){for(this.done=this.lineBreak=!1;;){let S=this.nodes.length-1,C=this.nodes[S],P=this.offsets[S],M=P>>1,Z=C instanceof ke?C.text.length:C.children.length;if(M==(g>0?Z:0)){if(S==0)return this.done=!0,this.value="",this;g>0&&this.offsets[S-1]++,this.nodes.pop(),this.offsets.pop()}else if((P&1)==(g>0?0:1)){if(this.offsets[S]+=g,f==0)return this.lineBreak=!0,this.value=`
`,this;f--}else if(C instanceof ke){let U=C.text[M+(g<0?-1:0)];if(this.offsets[S]+=g,U.length>Math.max(0,f))return this.value=f==0?U:g>0?U.slice(f):U.slice(0,U.length-f),this;f-=U.length}else{let U=C.children[M+(g<0?-1:0)];f>U.length?(f-=U.length,this.offsets[S]+=g):(g<0&&this.offsets[S]--,this.nodes.push(U),this.offsets.push(g>0?1:(U instanceof ke?U.text.length:U.children.length)<<1))}}}next(f=0){return f<0&&(this.nextInner(-f,-this.dir),f=this.value.length),this.nextInner(f,this.dir)}}class Tt{constructor(f,g,S){this.value="",this.done=!1,this.cursor=new De(f,g>S?-1:1),this.pos=g>S?f.length:0,this.from=Math.min(g,S),this.to=Math.max(g,S)}nextInner(f,g){if(g<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;f+=Math.max(0,g<0?this.pos-this.to:this.from-this.pos);let S=g<0?this.pos-this.from:this.to-this.pos;f>S&&(f=S),S-=f;let{value:C}=this.cursor.next(f);return this.pos+=(C.length+f)*g,this.value=C.length<=S?C:g<0?C.slice(C.length-S):C.slice(0,S),this.done=!this.value,this}next(f=0){return f<0?f=Math.max(f,this.from-this.pos):f>0&&(f=Math.min(f,this.to-this.pos)),this.nextInner(f,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class rt{constructor(f){this.inner=f,this.afterBreak=!0,this.value="",this.done=!1}next(f=0){let{done:g,lineBreak:S,value:C}=this.inner.next(f);return g?(this.done=!0,this.value=""):S?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=C,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(v.prototype[Symbol.iterator]=function(){return this.iter()},De.prototype[Symbol.iterator]=Tt.prototype[Symbol.iterator]=rt.prototype[Symbol.iterator]=function(){return this});class st{constructor(f,g,S,C){this.from=f,this.to=g,this.number=S,this.text=C}get length(){return this.to-this.from}}let He="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(j=>j?parseInt(j,36):1);for(let j=1;j<He.length;j++)He[j]+=He[j-1];function gt(j){for(let f=1;f<He.length;f+=2)if(He[f]>j)return He[f-1]<=j;return!1}function tt(j){return j>=127462&&j<=127487}const Je=8205;function It(j,f,g=!0,S=!0){return(g?ee:Me)(j,f,S)}function ee(j,f,g){if(f==j.length)return f;f&&ge(j.charCodeAt(f))&&je(j.charCodeAt(f-1))&&f--;let S=Ze(j,f);for(f+=Xe(S);f<j.length;){let C=Ze(j,f);if(S==Je||C==Je||g&&gt(C))f+=Xe(C),S=C;else if(tt(C)){let P=0,M=f-2;for(;M>=0&&tt(Ze(j,M));)P++,M-=2;if(P%2==0)break;f+=2}else break}return f}function Me(j,f,g){for(;f>0;){let S=ee(j,f-2,g);if(S<f)return S;f--}return 0}function ge(j){return j>=56320&&j<57344}function je(j){return j>=55296&&j<56320}function Ze(j,f){let g=j.charCodeAt(f);if(!je(g)||f+1==j.length)return g;let S=j.charCodeAt(f+1);return ge(S)?(g-55296<<10)+(S-56320)+65536:g}function Oe(j){return j<=65535?String.fromCharCode(j):(j-=65536,String.fromCharCode((j>>10)+55296,(j&1023)+56320))}function Xe(j){return j<65536?1:2}const Ye=/\r\n?|\n/;var K=function(j){return j[j.Simple=0]="Simple",j[j.TrackDel=1]="TrackDel",j[j.TrackBefore=2]="TrackBefore",j[j.TrackAfter=3]="TrackAfter",j}(K||(K={}));class yt{constructor(f){this.sections=f}get length(){let f=0;for(let g=0;g<this.sections.length;g+=2)f+=this.sections[g];return f}get newLength(){let f=0;for(let g=0;g<this.sections.length;g+=2){let S=this.sections[g+1];f+=S<0?this.sections[g]:S}return f}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(f){for(let g=0,S=0,C=0;g<this.sections.length;){let P=this.sections[g++],M=this.sections[g++];M<0?(f(S,C,P),C+=P):C+=M,S+=P}}iterChangedRanges(f,g=!1){ot(this,f,g)}get invertedDesc(){let f=[];for(let g=0;g<this.sections.length;){let S=this.sections[g++],C=this.sections[g++];C<0?f.push(S,C):f.push(C,S)}return new yt(f)}composeDesc(f){return this.empty?f:f.empty?this:Ue(this,f)}mapDesc(f,g=!1){return f.empty?this:Ae(this,f,g)}mapPos(f,g=-1,S=K.Simple){let C=0,P=0;for(let M=0;M<this.sections.length;){let Z=this.sections[M++],U=this.sections[M++],he=C+Z;if(U<0){if(he>f)return P+(f-C);P+=Z}else{if(S!=K.Simple&&he>=f&&(S==K.TrackDel&&C<f&&he>f||S==K.TrackBefore&&C<f||S==K.TrackAfter&&he>f))return null;if(he>f||he==f&&g<0&&!Z)return f==C||g<0?P:P+U;P+=U}C=he}if(f>C)throw new RangeError(`Position ${f} is out of range for changeset of length ${C}`);return P}touchesRange(f,g=f){for(let S=0,C=0;S<this.sections.length&&C<=g;){let P=this.sections[S++],M=this.sections[S++],Z=C+P;if(M>=0&&C<=g&&Z>=f)return C<f&&Z>g?"cover":!0;C=Z}return!1}toString(){let f="";for(let g=0;g<this.sections.length;){let S=this.sections[g++],C=this.sections[g++];f+=(f?" ":"")+S+(C>=0?":"+C:"")}return f}toJSON(){return this.sections}static fromJSON(f){if(!Array.isArray(f)||f.length%2||f.some(g=>typeof g!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new yt(f)}static create(f){return new yt(f)}}class le extends yt{constructor(f,g){super(f),this.inserted=g}apply(f){if(this.length!=f.length)throw new RangeError("Applying change set to a document with the wrong length");return ot(this,(g,S,C,P,M)=>f=f.replace(C,C+(S-g),M),!1),f}mapDesc(f,g=!1){return Ae(this,f,g,!0)}invert(f){let g=this.sections.slice(),S=[];for(let C=0,P=0;C<g.length;C+=2){let M=g[C],Z=g[C+1];if(Z>=0){g[C]=Z,g[C+1]=M;let U=C>>1;for(;S.length<U;)S.push(v.empty);S.push(M?f.slice(P,P+M):v.empty)}P+=M}return new le(g,S)}compose(f){return this.empty?f:f.empty?this:Ue(this,f,!0)}map(f,g=!1){return f.empty?this:Ae(this,f,g,!0)}iterChanges(f,g=!1){ot(this,f,g)}get desc(){return yt.create(this.sections)}filter(f){let g=[],S=[],C=[],P=new Ge(this);e:for(let M=0,Z=0;;){let U=M==f.length?1e9:f[M++];for(;Z<U||Z==U&&P.len==0;){if(P.done)break e;let ue=Math.min(P.len,U-Z);Ie(C,ue,-1);let Be=P.ins==-1?-1:P.off==0?P.ins:0;Ie(g,ue,Be),Be>0&&ze(S,g,P.text),P.forward(ue),Z+=ue}let he=f[M++];for(;Z<he;){if(P.done)break e;let ue=Math.min(P.len,he-Z);Ie(g,ue,-1),Ie(C,ue,P.ins==-1?-1:P.off==0?P.ins:0),P.forward(ue),Z+=ue}}return{changes:new le(g,S),filtered:yt.create(C)}}toJSON(){let f=[];for(let g=0;g<this.sections.length;g+=2){let S=this.sections[g],C=this.sections[g+1];C<0?f.push(S):C==0?f.push([S]):f.push([S].concat(this.inserted[g>>1].toJSON()))}return f}static of(f,g,S){let C=[],P=[],M=0,Z=null;function U(ue=!1){if(!ue&&!C.length)return;M<g&&Ie(C,g-M,-1);let Be=new le(C,P);Z=Z?Z.compose(Be.map(Z)):Be,C=[],P=[],M=0}function he(ue){if(Array.isArray(ue))for(let Be of ue)he(Be);else if(ue instanceof le){if(ue.length!=g)throw new RangeError(`Mismatched change set length (got ${ue.length}, expected ${g})`);U(),Z=Z?Z.compose(ue.map(Z)):ue}else{let{from:Be,to:ft=Be,insert:_e}=ue;if(Be>ft||Be<0||ft>g)throw new RangeError(`Invalid change range ${Be} to ${ft} (in doc of length ${g})`);let on=_e?typeof _e=="string"?v.of(_e.split(S||Ye)):_e:v.empty,Gn=on.length;if(Be==ft&&Gn==0)return;Be<M&&U(),Be>M&&Ie(C,Be-M,-1),Ie(C,ft-Be,Gn),ze(P,C,on),M=ft}}return he(f),U(!Z),Z}static empty(f){return new le(f?[f,-1]:[],[])}static fromJSON(f){if(!Array.isArray(f))throw new RangeError("Invalid JSON representation of ChangeSet");let g=[],S=[];for(let C=0;C<f.length;C++){let P=f[C];if(typeof P=="number")g.push(P,-1);else{if(!Array.isArray(P)||typeof P[0]!="number"||P.some((M,Z)=>Z&&typeof M!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(P.length==1)g.push(P[0],0);else{for(;S.length<C;)S.push(v.empty);S[C]=v.of(P.slice(1)),g.push(P[0],S[C].length)}}}return new le(g,S)}static createSet(f,g){return new le(f,g)}}function Ie(j,f,g,S=!1){if(f==0&&g<=0)return;let C=j.length-2;C>=0&&g<=0&&g==j[C+1]?j[C]+=f:f==0&&j[C]==0?j[C+1]+=g:S?(j[C]+=f,j[C+1]+=g):j.push(f,g)}function ze(j,f,g){if(g.length==0)return;let S=f.length-2>>1;if(S<j.length)j[j.length-1]=j[j.length-1].append(g);else{for(;j.length<S;)j.push(v.empty);j.push(g)}}function ot(j,f,g){let S=j.inserted;for(let C=0,P=0,M=0;M<j.sections.length;){let Z=j.sections[M++],U=j.sections[M++];if(U<0)C+=Z,P+=Z;else{let he=C,ue=P,Be=v.empty;for(;he+=Z,ue+=U,U&&S&&(Be=Be.append(S[M-2>>1])),!(g||M==j.sections.length||j.sections[M+1]<0);)Z=j.sections[M++],U=j.sections[M++];f(C,he,P,ue,Be),C=he,P=ue}}}function Ae(j,f,g,S=!1){let C=[],P=S?[]:null,M=new Ge(j),Z=new Ge(f);for(let U=-1;;)if(M.ins==-1&&Z.ins==-1){let he=Math.min(M.len,Z.len);Ie(C,he,-1),M.forward(he),Z.forward(he)}else if(Z.ins>=0&&(M.ins<0||U==M.i||M.off==0&&(Z.len<M.len||Z.len==M.len&&!g))){let he=Z.len;for(Ie(C,Z.ins,-1);he;){let ue=Math.min(M.len,he);M.ins>=0&&U<M.i&&M.len<=ue&&(Ie(C,0,M.ins),P&&ze(P,C,M.text),U=M.i),M.forward(ue),he-=ue}Z.next()}else if(M.ins>=0){let he=0,ue=M.len;for(;ue;)if(Z.ins==-1){let Be=Math.min(ue,Z.len);he+=Be,ue-=Be,Z.forward(Be)}else if(Z.ins==0&&Z.len<ue)ue-=Z.len,Z.next();else break;Ie(C,he,U<M.i?M.ins:0),P&&U<M.i&&ze(P,C,M.text),U=M.i,M.forward(M.len-ue)}else{if(M.done&&Z.done)return P?le.createSet(C,P):yt.create(C);throw new Error("Mismatched change set lengths")}}function Ue(j,f,g=!1){let S=[],C=g?[]:null,P=new Ge(j),M=new Ge(f);for(let Z=!1;;){if(P.done&&M.done)return C?le.createSet(S,C):yt.create(S);if(P.ins==0)Ie(S,P.len,0,Z),P.next();else if(M.len==0&&!M.done)Ie(S,0,M.ins,Z),C&&ze(C,S,M.text),M.next();else{if(P.done||M.done)throw new Error("Mismatched change set lengths");{let U=Math.min(P.len2,M.len),he=S.length;if(P.ins==-1){let ue=M.ins==-1?-1:M.off?0:M.ins;Ie(S,U,ue,Z),C&&ue&&ze(C,S,M.text)}else M.ins==-1?(Ie(S,P.off?0:P.len,U,Z),C&&ze(C,S,P.textBit(U))):(Ie(S,P.off?0:P.len,M.off?0:M.ins,Z),C&&!M.off&&ze(C,S,M.text));Z=(P.ins>U||M.ins>=0&&M.len>U)&&(Z||S.length>he),P.forward2(U),M.forward(U)}}}}class Ge{constructor(f){this.set=f,this.i=0,this.next()}next(){let{sections:f}=this.set;this.i<f.length?(this.len=f[this.i++],this.ins=f[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:f}=this.set,g=this.i-2>>1;return g>=f.length?v.empty:f[g]}textBit(f){let{inserted:g}=this.set,S=this.i-2>>1;return S>=g.length&&!f?v.empty:g[S].slice(this.off,f==null?void 0:this.off+f)}forward(f){f==this.len?this.next():(this.len-=f,this.off+=f)}forward2(f){this.ins==-1?this.forward(f):f==this.ins?this.next():(this.ins-=f,this.off+=f)}}class lt{constructor(f,g,S){this.from=f,this.to=g,this.flags=S}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let f=this.flags&3;return f==3?null:f}get goalColumn(){let f=this.flags>>5;return f==33554431?void 0:f}map(f,g=-1){let S,C;return this.empty?S=C=f.mapPos(this.from,g):(S=f.mapPos(this.from,1),C=f.mapPos(this.to,-1)),S==this.from&&C==this.to?this:new lt(S,C,this.flags)}extend(f,g=f){if(f<=this.anchor&&g>=this.anchor)return ye.range(f,g);let S=Math.abs(f-this.anchor)>Math.abs(g-this.anchor)?f:g;return ye.range(this.anchor,S)}eq(f){return this.anchor==f.anchor&&this.head==f.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(f){if(!f||typeof f.anchor!="number"||typeof f.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ye.range(f.anchor,f.head)}static create(f,g,S){return new lt(f,g,S)}}class ye{constructor(f,g){this.ranges=f,this.mainIndex=g}map(f,g=-1){return f.empty?this:ye.create(this.ranges.map(S=>S.map(f,g)),this.mainIndex)}eq(f){if(this.ranges.length!=f.ranges.length||this.mainIndex!=f.mainIndex)return!1;for(let g=0;g<this.ranges.length;g++)if(!this.ranges[g].eq(f.ranges[g]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ye([this.main],0)}addRange(f,g=!0){return ye.create([f].concat(this.ranges),g?0:this.mainIndex+1)}replaceRange(f,g=this.mainIndex){let S=this.ranges.slice();return S[g]=f,ye.create(S,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(f=>f.toJSON()),main:this.mainIndex}}static fromJSON(f){if(!f||!Array.isArray(f.ranges)||typeof f.main!="number"||f.main>=f.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ye(f.ranges.map(g=>lt.fromJSON(g)),f.main)}static single(f,g=f){return new ye([ye.range(f,g)],0)}static create(f,g=0){if(f.length==0)throw new RangeError("A selection needs at least one range");for(let S=0,C=0;C<f.length;C++){let P=f[C];if(P.empty?P.from<=S:P.from<S)return ye.normalized(f.slice(),g);S=P.to}return new ye(f,g)}static cursor(f,g=0,S,C){return lt.create(f,f,(g==0?0:g<0?4:8)|(S==null?3:Math.min(2,S))|(C!=null?C:33554431)<<5)}static range(f,g,S,C){let P=(S!=null?S:33554431)<<5|(C==null?3:Math.min(2,C));return g<f?lt.create(g,f,24|P):lt.create(f,g,(g>f?4:0)|P)}static normalized(f,g=0){let S=f[g];f.sort((C,P)=>C.from-P.from),g=f.indexOf(S);for(let C=1;C<f.length;C++){let P=f[C],M=f[C-1];if(P.empty?P.from<=M.to:P.from<M.to){let Z=M.from,U=Math.max(P.to,M.to);C<=g&&g--,f.splice(--C,2,P.anchor>P.head?ye.range(U,Z):ye.range(Z,U))}}return new ye(f,g)}}function xe(j,f){for(let g of j.ranges)if(g.to>f)throw new RangeError("Selection points outside of document")}let We=0;class vt{constructor(f,g,S,C,P){this.combine=f,this.compareInput=g,this.compare=S,this.isStatic=C,this.id=We++,this.default=f([]),this.extensions=typeof P=="function"?P(this):P}static define(f={}){return new vt(f.combine||(g=>g),f.compareInput||((g,S)=>g===S),f.compare||(f.combine?(g,S)=>g===S:Pt),!!f.static,f.enables)}of(f){return new Wt([],this,0,f)}compute(f,g){if(this.isStatic)throw new Error("Can't compute a static facet");return new Wt(f,this,1,g)}computeN(f,g){if(this.isStatic)throw new Error("Can't compute a static facet");return new Wt(f,this,2,g)}from(f,g){return g||(g=S=>S),this.compute([f],S=>g(S.field(f)))}}function Pt(j,f){return j==f||j.length==f.length&&j.every((g,S)=>g===f[S])}class Wt{constructor(f,g,S,C){this.dependencies=f,this.facet=g,this.type=S,this.value=C,this.id=We++}dynamicSlot(f){var g;let S=this.value,C=this.facet.compareInput,P=this.id,M=f[P]>>1,Z=this.type==2,U=!1,he=!1,ue=[];for(let Be of this.dependencies)Be=="doc"?U=!0:Be=="selection"?he=!0:((g=f[Be.id])!==null&&g!==void 0?g:1)&1||ue.push(f[Be.id]);return{create(Be){return Be.values[M]=S(Be),1},update(Be,ft){if(U&&ft.docChanged||he&&(ft.docChanged||ft.selection)||In(Be,ue)){let _e=S(Be);if(Z?!Zt(_e,Be.values[M],C):!C(_e,Be.values[M]))return Be.values[M]=_e,1}return 0},reconfigure:(Be,ft)=>{let _e,on=ft.config.address[P];if(on!=null){let Gn=$e(ft,on);if(this.dependencies.every(sn=>sn instanceof vt?ft.facet(sn)===Be.facet(sn):sn instanceof Lt?ft.field(sn,!1)==Be.field(sn,!1):!0)||(Z?Zt(_e=S(Be),Gn,C):C(_e=S(Be),Gn)))return Be.values[M]=Gn,0}else _e=S(Be);return Be.values[M]=_e,1}}}}function Zt(j,f,g){if(j.length!=f.length)return!1;for(let S=0;S<j.length;S++)if(!g(j[S],f[S]))return!1;return!0}function In(j,f){let g=!1;for(let S of f)Se(j,S)&1&&(g=!0);return g}function xn(j,f,g){let S=g.map(U=>j[U.id]),C=g.map(U=>U.type),P=S.filter(U=>!(U&1)),M=j[f.id]>>1;function Z(U){let he=[];for(let ue=0;ue<S.length;ue++){let Be=$e(U,S[ue]);if(C[ue]==2)for(let ft of Be)he.push(ft);else he.push(Be)}return f.combine(he)}return{create(U){for(let he of S)Se(U,he);return U.values[M]=Z(U),1},update(U,he){if(!In(U,P))return 0;let ue=Z(U);return f.compare(ue,U.values[M])?0:(U.values[M]=ue,1)},reconfigure(U,he){let ue=In(U,S),Be=he.config.facets[f.id],ft=he.facet(f);if(Be&&!ue&&Pt(g,Be))return U.values[M]=ft,0;let _e=Z(U);return f.compare(_e,ft)?(U.values[M]=ft,0):(U.values[M]=_e,1)}}}const er=vt.define({static:!0});class Lt{constructor(f,g,S,C,P){this.id=f,this.createF=g,this.updateF=S,this.compareF=C,this.spec=P,this.provides=void 0}static define(f){let g=new Lt(We++,f.create,f.update,f.compare||((S,C)=>S===C),f);return f.provide&&(g.provides=f.provide(g)),g}create(f){let g=f.facet(er).find(S=>S.field==this);return((g==null?void 0:g.create)||this.createF)(f)}slot(f){let g=f[this.id]>>1;return{create:S=>(S.values[g]=this.create(S),1),update:(S,C)=>{let P=S.values[g],M=this.updateF(P,C);return this.compareF(P,M)?0:(S.values[g]=M,1)},reconfigure:(S,C)=>C.config.address[this.id]!=null?(S.values[g]=C.field(this),0):(S.values[g]=this.create(S),1)}}init(f){return[this,er.of({field:this,create:f})]}get extension(){return this}}const rn={lowest:4,low:3,default:2,high:1,highest:0};function Ee(j){return f=>new N(f,j)}const O={highest:Ee(rn.highest),high:Ee(rn.high),default:Ee(rn.default),low:Ee(rn.low),lowest:Ee(rn.lowest)};class N{constructor(f,g){this.inner=f,this.prec=g}}class W{of(f){return new G(this,f)}reconfigure(f){return W.reconfigure.of({compartment:this,extension:f})}get(f){return f.config.compartments.get(this)}}class G{constructor(f,g){this.compartment=f,this.inner=g}}class ne{constructor(f,g,S,C,P,M){for(this.base=f,this.compartments=g,this.dynamicSlots=S,this.address=C,this.staticValues=P,this.facets=M,this.statusTemplate=[];this.statusTemplate.length<S.length;)this.statusTemplate.push(0)}staticFacet(f){let g=this.address[f.id];return g==null?f.default:this.staticValues[g>>1]}static resolve(f,g,S){let C=[],P=Object.create(null),M=new Map;for(let ft of pe(f,g,M))ft instanceof Lt?C.push(ft):(P[ft.facet.id]||(P[ft.facet.id]=[])).push(ft);let Z=Object.create(null),U=[],he=[];for(let ft of C)Z[ft.id]=he.length<<1,he.push(_e=>ft.slot(_e));let ue=S==null?void 0:S.config.facets;for(let ft in P){let _e=P[ft],on=_e[0].facet,Gn=ue&&ue[ft]||[];if(_e.every(sn=>sn.type==0))if(Z[on.id]=U.length<<1|1,Pt(Gn,_e))U.push(S.facet(on));else{let sn=on.combine(_e.map(Rn=>Rn.value));U.push(S&&on.compare(sn,S.facet(on))?S.facet(on):sn)}else{for(let sn of _e)sn.type==0?(Z[sn.id]=U.length<<1|1,U.push(sn.value)):(Z[sn.id]=he.length<<1,he.push(Rn=>sn.dynamicSlot(Rn)));Z[on.id]=he.length<<1,he.push(sn=>xn(sn,on,_e))}}let Be=he.map(ft=>ft(Z));return new ne(f,M,Be,Z,U,P)}}function pe(j,f,g){let S=[[],[],[],[],[]],C=new Map;function P(M,Z){let U=C.get(M);if(U!=null){if(U<=Z)return;let he=S[U].indexOf(M);he>-1&&S[U].splice(he,1),M instanceof G&&g.delete(M.compartment)}if(C.set(M,Z),Array.isArray(M))for(let he of M)P(he,Z);else if(M instanceof G){if(g.has(M.compartment))throw new RangeError("Duplicate use of compartment in extensions");let he=f.get(M.compartment)||M.inner;g.set(M.compartment,he),P(he,Z)}else if(M instanceof N)P(M.inner,M.prec);else if(M instanceof Lt)S[Z].push(M),M.provides&&P(M.provides,Z);else if(M instanceof Wt)S[Z].push(M),M.facet.extensions&&P(M.facet.extensions,rn.default);else{let he=M.extension;if(!he)throw new Error(`Unrecognized extension value in extension set (${M}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);P(he,Z)}}return P(j,rn.default),S.reduce((M,Z)=>M.concat(Z))}function Se(j,f){if(f&1)return 2;let g=f>>1,S=j.status[g];if(S==4)throw new Error("Cyclic dependency between fields and/or facets");if(S&2)return S;j.status[g]=4;let C=j.computeSlot(j,j.config.dynamicSlots[g]);return j.status[g]=2|C}function $e(j,f){return f&1?j.config.staticValues[f>>1]:j.values[f>>1]}const ve=vt.define(),ut=vt.define({combine:j=>j.some(f=>f),static:!0}),St=vt.define({combine:j=>j.length?j[0]:void 0,static:!0}),at=vt.define(),zt=vt.define(),Ft=vt.define(),Qt=vt.define({combine:j=>j.length?j[0]:!1});class Jn{constructor(f,g){this.type=f,this.value=g}static define(){return new En}}class En{of(f){return new Jn(this,f)}}class or{constructor(f){this.map=f}of(f){return new Gt(this,f)}}class Gt{constructor(f,g){this.type=f,this.value=g}map(f){let g=this.type.map(this.value,f);return g===void 0?void 0:g==this.value?this:new Gt(this.type,g)}is(f){return this.type==f}static define(f={}){return new or(f.map||(g=>g))}static mapEffects(f,g){if(!f.length)return f;let S=[];for(let C of f){let P=C.map(g);P&&S.push(P)}return S}}Gt.reconfigure=Gt.define(),Gt.appendConfig=Gt.define();class Mt{constructor(f,g,S,C,P,M){this.startState=f,this.changes=g,this.selection=S,this.effects=C,this.annotations=P,this.scrollIntoView=M,this._doc=null,this._state=null,S&&xe(S,g.newLength),P.some(Z=>Z.type==Mt.time)||(this.annotations=P.concat(Mt.time.of(Date.now())))}static create(f,g,S,C,P,M){return new Mt(f,g,S,C,P,M)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(f){for(let g of this.annotations)if(g.type==f)return g.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(f){let g=this.annotation(Mt.userEvent);return!!(g&&(g==f||g.length>f.length&&g.slice(0,f.length)==f&&g[f.length]=="."))}}Mt.time=Jn.define(),Mt.userEvent=Jn.define(),Mt.addToHistory=Jn.define(),Mt.remote=Jn.define();function yn(j,f){let g=[];for(let S=0,C=0;;){let P,M;if(S<j.length&&(C==f.length||f[C]>=j[S]))P=j[S++],M=j[S++];else if(C<f.length)P=f[C++],M=f[C++];else return g;!g.length||g[g.length-1]<P?g.push(P,M):g[g.length-1]<M&&(g[g.length-1]=M)}}function Ct(j,f,g){var S;let C,P,M;return g?(C=f.changes,P=le.empty(f.changes.length),M=j.changes.compose(f.changes)):(C=f.changes.map(j.changes),P=j.changes.mapDesc(f.changes,!0),M=j.changes.compose(C)),{changes:M,selection:f.selection?f.selection.map(P):(S=j.selection)===null||S===void 0?void 0:S.map(C),effects:Gt.mapEffects(j.effects,C).concat(Gt.mapEffects(f.effects,P)),annotations:j.annotations.length?j.annotations.concat(f.annotations):f.annotations,scrollIntoView:j.scrollIntoView||f.scrollIntoView}}function Kt(j,f,g){let S=f.selection,C=an(f.annotations);return f.userEvent&&(C=C.concat(Mt.userEvent.of(f.userEvent))),{changes:f.changes instanceof le?f.changes:le.of(f.changes||[],g,j.facet(St)),selection:S&&(S instanceof ye?S:ye.single(S.anchor,S.head)),effects:an(f.effects),annotations:C,scrollIntoView:!!f.scrollIntoView}}function Xt(j,f,g){let S=Kt(j,f.length?f[0]:{},j.doc.length);f.length&&f[0].filter===!1&&(g=!1);for(let P=1;P<f.length;P++){f[P].filter===!1&&(g=!1);let M=!!f[P].sequential;S=Ct(S,Kt(j,f[P],M?S.changes.newLength:j.doc.length),M)}let C=Mt.create(j,S.changes,S.selection,S.effects,S.annotations,S.scrollIntoView);return bt(g?Jt(C):C)}function Jt(j){let f=j.startState,g=!0;for(let C of f.facet(at)){let P=C(j);if(P===!1){g=!1;break}Array.isArray(P)&&(g=g===!0?P:yn(g,P))}if(g!==!0){let C,P;if(g===!1)P=j.changes.invertedDesc,C=le.empty(f.doc.length);else{let M=j.changes.filter(g);C=M.changes,P=M.filtered.mapDesc(M.changes).invertedDesc}j=Mt.create(f,C,j.selection&&j.selection.map(P),Gt.mapEffects(j.effects,P),j.annotations,j.scrollIntoView)}let S=f.facet(zt);for(let C=S.length-1;C>=0;C--){let P=S[C](j);P instanceof Mt?j=P:Array.isArray(P)&&P.length==1&&P[0]instanceof Mt?j=P[0]:j=Xt(f,an(P),!1)}return j}function bt(j){let f=j.startState,g=f.facet(Ft),S=j;for(let C=g.length-1;C>=0;C--){let P=g[C](j);P&&Object.keys(P).length&&(S=Ct(S,Kt(f,P,j.changes.newLength),!0))}return S==j?j:Mt.create(f,j.changes,j.selection,S.effects,S.annotations,S.scrollIntoView)}const wt=[];function an(j){return j==null?wt:Array.isArray(j)?j:[j]}var hn=function(j){return j[j.Word=0]="Word",j[j.Space=1]="Space",j[j.Other=2]="Other",j}(hn||(hn={}));const Vn=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Hn;try{Hn=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function cr(j){if(Hn)return Hn.test(j);for(let f=0;f<j.length;f++){let g=j[f];if(/\w/.test(g)||g>"\x80"&&(g.toUpperCase()!=g.toLowerCase()||Vn.test(g)))return!0}return!1}function wr(j){return f=>{if(!/\S/.test(f))return hn.Space;if(cr(f))return hn.Word;for(let g=0;g<j.length;g++)if(f.indexOf(j[g])>-1)return hn.Word;return hn.Other}}class Bt{constructor(f,g,S,C,P,M){this.config=f,this.doc=g,this.selection=S,this.values=C,this.status=f.statusTemplate.slice(),this.computeSlot=P,M&&(M._state=this);for(let Z=0;Z<this.config.dynamicSlots.length;Z++)Se(this,Z<<1);this.computeSlot=null}field(f,g=!0){let S=this.config.address[f.id];if(S==null){if(g)throw new RangeError("Field is not present in this state");return}return Se(this,S),$e(this,S)}update(...f){return Xt(this,f,!0)}applyTransaction(f){let g=this.config,{base:S,compartments:C}=g;for(let M of f.effects)M.is(W.reconfigure)?(g&&(C=new Map,g.compartments.forEach((Z,U)=>C.set(U,Z)),g=null),C.set(M.value.compartment,M.value.extension)):M.is(Gt.reconfigure)?(g=null,S=M.value):M.is(Gt.appendConfig)&&(g=null,S=an(S).concat(M.value));let P;g?P=f.startState.values.slice():(g=ne.resolve(S,C,this),P=new Bt(g,this.doc,this.selection,g.dynamicSlots.map(()=>null),(Z,U)=>U.reconfigure(Z,this),null).values),new Bt(g,f.newDoc,f.newSelection,P,(M,Z)=>Z.update(M,f),f)}replaceSelection(f){return typeof f=="string"&&(f=this.toText(f)),this.changeByRange(g=>({changes:{from:g.from,to:g.to,insert:f},range:ye.cursor(g.from+f.length)}))}changeByRange(f){let g=this.selection,S=f(g.ranges[0]),C=this.changes(S.changes),P=[S.range],M=an(S.effects);for(let Z=1;Z<g.ranges.length;Z++){let U=f(g.ranges[Z]),he=this.changes(U.changes),ue=he.map(C);for(let ft=0;ft<Z;ft++)P[ft]=P[ft].map(ue);let Be=C.mapDesc(he,!0);P.push(U.range.map(Be)),C=C.compose(ue),M=Gt.mapEffects(M,ue).concat(Gt.mapEffects(an(U.effects),Be))}return{changes:C,selection:ye.create(P,g.mainIndex),effects:M}}changes(f=[]){return f instanceof le?f:le.of(f,this.doc.length,this.facet(Bt.lineSeparator))}toText(f){return v.of(f.split(this.facet(Bt.lineSeparator)||Ye))}sliceDoc(f=0,g=this.doc.length){return this.doc.sliceString(f,g,this.lineBreak)}facet(f){let g=this.config.address[f.id];return g==null?f.default:(Se(this,g),$e(this,g))}toJSON(f){let g={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(f)for(let S in f){let C=f[S];C instanceof Lt&&this.config.address[C.id]!=null&&(g[S]=C.spec.toJSON(this.field(f[S]),this))}return g}static fromJSON(f,g={},S){if(!f||typeof f.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let C=[];if(S){for(let P in S)if(Object.prototype.hasOwnProperty.call(f,P)){let M=S[P],Z=f[P];C.push(M.init(U=>M.spec.fromJSON(Z,U)))}}return Bt.create({doc:f.doc,selection:ye.fromJSON(f.selection),extensions:g.extensions?C.concat([g.extensions]):C})}static create(f={}){let g=ne.resolve(f.extensions||[],new Map),S=f.doc instanceof v?f.doc:v.of((f.doc||"").split(g.staticFacet(Bt.lineSeparator)||Ye)),C=f.selection?f.selection instanceof ye?f.selection:ye.single(f.selection.anchor,f.selection.head):ye.single(0);return xe(C,S.length),g.staticFacet(ut)||(C=C.asSingle()),new Bt(g,S,C,g.dynamicSlots.map(()=>null),(P,M)=>M.create(P),null)}get tabSize(){return this.facet(Bt.tabSize)}get lineBreak(){return this.facet(Bt.lineSeparator)||`
`}get readOnly(){return this.facet(Qt)}phrase(f,...g){for(let S of this.facet(Bt.phrases))if(Object.prototype.hasOwnProperty.call(S,f)){f=S[f];break}return g.length&&(f=f.replace(/\$(\$|\d*)/g,(S,C)=>{if(C=="$")return"$";let P=+(C||1);return!P||P>g.length?S:g[P-1]})),f}languageDataAt(f,g,S=-1){let C=[];for(let P of this.facet(ve))for(let M of P(this,g,S))Object.prototype.hasOwnProperty.call(M,f)&&C.push(M[f]);return C}charCategorizer(f){return wr(this.languageDataAt("wordChars",f).join(""))}wordAt(f){let{text:g,from:S,length:C}=this.doc.lineAt(f),P=this.charCategorizer(f),M=f-S,Z=f-S;for(;M>0;){let U=It(g,M,!1);if(P(g.slice(U,M))!=hn.Word)break;M=U}for(;Z<C;){let U=It(g,Z);if(P(g.slice(Z,U))!=hn.Word)break;Z=U}return M==Z?null:ye.range(M+S,Z+S)}}Bt.allowMultipleSelections=ut,Bt.tabSize=vt.define({combine:j=>j.length?j[0]:4}),Bt.lineSeparator=St,Bt.readOnly=Qt,Bt.phrases=vt.define({compare(j,f){let g=Object.keys(j),S=Object.keys(f);return g.length==S.length&&g.every(C=>j[C]==f[C])}}),Bt.languageData=ve,Bt.changeFilter=at,Bt.transactionFilter=zt,Bt.transactionExtender=Ft,W.reconfigure=Gt.define();function Pn(j,f,g={}){let S={};for(let C of j)for(let P of Object.keys(C)){let M=C[P],Z=S[P];if(Z===void 0)S[P]=M;else if(!(Z===M||M===void 0))if(Object.hasOwnProperty.call(g,P))S[P]=g[P](Z,M);else throw new Error("Config merge conflict for field "+P)}for(let C in f)S[C]===void 0&&(S[C]=f[C]);return S}class Yt{eq(f){return this==f}range(f,g=f){return un.create(f,g,this)}}Yt.prototype.startSide=Yt.prototype.endSide=0,Yt.prototype.point=!1,Yt.prototype.mapMode=K.TrackDel;class un{constructor(f,g,S){this.from=f,this.to=g,this.value=S}static create(f,g,S){return new un(f,g,S)}}function Xn(j,f){return j.from-f.from||j.value.startSide-f.value.startSide}class fr{constructor(f,g,S,C){this.from=f,this.to=g,this.value=S,this.maxPoint=C}get length(){return this.to[this.to.length-1]}findIndex(f,g,S,C=0){let P=S?this.to:this.from;for(let M=C,Z=P.length;;){if(M==Z)return M;let U=M+Z>>1,he=P[U]-f||(S?this.value[U].endSide:this.value[U].startSide)-g;if(U==M)return he>=0?M:Z;he>=0?Z=U:M=U+1}}between(f,g,S,C){for(let P=this.findIndex(g,-1e9,!0),M=this.findIndex(S,1e9,!1,P);P<M;P++)if(C(this.from[P]+f,this.to[P]+f,this.value[P])===!1)return!1}map(f,g){let S=[],C=[],P=[],M=-1,Z=-1;for(let U=0;U<this.value.length;U++){let he=this.value[U],ue=this.from[U]+f,Be=this.to[U]+f,ft,_e;if(ue==Be){let on=g.mapPos(ue,he.startSide,he.mapMode);if(on==null||(ft=_e=on,he.startSide!=he.endSide&&(_e=g.mapPos(ue,he.endSide),_e<ft)))continue}else if(ft=g.mapPos(ue,he.startSide),_e=g.mapPos(Be,he.endSide),ft>_e||ft==_e&&he.startSide>0&&he.endSide<=0)continue;(_e-ft||he.endSide-he.startSide)<0||(M<0&&(M=ft),he.point&&(Z=Math.max(Z,_e-ft)),S.push(he),C.push(ft-M),P.push(_e-M))}return{mapped:S.length?new fr(C,P,S,Z):null,pos:M}}}class zn{constructor(f,g,S,C){this.chunkPos=f,this.chunk=g,this.nextLayer=S,this.maxPoint=C}static create(f,g,S,C){return new zn(f,g,S,C)}get length(){let f=this.chunk.length-1;return f<0?0:Math.max(this.chunkEnd(f),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let f=this.nextLayer.size;for(let g of this.chunk)f+=g.value.length;return f}chunkEnd(f){return this.chunkPos[f]+this.chunk[f].length}update(f){let{add:g=[],sort:S=!1,filterFrom:C=0,filterTo:P=this.length}=f,M=f.filter;if(g.length==0&&!M)return this;if(S&&(g=g.slice().sort(Xn)),this.isEmpty)return g.length?zn.of(g):this;let Z=new Ln(this,null,-1).goto(0),U=0,he=[],ue=new $r;for(;Z.value||U<g.length;)if(U<g.length&&(Z.from-g[U].from||Z.startSide-g[U].value.startSide)>=0){let Be=g[U++];ue.addInner(Be.from,Be.to,Be.value)||he.push(Be)}else Z.rangeIndex==1&&Z.chunkIndex<this.chunk.length&&(U==g.length||this.chunkEnd(Z.chunkIndex)<g[U].from)&&(!M||C>this.chunkEnd(Z.chunkIndex)||P<this.chunkPos[Z.chunkIndex])&&ue.addChunk(this.chunkPos[Z.chunkIndex],this.chunk[Z.chunkIndex])?Z.nextChunk():((!M||C>Z.to||P<Z.from||M(Z.from,Z.to,Z.value))&&(ue.addInner(Z.from,Z.to,Z.value)||he.push(un.create(Z.from,Z.to,Z.value))),Z.next());return ue.finishInner(this.nextLayer.isEmpty&&!he.length?zn.empty:this.nextLayer.update({add:he,filter:M,filterFrom:C,filterTo:P}))}map(f){if(f.empty||this.isEmpty)return this;let g=[],S=[],C=-1;for(let M=0;M<this.chunk.length;M++){let Z=this.chunkPos[M],U=this.chunk[M],he=f.touchesRange(Z,Z+U.length);if(he===!1)C=Math.max(C,U.maxPoint),g.push(U),S.push(f.mapPos(Z));else if(he===!0){let{mapped:ue,pos:Be}=U.map(Z,f);ue&&(C=Math.max(C,ue.maxPoint),g.push(ue),S.push(Be))}}let P=this.nextLayer.map(f);return g.length==0?P:new zn(S,g,P||zn.empty,C)}between(f,g,S){if(!this.isEmpty){for(let C=0;C<this.chunk.length;C++){let P=this.chunkPos[C],M=this.chunk[C];if(g>=P&&f<=P+M.length&&M.between(P,f-P,g-P,S)===!1)return}this.nextLayer.between(f,g,S)}}iter(f=0){return gr.from([this]).goto(f)}get isEmpty(){return this.nextLayer==this}static iter(f,g=0){return gr.from(f).goto(g)}static compare(f,g,S,C,P=-1){let M=f.filter(Be=>Be.maxPoint>0||!Be.isEmpty&&Be.maxPoint>=P),Z=g.filter(Be=>Be.maxPoint>0||!Be.isEmpty&&Be.maxPoint>=P),U=ri(M,Z,S),he=new Dn(M,U,P),ue=new Dn(Z,U,P);S.iterGaps((Be,ft,_e)=>yr(he,Be,ue,ft,_e,C)),S.empty&&S.length==0&&yr(he,0,ue,0,0,C)}static eq(f,g,S=0,C){C==null&&(C=1e9-1);let P=f.filter(ue=>!ue.isEmpty&&g.indexOf(ue)<0),M=g.filter(ue=>!ue.isEmpty&&f.indexOf(ue)<0);if(P.length!=M.length)return!1;if(!P.length)return!0;let Z=ri(P,M),U=new Dn(P,Z,0).goto(S),he=new Dn(M,Z,0).goto(S);for(;;){if(U.to!=he.to||!Gr(U.active,he.active)||U.point&&(!he.point||!U.point.eq(he.point)))return!1;if(U.to>C)return!0;U.next(),he.next()}}static spans(f,g,S,C,P=-1){let M=new Dn(f,null,P).goto(g),Z=g,U=M.openStart;for(;;){let he=Math.min(M.to,S);if(M.point){let ue=M.activeForPoint(M.to),Be=M.pointFrom<g?ue.length+1:Math.min(ue.length,U);C.point(Z,he,M.point,ue,Be,M.pointRank),U=Math.min(M.openEnd(he),ue.length)}else he>Z&&(C.span(Z,he,M.active,U),U=M.openEnd(he));if(M.to>S)return U+(M.point&&M.to>S?1:0);Z=M.to,M.next()}}static of(f,g=!1){let S=new $r;for(let C of f instanceof un?[f]:g?Hi(f):f)S.add(C.from,C.to,C.value);return S.finish()}}zn.empty=new zn([],[],null,-1);function Hi(j){if(j.length>1)for(let f=j[0],g=1;g<j.length;g++){let S=j[g];if(Xn(f,S)>0)return j.slice().sort(Xn);f=S}return j}zn.empty.nextLayer=zn.empty;class $r{finishChunk(f){this.chunks.push(new fr(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,f&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(f,g,S){this.addInner(f,g,S)||(this.nextLayer||(this.nextLayer=new $r)).add(f,g,S)}addInner(f,g,S){let C=f-this.lastTo||S.startSide-this.last.endSide;if(C<=0&&(f-this.lastFrom||S.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return C<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=f),this.from.push(f-this.chunkStart),this.to.push(g-this.chunkStart),this.last=S,this.lastFrom=f,this.lastTo=g,this.value.push(S),S.point&&(this.maxPoint=Math.max(this.maxPoint,g-f)),!0)}addChunk(f,g){if((f-this.lastTo||g.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,g.maxPoint),this.chunks.push(g),this.chunkPos.push(f);let S=g.value.length-1;return this.last=g.value[S],this.lastFrom=g.from[S]+f,this.lastTo=g.to[S]+f,!0}finish(){return this.finishInner(zn.empty)}finishInner(f){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return f;let g=zn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(f):f,this.setMaxPoint);return this.from=null,g}}function ri(j,f,g){let S=new Map;for(let P of j)for(let M=0;M<P.chunk.length;M++)P.chunk[M].maxPoint<=0&&S.set(P.chunk[M],P.chunkPos[M]);let C=new Set;for(let P of f)for(let M=0;M<P.chunk.length;M++){let Z=S.get(P.chunk[M]);Z!=null&&(g?g.mapPos(Z):Z)==P.chunkPos[M]&&!(g!=null&&g.touchesRange(Z,Z+P.chunk[M].length))&&C.add(P.chunk[M])}return C}class Ln{constructor(f,g,S,C=0){this.layer=f,this.skip=g,this.minPoint=S,this.rank=C}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(f,g=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(f,g,!1),this}gotoInner(f,g,S){for(;this.chunkIndex<this.layer.chunk.length;){let C=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(C)||this.layer.chunkEnd(this.chunkIndex)<f||C.maxPoint<this.minPoint))break;this.chunkIndex++,S=!1}if(this.chunkIndex<this.layer.chunk.length){let C=this.layer.chunk[this.chunkIndex].findIndex(f-this.layer.chunkPos[this.chunkIndex],g,!0);(!S||this.rangeIndex<C)&&this.setRangeIndex(C)}this.next()}forward(f,g){(this.to-f||this.endSide-g)<0&&this.gotoInner(f,g,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let f=this.layer.chunkPos[this.chunkIndex],g=this.layer.chunk[this.chunkIndex],S=f+g.from[this.rangeIndex];if(this.from=S,this.to=f+g.to[this.rangeIndex],this.value=g.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(f){if(f==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=f}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(f){return this.from-f.from||this.startSide-f.startSide||this.rank-f.rank||this.to-f.to||this.endSide-f.endSide}}class gr{constructor(f){this.heap=f}static from(f,g=null,S=-1){let C=[];for(let P=0;P<f.length;P++)for(let M=f[P];!M.isEmpty;M=M.nextLayer)M.maxPoint>=S&&C.push(new Ln(M,g,S,P));return C.length==1?C[0]:new gr(C)}get startSide(){return this.value?this.value.startSide:0}goto(f,g=-1e9){for(let S of this.heap)S.goto(f,g);for(let S=this.heap.length>>1;S>=0;S--)ai(this.heap,S);return this.next(),this}forward(f,g){for(let S of this.heap)S.forward(f,g);for(let S=this.heap.length>>1;S>=0;S--)ai(this.heap,S);(this.to-f||this.value.endSide-g)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let f=this.heap[0];this.from=f.from,this.to=f.to,this.value=f.value,this.rank=f.rank,f.value&&f.next(),ai(this.heap,0)}}}function ai(j,f){for(let g=j[f];;){let S=(f<<1)+1;if(S>=j.length)break;let C=j[S];if(S+1<j.length&&C.compare(j[S+1])>=0&&(C=j[S+1],S++),g.compare(C)<0)break;j[S]=g,j[f]=C,f=S}}class Dn{constructor(f,g,S){this.minPoint=S,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=gr.from(f,g,S)}goto(f,g=-1e9){return this.cursor.goto(f,g),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=f,this.endSide=g,this.openStart=-1,this.next(),this}forward(f,g){for(;this.minActive>-1&&(this.activeTo[this.minActive]-f||this.active[this.minActive].endSide-g)<0;)this.removeActive(this.minActive);this.cursor.forward(f,g)}removeActive(f){kn(this.active,f),kn(this.activeTo,f),kn(this.activeRank,f),this.minActive=qi(this.active,this.activeTo)}addActive(f){let g=0,{value:S,to:C,rank:P}=this.cursor;for(;g<this.activeRank.length&&this.activeRank[g]<=P;)g++;tr(this.active,g,S),tr(this.activeTo,g,C),tr(this.activeRank,g,P),f&&tr(f,g,this.cursor.from),this.minActive=qi(this.active,this.activeTo)}next(){let f=this.to,g=this.point;this.point=null;let S=this.openStart<0?[]:null;for(;;){let C=this.minActive;if(C>-1&&(this.activeTo[C]-this.cursor.from||this.active[C].endSide-this.cursor.startSide)<0){if(this.activeTo[C]>f){this.to=this.activeTo[C],this.endSide=this.active[C].endSide;break}this.removeActive(C),S&&kn(S,C)}else if(this.cursor.value)if(this.cursor.from>f){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let P=this.cursor.value;if(!P.point)this.addActive(S),this.cursor.next();else if(g&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=P,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=P.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(S){this.openStart=0;for(let C=S.length-1;C>=0&&S[C]<f;C--)this.openStart++}}activeForPoint(f){if(!this.active.length)return this.active;let g=[];for(let S=this.active.length-1;S>=0&&!(this.activeRank[S]<this.pointRank);S--)(this.activeTo[S]>f||this.activeTo[S]==f&&this.active[S].endSide>=this.point.endSide)&&g.push(this.active[S]);return g.reverse()}openEnd(f){let g=0;for(let S=this.activeTo.length-1;S>=0&&this.activeTo[S]>f;S--)g++;return g}}function yr(j,f,g,S,C,P){j.goto(f),g.goto(S);let M=S+C,Z=S,U=S-f;for(;;){let he=j.to+U-g.to||j.endSide-g.endSide,ue=he<0?j.to+U:g.to,Be=Math.min(ue,M);if(j.point||g.point?j.point&&g.point&&(j.point==g.point||j.point.eq(g.point))&&Gr(j.activeForPoint(j.to),g.activeForPoint(g.to))||P.comparePoint(Z,Be,j.point,g.point):Be>Z&&!Gr(j.active,g.active)&&P.compareRange(Z,Be,j.active,g.active),ue>M)break;Z=ue,he<=0&&j.next(),he>=0&&g.next()}}function Gr(j,f){if(j.length!=f.length)return!1;for(let g=0;g<j.length;g++)if(j[g]!=f[g]&&!j[g].eq(f[g]))return!1;return!0}function kn(j,f){for(let g=f,S=j.length-1;g<S;g++)j[g]=j[g+1];j.pop()}function tr(j,f,g){for(let S=j.length-1;S>=f;S--)j[S+1]=j[S];j[f]=g}function qi(j,f){let g=-1,S=1e9;for(let C=0;C<f.length;C++)(f[C]-S||j[C].endSide-j[g].endSide)<0&&(g=C,S=f[C]);return g}function Cr(j,f,g=j.length){let S=0;for(let C=0;C<g;)j.charCodeAt(C)==9?(S+=f-S%f,C++):(S++,C=It(j,C));return S}function Zn(j,f,g,S){for(let C=0,P=0;;){if(P>=f)return C;if(C==j.length)break;P+=j.charCodeAt(C)==9?g-P%g:1,C=It(j,C)}return S===!0?-1:j.length}},65329:function(Bn,pt,z){"use strict";z.d(pt,{p:function(){return wt},Nm:function(){return ue},tk:function(){return bn},SJ:function(){return ar},lg:function(){return Zn},l9:function(){return Jt},S2:function(){return ho},Uw:function(){return Ls},qr:function(){return ko},Sd:function(){return _n},gB:function(){return ie},v5:function(){return $o},ZO:function(){return Ro},HQ:function(){return sl},AE:function(){return to},bF:function(){return de},$f:function(){return Rt},Eu:function(){return rl},OO:function(){return kn},W$:function(){return Io},Zs:function(){return Xo},$1:function(){return ht},mH:function(){return Ai},hJ:function(){return a}});for(var v=z(1727),ke=z(37207),me={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},I={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},se=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Ne=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),De=0;De<10;De++)me[48+De]=me[96+De]=String(De);for(var De=1;De<=24;De++)me[De+111]="F"+De;for(var De=65;De<=90;De++)me[De]=String.fromCharCode(De+32),I[De]=String.fromCharCode(De);for(var Tt in me)I.hasOwnProperty(Tt)||(I[Tt]=me[Tt]);function rt(s){var e=se&&s.metaKey&&s.shiftKey&&!s.ctrlKey&&!s.altKey||Ne&&s.shiftKey&&s.key&&s.key.length==1||s.key=="Unidentified",t=!e&&s.key||(s.shiftKey?I:me)[s.keyCode]||s.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function st(s){let e;return s.nodeType==11?e=s.getSelection?s:s.ownerDocument:e=s,e.getSelection()}function He(s,e){return e?s==e||s.contains(e.nodeType!=1?e.parentNode:e):!1}function gt(s){let e=s.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function tt(s,e){if(!e.anchorNode)return!1;try{return He(s,e.anchorNode)}catch{return!1}}function Je(s){return s.nodeType==3?Ie(s,0,s.nodeValue.length).getClientRects():s.nodeType==1?s.getClientRects():[]}function It(s,e,t,r){return t?Me(s,e,t,r,-1)||Me(s,e,t,r,1):!1}function ee(s){for(var e=0;;e++)if(s=s.previousSibling,!s)return e}function Me(s,e,t,r,o){for(;;){if(s==t&&e==r)return!0;if(e==(o<0?0:ge(s))){if(s.nodeName=="DIV")return!1;let u=s.parentNode;if(!u||u.nodeType!=1)return!1;e=ee(s)+(o<0?0:1),s=u}else if(s.nodeType==1){if(s=s.childNodes[e+(o<0?-1:0)],s.nodeType==1&&s.contentEditable=="false")return!1;e=o<0?ge(s):0}else return!1}}function ge(s){return s.nodeType==3?s.nodeValue.length:s.childNodes.length}function je(s,e){let t=e?s.left:s.right;return{left:t,right:t,top:s.top,bottom:s.bottom}}function Ze(s){return{left:0,right:s.innerWidth,top:0,bottom:s.innerHeight}}function Oe(s,e,t,r,o,u,m,w){let A=s.ownerDocument,D=A.defaultView||window;for(let R=s,Y=!1;R&&!Y;)if(R.nodeType==1){let Q,ce=R==A.body;if(ce)Q=Ze(D);else{if(/^(fixed|sticky)$/.test(getComputedStyle(R).position)&&(Y=!0),R.scrollHeight<=R.clientHeight&&R.scrollWidth<=R.clientWidth){R=R.assignedSlot||R.parentNode;continue}let Le=R.getBoundingClientRect();Q={left:Le.left,right:Le.left+R.clientWidth,top:Le.top,bottom:Le.top+R.clientHeight}}let we=0,Qe=0;if(o=="nearest")e.top<Q.top?(Qe=-(Q.top-e.top+m),t>0&&e.bottom>Q.bottom+Qe&&(Qe=e.bottom-Q.bottom+Qe+m)):e.bottom>Q.bottom&&(Qe=e.bottom-Q.bottom+m,t<0&&e.top-Qe<Q.top&&(Qe=-(Q.top+Qe-e.top+m)));else{let Le=e.bottom-e.top,Ke=Q.bottom-Q.top;Qe=(o=="center"&&Le<=Ke?e.top+Le/2-Ke/2:o=="start"||o=="center"&&t<0?e.top-m:e.bottom-Ke+m)-Q.top}if(r=="nearest"?e.left<Q.left?(we=-(Q.left-e.left+u),t>0&&e.right>Q.right+we&&(we=e.right-Q.right+we+u)):e.right>Q.right&&(we=e.right-Q.right+u,t<0&&e.left<Q.left+we&&(we=-(Q.left+we-e.left+u))):we=(r=="center"?e.left+(e.right-e.left)/2-(Q.right-Q.left)/2:r=="start"==w?e.left-u:e.right-(Q.right-Q.left)+u)-Q.left,we||Qe)if(ce)D.scrollBy(we,Qe);else{let Le=0,Ke=0;if(Qe){let Vt=R.scrollTop;R.scrollTop+=Qe,Ke=R.scrollTop-Vt}if(we){let Vt=R.scrollLeft;R.scrollLeft+=we,Le=R.scrollLeft-Vt}e={left:e.left-Le,top:e.top-Ke,right:e.right-Le,bottom:e.bottom-Ke},Le&&Math.abs(Le-we)<1&&(r="nearest"),Ke&&Math.abs(Ke-Qe)<1&&(o="nearest")}if(ce)break;R=R.assignedSlot||R.parentNode}else if(R.nodeType==11)R=R.host;else break}function Xe(s){let e=s.ownerDocument;for(let t=s.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class Ye{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?ge(t):0),r,Math.min(e.focusOffset,r?ge(r):0))}set(e,t,r,o){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=o}}let K=null;function yt(s){if(s.setActive)return s.setActive();if(K)return s.focus(K);let e=[];for(let t=s;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(s.focus(K==null?{get preventScroll(){return K={preventScroll:!0},!0}}:void 0),!K){K=!1;for(let t=0;t<e.length;){let r=e[t++],o=e[t++],u=e[t++];r.scrollTop!=o&&(r.scrollTop=o),r.scrollLeft!=u&&(r.scrollLeft=u)}}}let le;function Ie(s,e,t=e){let r=le||(le=document.createRange());return r.setEnd(s,t),r.setStart(s,e),r}function ze(s,e,t){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0},o=new KeyboardEvent("keydown",r);o.synthetic=!0,s.dispatchEvent(o);let u=new KeyboardEvent("keyup",r);return u.synthetic=!0,s.dispatchEvent(u),o.defaultPrevented||u.defaultPrevented}function ot(s){for(;s;){if(s&&(s.nodeType==9||s.nodeType==11&&s.host))return s;s=s.assignedSlot||s.parentNode}return null}function Ae(s){for(;s.attributes.length;)s.removeAttributeNode(s.attributes[0])}function Ue(s,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,ge(t));;)if(r){if(t.nodeType!=1)return!1;let o=t.childNodes[r-1];o.contentEditable=="false"?r--:(t=o,r=ge(t))}else{if(t==s)return!0;r=ee(t),t=t.parentNode}}function Ge(s){return s.scrollTop>Math.max(1,s.scrollHeight-s.clientHeight-4)}class lt{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new lt(e.parentNode,ee(e),t)}static after(e,t){return new lt(e.parentNode,ee(e)+1,t)}}const ye=[];class xe{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let r=this.dom,o=null,u;for(let m of this.children){if(m.flags&7){if(!m.dom&&(u=o?o.nextSibling:r.firstChild)){let w=xe.get(u);(!w||!w.parent&&w.canReuseDOM(m))&&m.reuseDOM(u)}m.sync(e,t),m.flags&=-8}if(u=o?o.nextSibling:r.firstChild,t&&!t.written&&t.node==r&&u!=m.dom&&(t.written=!0),m.dom.parentNode==r)for(;u&&u!=m.dom;)u=We(u);else r.insertBefore(m.dom,u);o=m.dom}for(u=o?o.nextSibling:r.firstChild,u&&t&&t.node==r&&(t.written=!0);u;)u=We(u)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(e,t),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let r;if(e==this.dom)r=this.dom.childNodes[t];else{let o=ge(e)==0?0:t==0?-1:1;for(;;){let u=e.parentNode;if(u==this.dom)break;o==0&&u.firstChild!=u.lastChild&&(e==u.firstChild?o=-1:o=1),e=u}o<0?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!xe.get(r);)r=r.nextSibling;if(!r)return this.length;for(let o=0,u=0;;o++){let m=this.children[o];if(m.dom==r)return u;u+=m.length+m.breakAfter}}domBoundsAround(e,t,r=0){let o=-1,u=-1,m=-1,w=-1;for(let A=0,D=r,R=r;A<this.children.length;A++){let Y=this.children[A],Q=D+Y.length;if(D<e&&Q>t)return Y.domBoundsAround(e,t,D);if(Q>=e&&o==-1&&(o=A,u=D),D>t&&Y.dom.parentNode==this.dom){m=A,w=R;break}R=Q,D=Q+Y.breakAfter}return{from:u,to:w<0?r+this.length:w,startDOM:(o?this.children[o-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:m<this.children.length&&m>=0?this.children[m].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,r=ye){this.markDirty();for(let o=e;o<t;o++){let u=this.children[o];u.parent==this&&u.destroy()}this.children.splice(e,t-e,...r);for(let o=0;o<r.length;o++)r[o].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new vt(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,r,o,u,m){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){this.parent=null}}xe.prototype.breakAfter=0;function We(s){let e=s.nextSibling;return s.parentNode.removeChild(s),e}class vt{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function Pt(s,e,t,r,o,u,m,w,A){let{children:D}=s,R=D.length?D[e]:null,Y=u.length?u[u.length-1]:null,Q=Y?Y.breakAfter:m;if(!(e==r&&R&&!m&&!Q&&u.length<2&&R.merge(t,o,u.length?Y:null,t==0,w,A))){if(r<D.length){let ce=D[r];ce&&o<ce.length?(e==r&&(ce=ce.split(o),o=0),!Q&&Y&&ce.merge(0,o,Y,!0,0,A)?u[u.length-1]=ce:(o&&ce.merge(0,o,null,!1,0,A),u.push(ce))):ce!=null&&ce.breakAfter&&(Y?Y.breakAfter=1:m=1),r++}for(R&&(R.breakAfter=m,t>0&&(!m&&u.length&&R.merge(t,R.length,u[0],!1,w,0)?R.breakAfter=u.shift().breakAfter:(t<R.length||R.children.length&&R.children[R.children.length-1].length==0)&&R.merge(t,R.length,null,!1,w,0),e++));e<r&&u.length;)if(D[r-1].become(u[u.length-1]))r--,u.pop(),A=u.length?0:w;else if(D[e].become(u[0]))e++,u.shift(),w=u.length?0:A;else break;!u.length&&e&&r<D.length&&!D[e-1].breakAfter&&D[r].merge(0,0,D[e-1],!1,w,A)&&e--,(e<r||u.length)&&s.replaceChildren(e,r,u)}}function Wt(s,e,t,r,o,u){let m=s.childCursor(),{i:w,off:A}=m.findPos(t,1),{i:D,off:R}=m.findPos(e,-1),Y=e-t;for(let Q of r)Y+=Q.length;s.length+=Y,Pt(s,D,R,w,A,r,0,o,u)}const Zt="\uFFFF";class In{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(v.yy.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Zt}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let o=e;;){this.findPointBefore(r,o);let u=this.text.length;this.readNode(o);let m=o.nextSibling;if(m==t)break;let w=xe.get(o),A=xe.get(m);(w&&A?w.breakAfter:(w?w.breakAfter:xn(o))||xn(m)&&(o.nodeName!="BR"||o.cmIgnore)&&this.text.length>u)&&this.lineBreak(),o=m}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,o=this.lineSeparator?null:/\r\n?|\n/g;;){let u=-1,m=1,w;if(this.lineSeparator?(u=t.indexOf(this.lineSeparator,r),m=this.lineSeparator.length):(w=o.exec(t))&&(u=w.index,m=w[0].length),this.append(t.slice(r,u<0?t.length:u)),u<0)break;if(this.lineBreak(),m>1)for(let A of this.points)A.node==e&&A.pos>this.text.length&&(A.pos-=m-1);r=u+m}}readNode(e){if(e.cmIgnore)return;let t=xe.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let o=r.iter();!o.next().done;)o.lineBreak?this.lineBreak():this.append(o.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+Math.min(t,r.offset))}}function xn(s){return s.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(s.nodeName)}class er{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}let Lt=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},rn=typeof document!="undefined"?document:{documentElement:{style:{}}};const Ee=/Edge\/(\d+)/.exec(Lt.userAgent),O=/MSIE \d/.test(Lt.userAgent),N=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Lt.userAgent),W=!!(O||N||Ee),G=!W&&/gecko\/(\d+)/i.test(Lt.userAgent),ne=!W&&/Chrome\/(\d+)/.exec(Lt.userAgent),pe="webkitFontSmoothing"in rn.documentElement.style,Se=!W&&/Apple Computer/.test(Lt.vendor),$e=Se&&(/Mobile\/\w+/.test(Lt.userAgent)||Lt.maxTouchPoints>2);var ve={mac:$e||/Mac/.test(Lt.platform),windows:/Win/.test(Lt.platform),linux:/Linux|X11/.test(Lt.platform),ie:W,ie_version:O?rn.documentMode||6:N?+N[1]:Ee?+Ee[1]:0,gecko:G,gecko_version:G?+(/Firefox\/(\d+)/.exec(Lt.userAgent)||[0,0])[1]:0,chrome:!!ne,chrome_version:ne?+ne[1]:0,ios:$e,android:/Android\b/.test(Lt.userAgent),webkit:pe,safari:Se,webkit_version:pe?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:rn.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const ut=256;class St extends xe{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,r){return this.flags&8||r&&(!(r instanceof St)||this.length-(t-e)+r.length>ut||r.flags&8)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new St(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new lt(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return zt(this.dom,e,t)}}class at extends xe{constructor(e,t=[],r=0){super(),this.mark=e,this.children=t,this.length=r;for(let o of t)o.setParent(this)}setAttrs(e){if(Ae(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,r,o,u,m){return r&&(!(r instanceof at&&r.mark.eq(this.mark))||e&&u<=0||t<this.length&&m<=0)?!1:(Wt(this,e,t,r?r.children:[],u-1,m-1),this.markDirty(),!0)}split(e){let t=[],r=0,o=-1,u=0;for(let w of this.children){let A=r+w.length;A>e&&t.push(r<e?w.split(e-r):w),o<0&&r>=e&&(o=u),r=A,u++}let m=this.length-e;return this.length=e,o>-1&&(this.children.length=o,this.markDirty()),new at(this.mark,t,m)}domAtPos(e){return Jn(this,e)}coordsAt(e,t){return or(this,e,t)}}function zt(s,e,t){let r=s.nodeValue.length;e>r&&(e=r);let o=e,u=e,m=0;e==0&&t<0||e==r&&t>=0?ve.chrome||ve.gecko||(e?(o--,m=1):u<r&&(u++,m=-1)):t<0?o--:u<r&&u++;let w=Ie(s,o,u).getClientRects();if(!w.length)return null;let A=w[(m?m<0:t>=0)?0:w.length-1];return ve.safari&&!m&&A.width==0&&(A=Array.prototype.find.call(w,D=>D.width)||A),m?je(A,m<0):A||null}class Ft extends xe{constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}static create(e,t,r){return new Ft(e,t,r)}split(e){let t=Ft.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,r,o,u,m){return r&&(!(r instanceof Ft)||!this.widget.compare(r.widget)||e>0&&u<=0||t<this.length&&m<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}become(e){return e instanceof Ft&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return v.xv.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,r=t&&t.state.doc,o=this.posAtStart;return r?r.slice(o,o+this.length):v.xv.empty}domAtPos(e){return(this.length?e==0:this.side>0)?lt.before(this.dom):lt.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);if(r)return r;let o=this.dom.getClientRects(),u=null;if(!o.length)return null;let m=this.side?this.side<0:e>0;for(let w=m?o.length-1:0;u=o[w],!(e>0?w==0:w==o.length-1||u.top<u.bottom);w+=m?-1:1);return je(u,!m)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Qt extends xe{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Qt&&e.side==this.side}split(){return new Qt(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?lt.before(this.dom):lt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return v.xv.empty}get isHidden(){return!0}}St.prototype.children=Ft.prototype.children=Qt.prototype.children=ye;function Jn(s,e){let t=s.dom,{children:r}=s,o=0;for(let u=0;o<r.length;o++){let m=r[o],w=u+m.length;if(!(w==u&&m.getSide()<=0)){if(e>u&&e<w&&m.dom.parentNode==t)return m.domAtPos(e-u);if(e<=u)break;u=w}}for(let u=o;u>0;u--){let m=r[u-1];if(m.dom.parentNode==t)return m.domAtPos(m.length)}for(let u=o;u<r.length;u++){let m=r[u];if(m.dom.parentNode==t)return m.domAtPos(0)}return new lt(t,0)}function En(s,e,t){let r,{children:o}=s;t>0&&e instanceof at&&o.length&&(r=o[o.length-1])instanceof at&&r.mark.eq(e.mark)?En(r,e.children[0],t-1):(o.push(e),e.setParent(s)),s.length+=e.length}function or(s,e,t){let r=null,o=-1,u=null,m=-1;function w(D,R){for(let Y=0,Q=0;Y<D.children.length&&Q<=R;Y++){let ce=D.children[Y],we=Q+ce.length;we>=R&&(ce.children.length?w(ce,R-Q):(!u||u.isHidden&&t>0)&&(we>R||Q==we&&ce.getSide()>0)?(u=ce,m=R-Q):(Q<R||Q==we&&ce.getSide()<0&&!ce.isHidden)&&(r=ce,o=R-Q)),Q=we}}w(s,e);let A=(t<0?r:u)||r||u;return A?A.coordsAt(Math.max(0,A==r?o:m),t):Gt(s)}function Gt(s){let e=s.dom.lastChild;if(!e)return s.dom.getBoundingClientRect();let t=Je(e);return t[t.length-1]||null}function Mt(s,e){for(let t in s)t=="class"&&e.class?e.class+=" "+s.class:t=="style"&&e.style?e.style+=";"+s.style:e[t]=s[t];return e}const yn=Object.create(null);function Ct(s,e,t){if(s==e)return!0;s||(s=yn),e||(e=yn);let r=Object.keys(s),o=Object.keys(e);if(r.length-(t&&r.indexOf(t)>-1?1:0)!=o.length-(t&&o.indexOf(t)>-1?1:0))return!1;for(let u of r)if(u!=t&&(o.indexOf(u)==-1||s[u]!==e[u]))return!1;return!0}function Kt(s,e,t){let r=null;if(e)for(let o in e)t&&o in t||s.removeAttribute(r=o);if(t)for(let o in t)e&&e[o]==t[o]||s.setAttribute(r=o,t[o]);return!!r}function Xt(s){let e=Object.create(null);for(let t=0;t<s.attributes.length;t++){let r=s.attributes[t];e[r.name]=r.value}return e}class Jt{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}destroy(e){}}var bt=function(s){return s[s.Text=0]="Text",s[s.WidgetBefore=1]="WidgetBefore",s[s.WidgetAfter=2]="WidgetAfter",s[s.WidgetRange=3]="WidgetRange",s}(bt||(bt={}));class wt extends v.uU{constructor(e,t,r,o){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=o}get heightRelevant(){return!1}static mark(e){return new an(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Vn(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,o;if(e.isBlockGap)r=-5e8,o=4e8;else{let{start:u,end:m}=Hn(e,t);r=(u?t?-3e8:-1:5e8)-1,o=(m?t?2e8:1:-6e8)+1}return new Vn(e,r,o,t,e.widget||null,!0)}static line(e){return new hn(e)}static set(e,t=!1){return v.Xs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}wt.none=v.Xs.empty;class an extends wt{constructor(e){let{start:t,end:r}=Hn(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,r;return this==e||e instanceof an&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((r=e.attrs)===null||r===void 0?void 0:r.class))&&Ct(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}an.prototype.point=!1;class hn extends wt{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof hn&&this.spec.class==e.spec.class&&Ct(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}hn.prototype.mapMode=v.gc.TrackBefore,hn.prototype.point=!0;class Vn extends wt{constructor(e,t,r,o,u,m){super(t,r,u,e),this.block=o,this.isReplace=m,this.mapMode=o?t<=0?v.gc.TrackBefore:v.gc.TrackAfter:v.gc.TrackDel}get type(){return this.startSide<this.endSide?bt.WidgetRange:this.startSide<=0?bt.WidgetBefore:bt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Vn&&cr(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Vn.prototype.point=!0;function Hn(s,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=s;return t==null&&(t=s.inclusive),r==null&&(r=s.inclusive),{start:t!=null?t:e,end:r!=null?r:e}}function cr(s,e){return s==e||!!(s&&e&&s.compare(e))}function wr(s,e,t,r=0){let o=t.length-1;o>=0&&t[o]+r>=s?t[o]=Math.max(t[o],e):t.push(s,e)}class Bt extends xe{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,o,u,m){if(r){if(!(r instanceof Bt))return!1;this.dom||r.transferDOM(this)}return o&&this.setDeco(r?r.attrs:null),Wt(this,e,t,r?r.children:[],u,m),!0}split(e){let t=new Bt;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:r,off:o}=this.childPos(e);o&&(t.append(this.children[r].split(o),0),this.children[r].merge(o,this.children[r].length,null,!1,0,0),r++);for(let u=r;u<this.children.length;u++)t.append(this.children[u],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Ct(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){En(this,e,t)}addLineDeco(e){let t=e.spec.attributes,r=e.spec.class;t&&(this.attrs=Mt(t,this.attrs||{})),r&&(this.attrs=Mt({class:r},this.attrs||{}))}domAtPos(e){return Jn(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var r;this.dom?this.flags&4&&(Ae(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Kt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let o=this.dom.lastChild;for(;o&&xe.get(o)instanceof at;)o=o.lastChild;if(!o||!this.length||o.nodeName!="BR"&&((r=xe.get(o))===null||r===void 0?void 0:r.isEditable)==!1&&(!ve.ios||!this.children.some(u=>u instanceof St))){let u=document.createElement("BR");u.cmIgnore=!0,this.dom.appendChild(u)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let r of this.children){if(!(r instanceof St)||/[^ -~]/.test(r.text))return null;let o=Je(r.dom);if(o.length!=1)return null;e+=o[0].width,t=o[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let r=or(this,e,t);if(!this.children.length&&r&&this.parent){let{heightOracle:o}=this.parent.view.viewState,u=r.bottom-r.top;if(Math.abs(u-o.lineHeight)<2&&o.textHeight<u){let m=(u-o.textHeight)/2;return{top:r.top+m,bottom:r.bottom-m,left:r.left,right:r.left}}}return r}become(e){return!1}get type(){return bt.Text}static find(e,t){for(let r=0,o=0;r<e.children.length;r++){let u=e.children[r],m=o+u.length;if(m>=t){if(u instanceof Bt)return u;if(m>t)break}o=m+u.breakAfter}return null}}class Pn extends xe{constructor(e,t,r){super(),this.widget=e,this.length=t,this.type=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,o,u,m){return r&&(!(r instanceof Pn)||!this.widget.compare(r.widget)||e>0&&u<=0||t<this.length&&m<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?lt.before(this.dom):lt.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let r=new Pn(this.widget,t,this.type);return r.breakAfter=this.breakAfter,r}get children(){return ye}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):v.xv.empty}domBoundsAround(){return null}become(e){return e instanceof Pn&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.type=e.type,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Yt{constructor(e,t,r,o){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=o,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof Pn&&e.type==bt.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Bt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(un(new Qt(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,t,r){for(;e>0;){if(this.textOff==this.text.length){let{value:u,lineBreak:m,done:w}=this.cursor.next(this.skip);if(this.skip=0,w)throw new Error("Ran out of text content when drawing inline views");if(m){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=u,this.textOff=0}let o=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-r)),this.getLine().append(un(new St(this.text.slice(this.textOff,this.textOff+o)),t),r),this.atCursorPos=!0,this.textOff+=o,e-=o,r=0}}span(e,t,r,o){this.buildText(t-e,r,o),this.pos=t,this.openStart<0&&(this.openStart=o)}point(e,t,r,o,u,m){if(this.disallowBlockEffectsFor[m]&&r instanceof Vn){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let w=t-e;if(r instanceof Vn)if(r.block){let{type:A}=r;A==bt.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Pn(r.widget||new Xn("div"),w,A))}else{let A=Ft.create(r.widget||new Xn("span"),w,w?0:r.startSide),D=this.atCursorPos&&!A.isEditable&&u<=o.length&&(e<t||r.startSide>0),R=!A.isEditable&&(e<t||u>o.length||r.startSide<=0),Y=this.getLine();this.pendingBuffer==2&&!D&&!A.isEditable&&(this.pendingBuffer=0),this.flushBuffer(o),D&&(Y.append(un(new Qt(1),o),u),u=o.length+Math.max(0,u-o.length)),Y.append(un(A,o),u),this.atCursorPos=R,this.pendingBuffer=R?e<t||u>o.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=o.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);w&&(this.textOff+w<=this.text.length?this.textOff+=w:(this.skip+=w-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=u)}static build(e,t,r,o,u){let m=new Yt(e,t,r,u);return m.openEnd=v.Xs.spans(o,t,r,m),m.openStart<0&&(m.openStart=m.openEnd),m.finish(m.openEnd),m}}function un(s,e){for(let t of e)s=new at(t,[s],s.length);return s}class Xn extends Jt{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const fr=v.r$.define(),zn=v.r$.define(),Hi=v.r$.define(),$r=v.r$.define(),ri=v.r$.define(),Ln=v.r$.define(),gr=v.r$.define(),ai=v.r$.define({combine:s=>s.some(e=>e)}),Dn=v.r$.define({combine:s=>s.some(e=>e)});class yr{constructor(e,t="nearest",r="nearest",o=5,u=5){this.range=e,this.y=t,this.x=r,this.yMargin=o,this.xMargin=u}map(e){return e.empty?this:new yr(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const Gr=v.Py.define({map:(s,e)=>s.map(e)});function kn(s,e,t){let r=s.facet($r);r.length?r[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const tr=v.r$.define({combine:s=>s.length?s[0]:!0});let qi=0;const Cr=v.r$.define();class Zn{constructor(e,t,r,o){this.id=e,this.create=t,this.domEventHandlers=r,this.extension=o(this)}static define(e,t){const{eventHandlers:r,provide:o,decorations:u}=t||{};return new Zn(qi++,e,r,m=>{let w=[Cr.of(m)];return u&&w.push(S.of(A=>{let D=A.plugin(m);return D?u(D):wt.none})),o&&w.push(o(m)),w})}static fromClass(e,t){return Zn.define(r=>new e(r),t)}}class j{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(kn(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){kn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){kn(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const f=v.r$.define(),g=v.r$.define(),S=v.r$.define(),C=v.r$.define(),P=v.r$.define();function M(s){let e=0,t=0,r=0,o=0;for(let u of s.state.facet(P)){let m=u(s);m&&(m.left!=null&&(e=Math.max(e,m.left)),m.right!=null&&(t=Math.max(t,m.right)),m.top!=null&&(r=Math.max(r,m.top)),m.bottom!=null&&(o=Math.max(o,m.bottom)))}return{left:e,right:t,top:r,bottom:o}}const Z=v.r$.define();class U{constructor(e,t,r,o){this.fromA=e,this.toA=t,this.fromB=r,this.toB=o}join(e){return new U(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let o=e[t-1];if(!(o.fromA>r.toA)){if(o.toA<r.fromA)break;r=r.join(o),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let o=0,u=0,m=0,w=0;;o++){let A=o==e.length?null:e[o],D=m-w,R=A?A.fromB:1e9;for(;u<t.length&&t[u]<R;){let Y=t[u],Q=t[u+1],ce=Math.max(w,Y),we=Math.min(R,Q);if(ce<=we&&new U(ce+D,we+D,ce,we).addToSet(r),Q>R)break;u+=2}if(!A)return r;new U(A.fromA,A.toA,A.fromB,A.toB).addToSet(r),m=A.toA,w=A.toB}}}class he{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=v.as.empty(this.startState.doc.length);for(let u of r)this.changes=this.changes.compose(u.changes);let o=[];this.changes.iterChangedRanges((u,m,w,A)=>o.push(new U(u,m,w,A))),this.changedRanges=o}static create(e,t,r){return new he(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var ue=function(s){return s[s.LTR=0]="LTR",s[s.RTL=1]="RTL",s}(ue||(ue={}));const Be=ue.LTR,ft=ue.RTL;function _e(s){let e=[];for(let t=0;t<s.length;t++)e.push(1<<+s[t]);return e}const on=_e("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Gn=_e("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),sn=Object.create(null),Rn=[];for(let s of["()","[]","{}"]){let e=s.charCodeAt(0),t=s.charCodeAt(1);sn[e]=t,sn[t]=-e}function Vr(s){return s<=247?on[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Gn[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203?256:64336<=s&&s<=65023?4:s==8204?256:1}const Di=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class nr{constructor(e,t,r){this.from=e,this.to=t,this.level=r}get dir(){return this.level%2?ft:Be}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,r,o){let u=-1;for(let m=0;m<e.length;m++){let w=e[m];if(w.from<=t&&w.to>=t){if(w.level==r)return m;(u<0||(o!=0?o<0?w.from<t:w.to>t:e[u].level>w.level))&&(u=m)}}if(u<0)throw new RangeError("Index out of range");return u}}const Sn=[];function Ri(s,e){let t=s.length,r=e==Be?1:2,o=e==Be?2:1;if(!s||r==1&&!Di.test(s))return Ii(t);for(let m=0,w=r,A=r;m<t;m++){let D=Vr(s.charCodeAt(m));D==512?D=w:D==8&&A==4&&(D=16),Sn[m]=D==4?2:D,D&7&&(A=D),w=D}for(let m=0,w=r,A=r;m<t;m++){let D=Sn[m];if(D==128)m<t-1&&w==Sn[m+1]&&w&24?D=Sn[m]=w:Sn[m]=256;else if(D==64){let R=m+1;for(;R<t&&Sn[R]==64;)R++;let Y=m&&w==8||R<t&&Sn[R]==8?A==1?1:8:256;for(let Q=m;Q<R;Q++)Sn[Q]=Y;m=R-1}else D==8&&A==1&&(Sn[m]=1);w=D,D&7&&(A=D)}for(let m=0,w=0,A=0,D,R,Y;m<t;m++)if(R=sn[D=s.charCodeAt(m)])if(R<0){for(let Q=w-3;Q>=0;Q-=3)if(Rn[Q+1]==-R){let ce=Rn[Q+2],we=ce&2?r:ce&4?ce&1?o:r:0;we&&(Sn[m]=Sn[Rn[Q]]=we),w=Q;break}}else{if(Rn.length==189)break;Rn[w++]=m,Rn[w++]=D,Rn[w++]=A}else if((Y=Sn[m])==2||Y==1){let Q=Y==r;A=Q?0:1;for(let ce=w-3;ce>=0;ce-=3){let we=Rn[ce+2];if(we&2)break;if(Q)Rn[ce+2]|=2;else{if(we&4)break;Rn[ce+2]|=4}}}for(let m=0;m<t;m++)if(Sn[m]==256){let w=m+1;for(;w<t&&Sn[w]==256;)w++;let A=(m?Sn[m-1]:r)==1,D=(w<t?Sn[w]:r)==1,R=A==D?A?1:2:r;for(let Y=m;Y<w;Y++)Sn[Y]=R;m=w-1}let u=[];if(r==1)for(let m=0;m<t;){let w=m,A=Sn[m++]!=1;for(;m<t&&A==(Sn[m]!=1);)m++;if(A)for(let D=m;D>w;){let R=D,Y=Sn[--D]!=2;for(;D>w&&Y==(Sn[D-1]!=2);)D--;u.push(new nr(D,R,Y?2:1))}else u.push(new nr(w,m,0))}else for(let m=0;m<t;){let w=m,A=Sn[m++]==2;for(;m<t&&A==(Sn[m]==2);)m++;u.push(new nr(w,m,A?1:2))}return u}function Ii(s){return[new nr(0,s,0)]}let ci="";function bi(s,e,t,r,o){var u;let m=r.head-s.from,w=-1;if(m==0){if(!o||!s.length)return null;e[0].level!=t&&(m=e[0].side(!1,t),w=0)}else if(m==s.length){if(o)return null;let Q=e[e.length-1];Q.level!=t&&(m=Q.side(!0,t),w=e.length-1)}w<0&&(w=nr.find(e,m,(u=r.bidiLevel)!==null&&u!==void 0?u:-1,r.assoc));let A=e[w];m==A.side(o,t)&&(A=e[w+=o?1:-1],m=A.side(!o,t));let D=o==(A.dir==t),R=(0,v.cp)(s.text,m,D);if(ci=s.text.slice(Math.min(m,R),Math.max(m,R)),R!=A.side(o,t))return v.jT.cursor(R+s.from,D?-1:1,A.level);let Y=w==(o?e.length-1:0)?null:e[w+(o?1:-1)];return!Y&&A.level!=t?v.jT.cursor(o?s.to:s.from,o?-1:1,t):Y&&Y.level<A.level?v.jT.cursor(Y.side(!o,t)+s.from,o?1:-1,Y.level):v.jT.cursor(R+s.from,o?-1:1,A.level)}class _i extends xe{constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Bt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new U(0,0,0,e.state.doc.length)],0,null)}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:w,toA:A})=>A<this.minWidthFrom||w>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let r=this.view.inputState.composing<0?null:$(this.view,e.changes);if(this.hasComposition){this.markedForComposition.clear();let{from:w,to:A}=this.hasComposition;t=new U(w,A,e.changes.mapPos(w,-1),e.changes.mapPos(A,1)).addToSet(t.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(ve.ie||ve.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,u=this.updateDeco(),m=Re(o,u,e.changes);return t=U.extendWithRanges(t,m),!(this.flags&7)&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,r);let{observer:o}=this.view;o.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let m=ve.chrome||ve.ios?{node:o.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,m),this.flags&=-8,m&&(m.written||o.selectionRange.focusNode!=m.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(m=>m.flags&=-9);let u=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let m of this.children)m instanceof Pn&&m.widget instanceof b&&u.push(m.dom);o.updateGaps(u)}updateChildren(e,t,r){let o=r?r.range.addToSet(e.slice()):e,u=this.childCursor(t);for(let m=o.length-1;;m--){let w=m>=0?o[m]:null;if(!w)break;let{fromA:A,toA:D,fromB:R,toB:Y}=w,Q,ce,we,Qe;if(r&&r.range.fromB<Y&&r.range.toB>R){let $t=Yt.build(this.view.state.doc,R,r.range.fromB,this.decorations,this.dynamicDecorationMap),tn=Yt.build(this.view.state.doc,r.range.toB,Y,this.decorations,this.dynamicDecorationMap);ce=$t.breakAtStart,we=$t.openStart,Qe=tn.openEnd;let et=this.compositionView(r);tn.breakAtStart?et.breakAfter=1:tn.content.length&&et.merge(et.length,et.length,tn.content[0],!1,tn.openStart,0)&&(et.breakAfter=tn.content[0].breakAfter,tn.content.shift()),$t.content.length&&et.merge(0,0,$t.content[$t.content.length-1],!0,0,$t.openEnd)&&$t.content.pop(),Q=$t.content.concat(et).concat(tn.content)}else({content:Q,breakAtStart:ce,openStart:we,openEnd:Qe}=Yt.build(this.view.state.doc,R,Y,this.decorations,this.dynamicDecorationMap));let{i:Le,off:Ke}=u.findPos(D,1),{i:Vt,off:gn}=u.findPos(A,-1);Pt(this,Vt,gn,Le,Ke,Q,ce,we,Qe)}r&&this.fixCompositionDOM(r)}compositionView(e){let t=new St(e.text.nodeValue);t.flags|=8;for(let{deco:o}of e.marks)t=new at(o,[t],t.length);let r=new Bt;return r.append(t,0),r}fixCompositionDOM(e){let t=(u,m)=>{m.flags|=8,this.markedForComposition.add(m);let w=xe.get(u);w!=m&&(w&&(w.dom=null),m.setDOM(u))},r=this.childPos(e.range.fromB,1),o=this.children[r.i];t(e.line,o);for(let u=e.marks.length-1;u>=-1;u--)r=o.childPos(r.off,1),o=o.children[r.i],t(u>=0?e.marks[u].node:e.text,o)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,o=r==this.dom,u=!o&&tt(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(o||t||u))return;let m=this.forceSelection;this.forceSelection=!1;let w=this.view.state.selection.main,A=this.domAtPos(w.anchor),D=w.empty?A:this.domAtPos(w.head);if(ve.gecko&&w.empty&&!this.hasComposition&&B(A)){let Y=document.createTextNode("");this.view.observer.ignore(()=>A.node.insertBefore(Y,A.node.childNodes[A.offset]||null)),A=D=new lt(Y,0),m=!0}let R=this.view.observer.selectionRange;(m||!R.focusNode||!It(A.node,A.offset,R.anchorNode,R.anchorOffset)||!It(D.node,D.offset,R.focusNode,R.focusOffset))&&(this.view.observer.ignore(()=>{ve.android&&ve.chrome&&this.dom.contains(R.focusNode)&&Te(R.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let Y=st(this.view.root);if(Y)if(w.empty){if(ve.gecko){let Q=te(A.node,A.offset);if(Q&&Q!=3){let ce=H(A.node,A.offset,Q==1?1:-1);ce&&(A=new lt(ce,Q==1?0:ce.nodeValue.length))}}Y.collapse(A.node,A.offset),w.bidiLevel!=null&&R.cursorBidiLevel!=null&&(R.cursorBidiLevel=w.bidiLevel)}else if(Y.extend){Y.collapse(A.node,A.offset);try{Y.extend(D.node,D.offset)}catch{}}else{let Q=document.createRange();w.anchor>w.head&&([A,D]=[D,A]),Q.setEnd(D.node,D.offset),Q.setStart(A.node,A.offset),Y.removeAllRanges(),Y.addRange(Q)}u&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(A,D)),this.impreciseAnchor=A.precise?null:new lt(R.anchorNode,R.anchorOffset),this.impreciseHead=D.precise?null:new lt(R.focusNode,R.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=st(e.root),{anchorNode:o,anchorOffset:u}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let m=Bt.find(this,t.head);if(!m)return;let w=m.posAtStart;if(t.head==w||t.head==w+m.length)return;let A=this.coordsAt(t.head,-1),D=this.coordsAt(t.head,1);if(!A||!D||A.bottom>D.top)return;let R=this.domAtPos(t.head+t.assoc);r.collapse(R.node,R.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let Y=e.observer.selectionRange;e.docView.posFromDOM(Y.anchorNode,Y.anchorOffset)!=t.from&&r.collapse(o,u)}nearest(e){for(let t=e;t;){let r=xe.get(t);if(r&&r.rootView==this)return r;t=t.parentNode}return null}posFromDOM(e,t){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let o=this.children[t];if(r<o.length||o instanceof Bt)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(e,t){for(let r=this.length,o=this.children.length-1;;o--){let u=this.children[o],m=r-u.breakAfter-u.length;if(e>m||e==m&&u.type!=bt.WidgetBefore&&u.type!=bt.WidgetAfter&&(!o||t==2||this.children[o-1].breakAfter||this.children[o-1].type==bt.WidgetBefore&&t>-2))return u.coordsAt(e-m,t);r=m}}coordsForChar(e){let{i:t,off:r}=this.childPos(e,1),o=this.children[t];if(!(o instanceof Bt))return null;for(;o.children.length;){let{i:w,off:A}=o.childPos(r,1);for(;;w++){if(w==o.children.length)return null;if((o=o.children[w]).length)break}r=A}if(!(o instanceof St))return null;let u=(0,v.cp)(o.text,r);if(u==r)return null;let m=Ie(o.dom,r,u).getClientRects();return!m.length||m[0].top>=m[0].bottom?null:m[0]}measureVisibleLineHeights(e){let t=[],{from:r,to:o}=e,u=this.view.contentDOM.clientWidth,m=u>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,w=-1,A=this.view.textDirection==ue.LTR;for(let D=0,R=0;R<this.children.length;R++){let Y=this.children[R],Q=D+Y.length;if(Q>o)break;if(D>=r){let ce=Y.dom.getBoundingClientRect();if(t.push(ce.height),m){let we=Y.dom.lastChild,Qe=we?Je(we):[];if(Qe.length){let Le=Qe[Qe.length-1],Ke=A?Le.right-ce.left:ce.right-Le.left;Ke>w&&(w=Ke,this.minWidth=u,this.minWidthFrom=D,this.minWidthTo=Q)}}}D=Q+Y.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?ue.RTL:ue.LTR}measureTextSize(){for(let u of this.children)if(u instanceof Bt){let m=u.measureTextSize();if(m)return m}let e=document.createElement("div"),t,r,o;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let u=Je(e.firstChild)[0];t=e.getBoundingClientRect().height,r=u?u.width/27:7,o=u?u.height:t,e.remove()}),{lineHeight:t,charWidth:r,textHeight:o}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new vt(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,o=0;;o++){let u=o==t.viewports.length?null:t.viewports[o],m=u?u.from-1:this.length;if(m>r){let w=t.lineBlockAt(m).bottom-t.lineBlockAt(r).top;e.push(wt.replace({widget:new b(w),block:!0,inclusive:!0,isBlockGap:!0}).range(r,m))}if(!u)break;r=u.to+1}return wt.set(e)}updateDeco(){let e=this.view.state.facet(S).map((t,r)=>(this.dynamicDecorationMap[r]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),o;if(!r)return;!t.empty&&(o=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,o.left),top:Math.min(r.top,o.top),right:Math.max(r.right,o.right),bottom:Math.max(r.bottom,o.bottom)});let u=M(this.view),m={left:r.left-u.left,top:r.top-u.top,right:r.right+u.right,bottom:r.bottom+u.bottom};Oe(this.view.scrollDOM,m,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==ue.LTR)}}function B(s){return s.node.nodeType==1&&s.node.firstChild&&(s.offset==0||s.node.childNodes[s.offset-1].contentEditable=="false")&&(s.offset==s.node.childNodes.length||s.node.childNodes[s.offset].contentEditable=="false")}class b extends Jt{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function k(s){let e=s.observer.selectionRange,t=e.focusNode&&H(e.focusNode,e.focusOffset,0);if(!t)return null;let r=xe.get(t),o,u;if(r instanceof St)o=r.posAtStart,u=o+r.length;else{e:for(let m=0,w=t;;){for(let D=w.previousSibling,R;D;D=D.previousSibling){if(R=xe.get(D)){o=u=R.posAtEnd+m;break e}let Y=new In([],s.state);if(Y.readNode(D),Y.text.indexOf(Zt)>-1)return null;m+=Y.text.length}if(w=w.parentNode,!w)return null;let A=xe.get(w);if(A){o=u=A.posAtStart+m;break}}}return{from:o,to:u,node:t}}function $(s,e){let t=k(s);if(!t)return null;let{from:r,to:o,node:u}=t,m=e.mapPos(r,-1),w=e.mapPos(o,1),A=u.nodeValue;if(/[\n\r]/.test(A))return null;if(w-m!=A.length){let Q=e.mapPos(r,1),ce=e.mapPos(o,-1);if(ce-Q==A.length)m=Q,w=ce;else if(s.state.doc.sliceString(w-A.length,w)==A)m=w-A.length;else if(s.state.doc.sliceString(m,m+A.length)==A)w=m+A.length;else return null}let{main:D}=s.state.selection;if(s.state.doc.sliceString(m,w)!=A||m>D.head||w<D.head)return null;let R=[],Y=new U(r,o,m,w);for(let Q=u.parentNode;;Q=Q.parentNode){let ce=xe.get(Q);if(ce instanceof at)R.push({node:Q,deco:ce.mark});else{if(ce instanceof Bt||Q.nodeName=="DIV"&&Q.parentNode==s.contentDOM)return{range:Y,text:u,marks:R,line:Q};if(Q!=s.contentDOM)R.push({node:Q,deco:new an({inclusive:!0,attributes:Xt(Q),tagName:Q.tagName.toLowerCase()})});else return null}}}function H(s,e,t){if(t<=0)for(let r=s,o=e;;){if(r.nodeType==3)return r;if(r.nodeType==1&&o>0)r=r.childNodes[o-1],o=ge(r);else break}if(t>=0)for(let r=s,o=e;;){if(r.nodeType==3)return r;if(r.nodeType==1&&o<r.childNodes.length&&t>=0)r=r.childNodes[o],o=0;else break}return null}function te(s,e){return s.nodeType!=1?0:(e&&s.childNodes[e-1].contentEditable=="false"?1:0)|(e<s.childNodes.length&&s.childNodes[e].contentEditable=="false"?2:0)}class oe{constructor(){this.changes=[]}compareRange(e,t){wr(e,t,this.changes)}comparePoint(e,t){wr(e,t,this.changes)}}function Re(s,e,t){let r=new oe;return v.Xs.compare(s,e,t,r),r.changes}function Te(s,e){for(let t=s;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function kt(s,e,t=1){let r=s.charCategorizer(e),o=s.doc.lineAt(e),u=e-o.from;if(o.length==0)return v.jT.cursor(e);u==0?t=1:u==o.length&&(t=-1);let m=u,w=u;t<0?m=(0,v.cp)(o.text,u,!1):w=(0,v.cp)(o.text,u);let A=r(o.text.slice(m,w));for(;m>0;){let D=(0,v.cp)(o.text,m,!1);if(r(o.text.slice(D,m))!=A)break;m=D}for(;w<o.length;){let D=(0,v.cp)(o.text,w);if(r(o.text.slice(w,D))!=A)break;w=D}return v.jT.range(m+o.from,w+o.from)}function Ot(s,e){return e.left>s?e.left-s:Math.max(0,s-e.right)}function cn(s,e){return e.top>s?e.top-s:Math.max(0,s-e.bottom)}function Yn(s,e){return s.top<e.bottom-1&&s.bottom>e.top+1}function Qn(s,e){return e<s.top?{top:e,left:s.left,right:s.right,bottom:s.bottom}:s}function vr(s,e){return e>s.bottom?{top:s.top,left:s.left,right:s.right,bottom:e}:s}function Un(s,e,t){let r,o,u,m,w=!1,A,D,R,Y;for(let we=s.firstChild;we;we=we.nextSibling){let Qe=Je(we);for(let Le=0;Le<Qe.length;Le++){let Ke=Qe[Le];o&&Yn(o,Ke)&&(Ke=Qn(vr(Ke,o.bottom),o.top));let Vt=Ot(e,Ke),gn=cn(t,Ke);if(Vt==0&&gn==0)return we.nodeType==3?xi(we,e,t):Un(we,e,t);if(!r||m>gn||m==gn&&u>Vt){r=we,o=Ke,u=Vt,m=gn;let $t=gn?t<Ke.top?-1:1:Vt?e<Ke.left?-1:1:0;w=!$t||($t>0?Le<Qe.length-1:Le>0)}Vt==0?t>Ke.bottom&&(!R||R.bottom<Ke.bottom)?(A=we,R=Ke):t<Ke.top&&(!Y||Y.top>Ke.top)&&(D=we,Y=Ke):R&&Yn(R,Ke)?R=vr(R,Ke.bottom):Y&&Yn(Y,Ke)&&(Y=Qn(Y,Ke.top))}}if(R&&R.bottom>=t?(r=A,o=R):Y&&Y.top<=t&&(r=D,o=Y),!r)return{node:s,offset:0};let Q=Math.max(o.left,Math.min(o.right,e));if(r.nodeType==3)return xi(r,Q,t);if(w&&r.contentEditable!="false")return Un(r,Q,t);let ce=Array.prototype.indexOf.call(s.childNodes,r)+(e>=(o.left+o.right)/2?1:0);return{node:s,offset:ce}}function xi(s,e,t){let r=s.nodeValue.length,o=-1,u=1e9,m=0;for(let w=0;w<r;w++){let A=Ie(s,w,w+1).getClientRects();for(let D=0;D<A.length;D++){let R=A[D];if(R.top==R.bottom)continue;m||(m=e-R.left);let Y=(R.top>t?R.top-t:t-R.bottom)-1;if(R.left-1<=e&&R.right+1>=e&&Y<u){let Q=e>=(R.left+R.right)/2,ce=Q;if((ve.chrome||ve.gecko)&&Ie(s,w).getBoundingClientRect().left==R.right&&(ce=!Q),Y<=0)return{node:s,offset:w+(ce?1:0)};o=w+(ce?1:0),u=Y}}}return{node:s,offset:o>-1?o:m>0?s.nodeValue.length:0}}function Si(s,e,t,r=-1){var o,u;let m=s.contentDOM.getBoundingClientRect(),w=m.top+s.viewState.paddingTop,A,{docHeight:D}=s.viewState,{x:R,y:Y}=e,Q=Y-w;if(Q<0)return 0;if(Q>D)return s.state.doc.length;for(let $t=s.viewState.heightOracle.textHeight/2,tn=!1;A=s.elementAtHeight(Q),A.type!=bt.Text;)for(;Q=r>0?A.bottom+$t:A.top-$t,!(Q>=0&&Q<=D);){if(tn)return t?null:0;tn=!0,r=-r}Y=w+Q;let ce=A.from;if(ce<s.viewport.from)return s.viewport.from==0?0:t?null:ms(s,m,A,R,Y);if(ce>s.viewport.to)return s.viewport.to==s.state.doc.length?s.state.doc.length:t?null:ms(s,m,A,R,Y);let we=s.dom.ownerDocument,Qe=s.root.elementFromPoint?s.root:we,Le=Qe.elementFromPoint(R,Y);Le&&!s.contentDOM.contains(Le)&&(Le=null),Le||(R=Math.max(m.left+1,Math.min(m.right-1,R)),Le=Qe.elementFromPoint(R,Y),Le&&!s.contentDOM.contains(Le)&&(Le=null));let Ke,Vt=-1;if(Le&&((o=s.docView.nearest(Le))===null||o===void 0?void 0:o.isEditable)!=!1){if(we.caretPositionFromPoint){let $t=we.caretPositionFromPoint(R,Y);$t&&({offsetNode:Ke,offset:Vt}=$t)}else if(we.caretRangeFromPoint){let $t=we.caretRangeFromPoint(R,Y);$t&&({startContainer:Ke,startOffset:Vt}=$t,(!s.contentDOM.contains(Ke)||ve.safari&&Ws(Ke,Vt,R)||ve.chrome&&Hs(Ke,Vt,R))&&(Ke=void 0))}}if(!Ke||!s.docView.dom.contains(Ke)){let $t=Bt.find(s.docView,ce);if(!$t)return Q>A.top+A.height/2?A.to:A.from;({node:Ke,offset:Vt}=Un($t.dom,R,Y))}let gn=s.docView.nearest(Ke);if(!gn)return null;if(gn.isWidget&&((u=gn.dom)===null||u===void 0?void 0:u.nodeType)==1){let $t=gn.dom.getBoundingClientRect();return e.y<$t.top||e.y<=$t.bottom&&e.x<=($t.left+$t.right)/2?gn.posAtStart:gn.posAtEnd}else return gn.localPosFromDOM(Ke,Vt)+gn.posAtStart}function ms(s,e,t,r,o){let u=Math.round((r-e.left)*s.defaultCharacterWidth);if(s.lineWrapping&&t.height>s.defaultLineHeight*1.5){let w=s.viewState.heightOracle.textHeight,A=Math.floor((o-t.top-(s.defaultLineHeight-w)*.5)/w);u+=A*s.viewState.heightOracle.lineLength}let m=s.state.sliceDoc(t.from,t.to);return t.from+(0,v.Gz)(m,u,s.state.tabSize)}function Ws(s,e,t){let r;if(s.nodeType!=3||e!=(r=s.nodeValue.length))return!1;for(let o=s.nextSibling;o;o=o.nextSibling)if(o.nodeType!=1||o.nodeName!="BR")return!1;return Ie(s,r-1,r).getBoundingClientRect().left>t}function Hs(s,e,t){if(e!=0)return!1;for(let o=s;;){let u=o.parentNode;if(!u||u.nodeType!=1||u.firstChild!=o)return!1;if(u.classList.contains("cm-line"))break;o=u}let r=s.nodeType==1?s.getBoundingClientRect():Ie(s,0,Math.max(s.nodeValue.length,1)).getBoundingClientRect();return t-r.left>5}function es(s,e){let t=s.lineBlockAt(e);if(Array.isArray(t.type)){for(let r of t.type)if(r.to>e||r.to==e&&(r.to==t.to||r.type==bt.Text))return r}return t}function As(s,e,t,r){let o=es(s,e.head),u=!r||o.type!=bt.Text||!(s.lineWrapping||o.widgetLineBreaks)?null:s.coordsAtPos(e.assoc<0&&e.head>o.from?e.head-1:e.head);if(u){let m=s.dom.getBoundingClientRect(),w=s.textDirectionAt(o.from),A=s.posAtCoords({x:t==(w==ue.LTR)?m.right-1:m.left+1,y:(u.top+u.bottom)/2});if(A!=null)return v.jT.cursor(A,t?-1:1)}return v.jT.cursor(t?o.to:o.from,t?-1:1)}function zs(s,e,t,r){let o=s.state.doc.lineAt(e.head),u=s.bidiSpans(o),m=s.textDirectionAt(o.from);for(let w=e,A=null;;){let D=bi(o,u,m,w,t),R=ci;if(!D){if(o.number==(t?s.state.doc.lines:1))return w;R=`
`,o=s.state.doc.line(o.number+(t?1:-1)),u=s.bidiSpans(o),D=v.jT.cursor(t?o.from:o.to)}if(A){if(!A(R))return w}else{if(!r)return D;A=r(R)}w=D}}function dn(s,e,t){let r=s.state.charCategorizer(e),o=r(t);return u=>{let m=r(u);return o==v.D0.Space&&(o=m),o==m}}function Zs(s,e,t,r){let o=e.head,u=t?1:-1;if(o==(t?s.state.doc.length:0))return v.jT.cursor(o,e.assoc);let m=e.goalColumn,w,A=s.contentDOM.getBoundingClientRect(),D=s.coordsAtPos(o),R=s.documentTop;if(D)m==null&&(m=D.left-A.left),w=u<0?D.top:D.bottom;else{let ce=s.viewState.lineBlockAt(o);m==null&&(m=Math.min(A.right-A.left,s.defaultCharacterWidth*(o-ce.from))),w=(u<0?ce.top:ce.bottom)+R}let Y=A.left+m,Q=r!=null?r:s.viewState.heightOracle.textHeight>>1;for(let ce=0;;ce+=10){let we=w+(Q+ce)*u,Qe=Si(s,{x:Y,y:we},!1,u);if(we<A.top||we>A.bottom||(u<0?Qe<o:Qe>o))return v.jT.cursor(Qe,e.assoc,void 0,m)}}function fi(s,e,t){for(;;){let r=0;for(let o of s)o.between(e-1,e+1,(u,m,w)=>{if(e>u&&e<m){let A=r||t||(e-u<m-e?-1:1);e=A<0?u:m,r=A}});if(!r)return e}}function zi(s,e,t){let r=fi(s.state.facet(C).map(o=>o(s)),t.from,e.head>t.from?-1:1);return r==t.from?t:v.jT.cursor(r,r<t.from?1:-1)}class Us{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let t=(r,o)=>{this.ignoreDuringComposition(o)||o.type=="keydown"&&this.keydown(e,o)||(this.mustFlushObserver(o)&&e.observer.forceFlush(),this.runCustomHandlers(o.type,e,o)?o.preventDefault():r(e,o))};for(let r in ae){let o=ae[r];e.contentDOM.addEventListener(r,u=>{X(e,u)&&t(o,u)},be[r]),this.registeredEvents.push(r)}e.scrollDOM.addEventListener("mousedown",r=>{if(r.target==e.scrollDOM&&r.clientY>e.contentDOM.getBoundingClientRect().bottom&&(t(ae.mousedown,r),!r.defaultPrevented&&r.button==2)){let o=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=o,200)}}),e.scrollDOM.addEventListener("drop",r=>{r.target==e.scrollDOM&&r.clientY>e.contentDOM.getBoundingClientRect().bottom&&t(ae.drop,r)}),ve.chrome&&ve.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,ve.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var r;let o;this.customHandlers=[];for(let u of t)if(o=(r=u.update(e).spec)===null||r===void 0?void 0:r.domEventHandlers){this.customHandlers.push({plugin:u.value,handlers:o});for(let m in o)this.registeredEvents.indexOf(m)<0&&m!="scroll"&&(this.registeredEvents.push(m),e.contentDOM.addEventListener(m,w=>{X(e,w)&&this.runCustomHandlers(m,e,w)&&w.preventDefault()}))}}runCustomHandlers(e,t,r){for(let o of this.customHandlers){let u=o.handlers[e];if(u)try{if(u.call(o.plugin,r,t)||r.defaultPrevented)return!0}catch(m){kn(t.state,m)}}return!1}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let r of this.customHandlers){let o=r.handlers.scroll;if(o)try{o.call(r.plugin,t,e)}catch(u){kn(e.state,u)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(t.keyCode!=27&&Ks.indexOf(t.keyCode)<0&&(e.inputState.lastEscPress=0),ve.android&&ve.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let r;return ve.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((r=ts.find(o=>o.keyCode==t.keyCode))&&!t.ctrlKey||Ts.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=r||t,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,ze(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:ve.safari&&!ve.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const ts=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ts="dthko",Ks=[16,17,18,20,91,92,224,225],ns=6;function rs(s){return Math.max(0,s)*.7+8}function Js(s,e){return Math.max(Math.abs(s.clientX-e.clientX),Math.abs(s.clientY-e.clientY))}class Gs{constructor(e,t,r,o){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=o,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=Xe(e.contentDOM),this.atoms=e.state.facet(C).map(m=>m(e));let u=e.contentDOM.ownerDocument;u.addEventListener("mousemove",this.move=this.move.bind(this)),u.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(v.yy.allowMultipleSelections)&&Cn(e,t),this.dragging=q(e,t)&&rr(t)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Js(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,o=0,u=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},m=M(this.view);e.clientX-m.left<=u.left+ns?r=-rs(u.left-e.clientX):e.clientX+m.right>=u.right-ns&&(r=rs(e.clientX-u.right)),e.clientY-m.top<=u.top+ns?o=-rs(u.top-e.clientY):e.clientY+m.bottom>=u.bottom-ns&&(o=rs(e.clientY-u.bottom)),this.setScrollSpeed(r,o)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let r=0;r<e.ranges.length;r++){let o=e.ranges[r],u=null;if(o.empty){let m=fi(this.atoms,o.from,0);m!=o.from&&(u=v.jT.cursor(m,-1))}else{let m=fi(this.atoms,o.from,-1),w=fi(this.atoms,o.to,1);(m!=o.from||w!=o.to)&&(u=v.jT.range(o.from==o.anchor?m:w,o.from==o.head?m:w))}u&&(t||(t=e.ranges.slice()),t[r]=u)}return t?v.jT.create(t,e.mainIndex):e}select(e){let{view:t}=this,r=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection)||r.main.assoc!=t.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Cn(s,e){let t=s.state.facet(fr);return t.length?t[0](e):ve.mac?e.metaKey:e.ctrlKey}function Ms(s,e){let t=s.state.facet(zn);return t.length?t[0](e):ve.mac?!e.altKey:!e.ctrlKey}function q(s,e){let{main:t}=s.state.selection;if(t.empty)return!1;let r=st(s.root);if(!r||r.rangeCount==0)return!0;let o=r.getRangeAt(0).getClientRects();for(let u=0;u<o.length;u++){let m=o[u];if(m.left<=e.clientX&&m.right>=e.clientX&&m.top<=e.clientY&&m.bottom>=e.clientY)return!0}return!1}function X(s,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=s.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=xe.get(t))&&r.ignoreEvent(e))return!1;return!0}const ae=Object.create(null),be=Object.create(null),Pe=ve.ie&&ve.ie_version<15||ve.ios&&ve.webkit_version<604;function ct(s){let e=s.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{s.focus(),t.remove(),it(s,t.value)},50)}function it(s,e){let{state:t}=s,r,o=1,u=t.toText(e),m=u.lines==t.selection.ranges.length;if(fn!=null&&t.selection.ranges.every(A=>A.empty)&&fn==u.toString()){let A=-1;r=t.changeByRange(D=>{let R=t.doc.lineAt(D.from);if(R.from==A)return{range:D};A=R.from;let Y=t.toText((m?u.line(o++).text:e)+t.lineBreak);return{changes:{from:R.from,insert:Y},range:v.jT.cursor(D.from+Y.length)}})}else m?r=t.changeByRange(A=>{let D=u.line(o++);return{changes:{from:A.from,to:A.to,insert:D.text},range:v.jT.cursor(A.from+D.length)}}):r=t.replaceSelection(u);s.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}ae.keydown=(s,e)=>{s.inputState.setSelectionOrigin("select"),e.keyCode==27&&(s.inputState.lastEscPress=Date.now())},ae.touchstart=(s,e)=>{s.inputState.lastTouchTime=Date.now(),s.inputState.setSelectionOrigin("select.pointer")},ae.touchmove=s=>{s.inputState.setSelectionOrigin("select.pointer")},be.touchstart=be.touchmove={passive:!0},ae.mousedown=(s,e)=>{if(s.observer.flush(),s.inputState.lastTouchTime>Date.now()-2e3)return;let t=null;for(let r of s.state.facet(Hi))if(t=r(s,e),t)break;if(!t&&e.button==0&&(t=Or(s,e)),t){let r=!s.hasFocus;s.inputState.startMouseSelection(new Gs(s,e,t,r)),r&&s.observer.ignore(()=>yt(s.contentDOM)),s.inputState.mouseSelection&&s.inputState.mouseSelection.start(e)}};function Nt(s,e,t,r){if(r==1)return v.jT.cursor(e,t);if(r==2)return kt(s.state,e,t);{let o=Bt.find(s.docView,e),u=s.state.doc.lineAt(o?o.posAtEnd:e),m=o?o.posAtStart:u.from,w=o?o.posAtEnd:u.to;return w<s.state.doc.length&&w==u.to&&w++,v.jT.range(m,w)}}let On=(s,e)=>s>=e.top&&s<=e.bottom,qt=(s,e,t)=>On(e,t)&&s>=t.left&&s<=t.right;function Dt(s,e,t,r){let o=Bt.find(s.docView,e);if(!o)return 1;let u=e-o.posAtStart;if(u==0)return 1;if(u==o.length)return-1;let m=o.coordsAt(u,-1);if(m&&qt(t,r,m))return-1;let w=o.coordsAt(u,1);return w&&qt(t,r,w)?1:m&&On(r,m)?-1:1}function xt(s,e){let t=s.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Dt(s,t,e.clientX,e.clientY)}}const At=ve.ie&&ve.ie_version<=11;let ln=null,Nn=0,Fn=0;function rr(s){if(!At)return s.detail;let e=ln,t=Fn;return ln=s,Fn=Date.now(),Nn=!e||t>Date.now()-400&&Math.abs(e.clientX-s.clientX)<2&&Math.abs(e.clientY-s.clientY)<2?(Nn+1)%3:1}function Or(s,e){let t=xt(s,e),r=rr(e),o=s.state.selection;return{update(u){u.docChanged&&(t.pos=u.changes.mapPos(t.pos),o=o.map(u.changes))},get(u,m,w){let A=xt(s,u),D,R=Nt(s,A.pos,A.bias,r);if(t.pos!=A.pos&&!m){let Y=Nt(s,t.pos,t.bias,r),Q=Math.min(Y.from,R.from),ce=Math.max(Y.to,R.to);R=Q<R.from?v.jT.range(Q,ce):v.jT.range(ce,Q)}return m?o.replaceRange(o.main.extend(R.from,R.to)):w&&r==1&&o.ranges.length>1&&(D=Rr(o,A.pos))?D:w?o.addRange(R):v.jT.create([R])}}}function Rr(s,e){for(let t=0;t<s.ranges.length;t++){let{from:r,to:o}=s.ranges[t];if(r<=e&&o>=e)return v.jT.create(s.ranges.slice(0,t).concat(s.ranges.slice(t+1)),s.mainIndex==t?0:s.mainIndex-(s.mainIndex>t?1:0))}return null}ae.dragstart=(s,e)=>{let{selection:{main:t}}=s.state,{mouseSelection:r}=s.inputState;r&&(r.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",s.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function ir(s,e,t,r){if(!t)return;let o=s.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:u}=s.inputState,m=r&&u&&u.dragging&&Ms(s,e)?{from:u.dragging.from,to:u.dragging.to}:null,w={from:o,insert:t},A=s.state.changes(m?[m,w]:w);s.focus(),s.dispatch({changes:A,selection:{anchor:A.mapPos(o,-1),head:A.mapPos(o,1)},userEvent:m?"move.drop":"input.drop"})}ae.drop=(s,e)=>{if(!e.dataTransfer)return;if(s.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let r=Array(t.length),o=0,u=()=>{++o==t.length&&ir(s,e,r.filter(m=>m!=null).join(s.state.lineBreak),!1)};for(let m=0;m<t.length;m++){let w=new FileReader;w.onerror=u,w.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(w.result)||(r[m]=w.result),u()},w.readAsText(t[m])}}else ir(s,e,e.dataTransfer.getData("Text"),!0)},ae.paste=(s,e)=>{if(s.state.readOnly)return e.preventDefault();s.observer.flush();let t=Pe?null:e.clipboardData;t?(it(s,t.getData("text/plain")||t.getData("text/uri-text")),e.preventDefault()):ct(s)};function hr(s,e){let t=s.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),s.focus()},50)}function ii(s){let e=[],t=[],r=!1;for(let o of s.selection.ranges)o.empty||(e.push(s.sliceDoc(o.from,o.to)),t.push(o));if(!e.length){let o=-1;for(let{from:u}of s.selection.ranges){let m=s.doc.lineAt(u);m.number>o&&(e.push(m.text),t.push({from:m.from,to:Math.min(s.doc.length,m.to+1)})),o=m.number}r=!0}return{text:e.join(s.lineBreak),ranges:t,linewise:r}}let fn=null;ae.copy=ae.cut=(s,e)=>{let{text:t,ranges:r,linewise:o}=ii(s.state);if(!t&&!o)return;fn=o?t:null;let u=Pe?null:e.clipboardData;u?(e.preventDefault(),u.clearData(),u.setData("text/plain",t)):hr(s,t),e.type=="cut"&&!s.state.readOnly&&s.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})};const Li=v.q6.define();function Ar(s,e){let t=[];for(let r of s.facet(gr)){let o=r(s,e);o&&t.push(o)}return t?s.update({effects:t,annotations:Li.of(!0)}):null}function Wr(s){setTimeout(()=>{let e=s.hasFocus;if(e!=s.inputState.notifiedFocused){let t=Ar(s.state,e);t?s.dispatch(t):s.update([])}},10)}ae.focus=s=>{s.inputState.lastFocusTime=Date.now(),!s.scrollDOM.scrollTop&&(s.inputState.lastScrollTop||s.inputState.lastScrollLeft)&&(s.scrollDOM.scrollTop=s.inputState.lastScrollTop,s.scrollDOM.scrollLeft=s.inputState.lastScrollLeft),Wr(s)},ae.blur=s=>{s.observer.clearSelectionRange(),Wr(s)},ae.compositionstart=ae.compositionupdate=s=>{s.inputState.compositionFirstChange==null&&(s.inputState.compositionFirstChange=!0),s.inputState.composing<0&&(s.inputState.composing=0)},ae.compositionend=s=>{s.inputState.composing=-1,s.inputState.compositionEndedAt=Date.now(),s.inputState.compositionPendingKey=!0,s.inputState.compositionPendingChange=s.observer.pendingRecords().length>0,s.inputState.compositionFirstChange=null,ve.chrome&&ve.android?s.observer.flushSoon():s.inputState.compositionPendingChange?Promise.resolve().then(()=>s.observer.flush()):setTimeout(()=>{s.inputState.composing<0&&s.docView.hasComposition&&s.update([])},50)},ae.contextmenu=s=>{s.inputState.lastContextMenu=Date.now()},ae.beforeinput=(s,e)=>{var t;let r;if(ve.chrome&&ve.android&&(r=ts.find(o=>o.inputType==e.inputType))&&(s.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let o=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var u;(((u=window.visualViewport)===null||u===void 0?void 0:u.height)||0)>o+10&&s.hasFocus&&(s.contentDOM.blur(),s.focus())},100)}};const Xr=["pre-wrap","normal","pre-line","break-spaces"];class Kn{constructor(e){this.lineWrapping=e,this.doc=v.xv.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Xr.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let o=e[r];o<0?r++:this.heightSamples[Math.floor(o*10)]||(t=!0,this.heightSamples[Math.floor(o*10)]=!0)}return t}refresh(e,t,r,o,u,m){let w=Xr.indexOf(e)>-1,A=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=w;if(this.lineWrapping=w,this.lineHeight=t,this.charWidth=r,this.textHeight=o,this.lineLength=u,A){this.heightSamples={};for(let D=0;D<m.length;D++){let R=m[D];R<0?D++:this.heightSamples[Math.floor(R*10)]=!0}}return A}}class Ni{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class pn{constructor(e,t,r,o,u){this.from=e,this.length=t,this.top=r,this.height=o,this._content=u}get type(){return typeof this._content=="number"?bt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Vn?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new pn(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Ut=function(s){return s[s.ByPos=0]="ByPos",s[s.ByHeight=1]="ByHeight",s[s.ByPosNoHeight=2]="ByPosNoHeight",s}(Ut||(Ut={}));const jn=.001;class qn{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>jn&&(e.heightChanged=!0),this.height=t)}replace(e,t,r){return qn.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,o){let u=this,m=r.doc;for(let w=o.length-1;w>=0;w--){let{fromA:A,toA:D,fromB:R,toB:Y}=o[w],Q=u.lineAt(A,Ut.ByPosNoHeight,r.setDoc(t),0,0),ce=Q.to>=D?Q:u.lineAt(D,Ut.ByPosNoHeight,r,0,0);for(Y+=ce.to-D,D=ce.to;w>0&&Q.from<=o[w-1].toA;)A=o[w-1].fromA,R=o[w-1].fromB,w--,A<Q.from&&(Q=u.lineAt(A,Ut.ByPosNoHeight,r,0,0));R+=Q.from-A,A=Q.from;let we=br.build(r.setDoc(m),e,R,Y);u=u.replace(A,D,we)}return u.updateHeight(r,0)}static empty(){return new wn(0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,o=0,u=0;for(;;)if(t==r)if(o>u*2){let w=e[t-1];w.break?e.splice(--t,1,w.left,null,w.right):e.splice(--t,1,w.left,w.right),r+=1+w.break,o-=w.size}else if(u>o*2){let w=e[r];w.break?e.splice(r,1,w.left,null,w.right):e.splice(r,1,w.left,w.right),r+=2+w.break,u-=w.size}else break;else if(o<u){let w=e[t++];w&&(o+=w.size)}else{let w=e[--r];w&&(u+=w.size)}let m=0;return e[t-1]==null?(m=1,t--):e[t]==null&&(m=1,r++),new hi(qn.of(e.slice(0,t)),m,qn.of(e.slice(r)))}}qn.prototype.size=1;class Zi extends qn{constructor(e,t,r){super(e,t),this.deco=r}blockAt(e,t,r,o){return new pn(o,this.length,r,this.height,this.deco||0)}lineAt(e,t,r,o,u){return this.blockAt(0,r,o,u)}forEachLine(e,t,r,o,u,m){e<=u+this.length&&t>=u&&m(this.blockAt(0,r,o,u))}updateHeight(e,t=0,r=!1,o){return o&&o.from<=t&&o.more&&this.setHeight(e,o.heights[o.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class wn extends Zi{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,r,o){return new pn(o,this.length,r,this.height,this.breaks)}replace(e,t,r){let o=r[0];return r.length==1&&(o instanceof wn||o instanceof $n&&o.flags&4)&&Math.abs(this.length-o.length)<10?(o instanceof $n?o=new wn(o.length,this.height):o.height=this.height,this.outdated||(o.outdated=!1),o):qn.of(r)}updateHeight(e,t=0,r=!1,o){return o&&o.from<=t&&o.more?this.setHeight(e,o.heights[o.index++]):(r||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class $n extends qn{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,o=e.doc.lineAt(t+this.length).number,u=o-r+1,m,w=0;if(e.lineWrapping){let A=Math.min(this.height,e.lineHeight*u);m=A/u,this.length>u+1&&(w=(this.height-A)/(this.length-u-1))}else m=this.height/u;return{firstLine:r,lastLine:o,perLine:m,perChar:w}}blockAt(e,t,r,o){let{firstLine:u,lastLine:m,perLine:w,perChar:A}=this.heightMetrics(t,o);if(t.lineWrapping){let D=o+Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length),R=t.doc.lineAt(D),Y=w+R.length*A,Q=Math.max(r,e-Y/2);return new pn(R.from,R.length,Q,Y,0)}else{let D=Math.max(0,Math.min(m-u,Math.floor((e-r)/w))),{from:R,length:Y}=t.doc.line(u+D);return new pn(R,Y,r+w*D,w,0)}}lineAt(e,t,r,o,u){if(t==Ut.ByHeight)return this.blockAt(e,r,o,u);if(t==Ut.ByPosNoHeight){let{from:ce,to:we}=r.doc.lineAt(e);return new pn(ce,we-ce,0,0,0)}let{firstLine:m,perLine:w,perChar:A}=this.heightMetrics(r,u),D=r.doc.lineAt(e),R=w+D.length*A,Y=D.number-m,Q=o+w*Y+A*(D.from-u-Y);return new pn(D.from,D.length,Math.max(o,Math.min(Q,o+this.height-R)),R,0)}forEachLine(e,t,r,o,u,m){e=Math.max(e,u),t=Math.min(t,u+this.length);let{firstLine:w,perLine:A,perChar:D}=this.heightMetrics(r,u);for(let R=e,Y=o;R<=t;){let Q=r.doc.lineAt(R);if(R==e){let we=Q.number-w;Y+=A*we+D*(e-u-we)}let ce=A+D*Q.length;m(new pn(Q.from,Q.length,Y,ce,0)),Y+=ce,R=Q.to+1}}replace(e,t,r){let o=this.length-t;if(o>0){let u=r[r.length-1];u instanceof $n?r[r.length-1]=new $n(u.length+o):r.push(null,new $n(o-1))}if(e>0){let u=r[0];u instanceof $n?r[0]=new $n(e+u.length):r.unshift(new $n(e-1),null)}return qn.of(r)}decomposeLeft(e,t){t.push(new $n(e-1),null)}decomposeRight(e,t){t.push(null,new $n(this.length-e-1))}updateHeight(e,t=0,r=!1,o){let u=t+this.length;if(o&&o.from<=t+this.length&&o.more){let m=[],w=Math.max(t,o.from),A=-1;for(o.from>t&&m.push(new $n(o.from-t-1).updateHeight(e,t));w<=u&&o.more;){let R=e.doc.lineAt(w).length;m.length&&m.push(null);let Y=o.heights[o.index++];A==-1?A=Y:Math.abs(Y-A)>=jn&&(A=-2);let Q=new wn(R,Y);Q.outdated=!1,m.push(Q),w+=R+1}w<=u&&m.push(null,new $n(u-w).updateHeight(e,w));let D=qn.of(m);return(A<0||Math.abs(D.height-this.height)>=jn||Math.abs(A-this.heightMetrics(e,t).perLine)>=jn)&&(e.heightChanged=!0),D}else(r||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class hi extends qn{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,o){let u=r+this.left.height;return e<u?this.left.blockAt(e,t,r,o):this.right.blockAt(e,t,u,o+this.left.length+this.break)}lineAt(e,t,r,o,u){let m=o+this.left.height,w=u+this.left.length+this.break,A=t==Ut.ByHeight?e<m:e<w,D=A?this.left.lineAt(e,t,r,o,u):this.right.lineAt(e,t,r,m,w);if(this.break||(A?D.to<w:D.from>w))return D;let R=t==Ut.ByPosNoHeight?Ut.ByPosNoHeight:Ut.ByPos;return A?D.join(this.right.lineAt(w,R,r,m,w)):this.left.lineAt(w,R,r,o,u).join(D)}forEachLine(e,t,r,o,u,m){let w=o+this.left.height,A=u+this.left.length+this.break;if(this.break)e<A&&this.left.forEachLine(e,t,r,o,u,m),t>=A&&this.right.forEachLine(e,t,r,w,A,m);else{let D=this.lineAt(A,Ut.ByPos,r,o,u);e<D.from&&this.left.forEachLine(e,D.from-1,r,o,u,m),D.to>=e&&D.from<=t&&m(D),t>D.to&&this.right.forEachLine(D.to+1,t,r,w,A,m)}}replace(e,t,r){let o=this.left.length+this.break;if(t<o)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-o,t-o,r));let u=[];e>0&&this.decomposeLeft(e,u);let m=u.length;for(let w of r)u.push(w);if(e>0&&Ui(u,m-1),t<this.length){let w=u.length;this.decomposeRight(t,u),Ui(u,w)}return qn.of(u)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,o=r+this.break;if(e>=o)return this.right.decomposeRight(e-o,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<o&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?qn.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,o){let{left:u,right:m}=this,w=t+u.length+this.break,A=null;return o&&o.from<=t+u.length&&o.more?A=u=u.updateHeight(e,t,r,o):u.updateHeight(e,t,r),o&&o.from<=w+m.length&&o.more?A=m=m.updateHeight(e,w,r,o):m.updateHeight(e,w,r),A?this.balanced(u,m):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Ui(s,e){let t,r;s[e]==null&&(t=s[e-1])instanceof $n&&(r=s[e+1])instanceof $n&&s.splice(e-1,3,new $n(t.length+1+r.length))}const ur=5;class br{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),o=this.nodes[this.nodes.length-1];o instanceof wn?o.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new wn(r-this.pos,-1)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let o=r.widget?r.widget.estimatedHeight:0,u=r.widget?r.widget.lineBreaks:0;o<0&&(o=this.oracle.lineHeight);let m=t-e;r.block?this.addBlock(new Zi(m,o,r)):(m||u||o>=ur)&&this.addLineDeco(o,u,m)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new wn(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let r=new $n(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof wn)return e;let t=new wn(0,-1);return this.nodes.push(t),t}addBlock(e){var t;this.enterLine();let r=(t=e.deco)===null||t===void 0?void 0:t.type;r==bt.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r!=bt.WidgetBefore&&(this.covering=e)}addLineDeco(e,t,r){let o=this.ensureLine();o.length+=r,o.collapsed+=r,o.widgetHeight=Math.max(o.widgetHeight,e),o.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof wn)&&!this.isCovered?this.nodes.push(new wn(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let o of this.nodes)o instanceof wn&&o.updateHeight(this.oracle,r),r+=o?o.length:1;return this.nodes}static build(e,t,r,o){let u=new br(r,e);return v.Xs.spans(t,r,o,u,0),u.finish(r)}}function Hr(s,e,t){let r=new Ir;return v.Xs.compare(s,e,t,r,0),r.changes}class Ir{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,o){(e<t||r&&r.heightRelevant||o&&o.heightRelevant)&&wr(e,t,this.changes,5)}}function Ps(s,e){let t=s.getBoundingClientRect(),r=s.ownerDocument,o=r.defaultView||window,u=Math.max(0,t.left),m=Math.min(o.innerWidth,t.right),w=Math.max(0,t.top),A=Math.min(o.innerHeight,t.bottom);for(let D=s.parentNode;D&&D!=r.body;)if(D.nodeType==1){let R=D,Y=window.getComputedStyle(R);if((R.scrollHeight>R.clientHeight||R.scrollWidth>R.clientWidth)&&Y.overflow!="visible"){let Q=R.getBoundingClientRect();u=Math.max(u,Q.left),m=Math.min(m,Q.right),w=Math.max(w,Q.top),A=D==s.parentNode?Q.bottom:Math.min(A,Q.bottom)}D=Y.position=="absolute"||Y.position=="fixed"?R.offsetParent:R.parentNode}else if(D.nodeType==11)D=D.host;else break;return{left:u-t.left,right:Math.max(u,m)-t.left,top:w-(t.top+e),bottom:Math.max(w,A)-(t.top+e)}}function zr(s,e){let t=s.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class si{constructor(e,t,r){this.from=e,this.to=t,this.size=r}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let o=e[r],u=t[r];if(o.from!=u.from||o.to!=u.to||o.size!=u.size)return!1}return!0}draw(e){return wt.replace({widget:new Bi(this.size,e)}).range(this.from,this.to)}}class Bi extends Jt{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ui{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=di,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ue.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(g).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new Kn(t),this.stateDeco=e.facet(S).filter(r=>typeof r!="function"),this.heightMap=qn.empty().applyChanges(this.stateDeco,v.xv.empty,this.heightOracle.setDoc(e.doc),[new U(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=wt.set(this.lineGaps.map(r=>r.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let o=r?t.head:t.anchor;if(!e.some(({from:u,to:m})=>o>=u&&o<=m)){let{from:u,to:m}=this.lineBlockAt(o);e.push(new Yr(u,m))}}this.viewports=e.sort((r,o)=>r.from-o.from),this.scaler=this.heightMap.height<=7e6?di:new pi(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:_r(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(S).filter(R=>typeof R!="function");let o=e.changedRanges,u=U.extendWithRanges(o,Hr(r,this.stateDeco,e?e.changes:v.as.empty(this.state.doc.length))),m=this.heightMap.height,w=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),u),this.heightMap.height!=m&&(e.flags|=2),w?(this.scrollAnchorPos=e.changes.mapPos(w.from,-1),this.scrollAnchorHeight=w.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let A=u.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<A.from||t.range.head>A.to)||!this.viewportIsAppropriate(A))&&(A=this.getViewport(0,t));let D=!e.changes.empty||e.flags&2||A.from!=this.viewport.from||A.to!=this.viewport.to;this.viewport=A,this.updateForViewport(),D&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Dn)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),o=this.heightOracle,u=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?ue.RTL:ue.LTR;let m=this.heightOracle.mustRefreshForWrapping(u),w=t.getBoundingClientRect(),A=m||this.mustMeasureContent||this.contentDOMHeight!=w.height;this.contentDOMHeight=w.height,this.mustMeasureContent=!1;let D=0,R=0,Y=parseInt(r.paddingTop)||0,Q=parseInt(r.paddingBottom)||0;(this.paddingTop!=Y||this.paddingBottom!=Q)&&(this.paddingTop=Y,this.paddingBottom=Q,D|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(o.lineWrapping&&(A=!0),this.editorWidth=e.scrollDOM.clientWidth,D|=8),this.scrollTop!=e.scrollDOM.scrollTop&&(this.scrollAnchorHeight=-1,this.scrollTop=e.scrollDOM.scrollTop),this.scrolledToBottom=Ge(e.scrollDOM);let ce=(this.printing?zr:Ps)(t,this.paddingTop),we=ce.top-this.pixelViewport.top,Qe=ce.bottom-this.pixelViewport.bottom;this.pixelViewport=ce;let Le=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(Le!=this.inView&&(this.inView=Le,Le&&(A=!0)),!this.inView&&!this.scrollTarget)return 0;let Ke=w.width;if((this.contentDOMWidth!=Ke||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=w.width,this.editorHeight=e.scrollDOM.clientHeight,D|=8),A){let gn=e.docView.measureVisibleLineHeights(this.viewport);if(o.mustRefreshForHeights(gn)&&(m=!0),m||o.lineWrapping&&Math.abs(Ke-this.contentDOMWidth)>o.charWidth){let{lineHeight:$t,charWidth:tn,textHeight:et}=e.docView.measureTextSize();m=$t>0&&o.refresh(u,$t,tn,et,Ke/tn,gn),m&&(e.docView.minWidth=0,D|=8)}we>0&&Qe>0?R=Math.max(we,Qe):we<0&&Qe<0&&(R=Math.min(we,Qe)),o.heightChanged=!1;for(let $t of this.viewports){let tn=$t.from==this.viewport.from?gn:e.docView.measureVisibleLineHeights($t);this.heightMap=(m?qn.empty().applyChanges(this.stateDeco,v.xv.empty,this.heightOracle,[new U(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(o,0,m,new Ni($t.from,tn))}o.heightChanged&&(D|=2)}let Vt=!this.viewportIsAppropriate(this.viewport,R)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Vt&&(this.viewport=this.getViewport(R,this.scrollTarget)),this.updateForViewport(),(D&2||Vt)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(m?[]:this.lineGaps,e)),D|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),D}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),o=this.heightMap,u=this.heightOracle,{visibleTop:m,visibleBottom:w}=this,A=new Yr(o.lineAt(m-r*1e3,Ut.ByHeight,u,0,0).from,o.lineAt(w+(1-r)*1e3,Ut.ByHeight,u,0,0).to);if(t){let{head:D}=t.range;if(D<A.from||D>A.to){let R=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),Y=o.lineAt(D,Ut.ByPos,u,0,0),Q;t.y=="center"?Q=(Y.top+Y.bottom)/2-R/2:t.y=="start"||t.y=="nearest"&&D<A.from?Q=Y.top:Q=Y.bottom-R,A=new Yr(o.lineAt(Q-1e3/2,Ut.ByHeight,u,0,0).from,o.lineAt(Q+R+1e3/2,Ut.ByHeight,u,0,0).to)}}return A}mapViewport(e,t){let r=t.mapPos(e.from,-1),o=t.mapPos(e.to,1);return new Yr(this.heightMap.lineAt(r,Ut.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(o,Ut.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:o}=this.heightMap.lineAt(e,Ut.ByPos,this.heightOracle,0,0),{bottom:u}=this.heightMap.lineAt(t,Ut.ByPos,this.heightOracle,0,0),{visibleTop:m,visibleBottom:w}=this;return(e==0||o<=m-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||u>=w+Math.max(10,Math.min(r,250)))&&o>m-2*1e3&&u<w+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let o of e)t.touchesRange(o.from,o.to)||r.push(new si(t.mapPos(o.from),t.mapPos(o.to),o.size));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,o=r?1e4:2e3,u=o>>1,m=o<<1;if(this.defaultTextDirection!=ue.LTR&&!r)return[];let w=[],A=(D,R,Y,Q)=>{if(R-D<u)return;let ce=this.state.selection.main,we=[ce.from];ce.empty||we.push(ce.to);for(let Le of we)if(Le>D&&Le<R){A(D,Le-10,Y,Q),A(Le+10,R,Y,Q);return}let Qe=oi(e,Le=>Le.from>=Y.from&&Le.to<=Y.to&&Math.abs(Le.from-D)<u&&Math.abs(Le.to-R)<u&&!we.some(Ke=>Le.from<Ke&&Le.to>Ke));if(!Qe){if(R<Y.to&&t&&r&&t.visibleRanges.some(Le=>Le.from<=R&&Le.to>=R)){let Le=t.moveToLineBoundary(v.jT.cursor(R),!1,!0).head;Le>D&&(R=Le)}Qe=new si(D,R,this.gapSize(Y,D,R,Q))}w.push(Qe)};for(let D of this.viewportLines){if(D.length<m)continue;let R=Qr(D.from,D.to,this.stateDeco);if(R.total<m)continue;let Y=this.scrollTarget?this.scrollTarget.range.head:null,Q,ce;if(r){let we=o/this.heightOracle.lineLength*this.heightOracle.lineHeight,Qe,Le;if(Y!=null){let Ke=Tr(R,Y),Vt=((this.visibleBottom-this.visibleTop)/2+we)/D.height;Qe=Ke-Vt,Le=Ke+Vt}else Qe=(this.visibleTop-D.top-we)/D.height,Le=(this.visibleBottom-D.top+we)/D.height;Q=qr(R,Qe),ce=qr(R,Le)}else{let we=R.total*this.heightOracle.charWidth,Qe=o*this.heightOracle.charWidth,Le,Ke;if(Y!=null){let Vt=Tr(R,Y),gn=((this.pixelViewport.right-this.pixelViewport.left)/2+Qe)/we;Le=Vt-gn,Ke=Vt+gn}else Le=(this.pixelViewport.left-Qe)/we,Ke=(this.pixelViewport.right+Qe)/we;Q=qr(R,Le),ce=qr(R,Ke)}Q>D.from&&A(D.from,Q,D,R),ce<D.to&&A(ce,D.to,D,R)}return w}gapSize(e,t,r,o){let u=Tr(o,r)-Tr(o,t);return this.heightOracle.lineWrapping?e.height*u:o.total*this.heightOracle.charWidth*u}updateLineGaps(e){si.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=wt.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];v.Xs.spans(e,this.viewport.from,this.viewport.to,{span(o,u){t.push({from:o,to:u})},point(){}},20);let r=t.length!=this.visibleRanges.length||this.visibleRanges.some((o,u)=>o.from!=t[u].from||o.to!=t[u].to);return this.visibleRanges=t,r?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||_r(this.heightMap.lineAt(e,Ut.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return _r(this.heightMap.lineAt(this.scaler.fromDOM(e),Ut.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return _r(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Yr{constructor(e,t){this.from=e,this.to=t}}function Qr(s,e,t){let r=[],o=s,u=0;return v.Xs.spans(t,s,e,{span(){},point(m,w){m>o&&(r.push({from:o,to:m}),u+=m-o),o=w}},20),o<e&&(r.push({from:o,to:e}),u+=e-o),{total:u,ranges:r}}function qr({total:s,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(s*t);for(let o=0;;o++){let{from:u,to:m}=e[o],w=m-u;if(r<=w)return u+r;r-=w}}function Tr(s,e){let t=0;for(let{from:r,to:o}of s.ranges){if(e<=o){t+=e-r;break}t+=o-r}return t/s.total}function oi(s,e){for(let t of s)if(e(t))return t}const di={toDOM(s){return s},fromDOM(s){return s},scale:1};class pi{constructor(e,t,r){let o=0,u=0,m=0;this.viewports=r.map(({from:w,to:A})=>{let D=t.lineAt(w,Ut.ByPos,e,0,0).top,R=t.lineAt(A,Ut.ByPos,e,0,0).bottom;return o+=R-D,{from:w,to:A,top:D,bottom:R,domTop:0,domBottom:0}}),this.scale=(7e6-o)/(t.height-o);for(let w of this.viewports)w.domTop=m+(w.top-u)*this.scale,m=w.domBottom=w.domTop+(w.bottom-w.top),u=w.bottom}toDOM(e){for(let t=0,r=0,o=0;;t++){let u=t<this.viewports.length?this.viewports[t]:null;if(!u||e<u.top)return o+(e-r)*this.scale;if(e<=u.bottom)return u.domTop+(e-u.top);r=u.bottom,o=u.domBottom}}fromDOM(e){for(let t=0,r=0,o=0;;t++){let u=t<this.viewports.length?this.viewports[t]:null;if(!u||e<u.domTop)return r+(e-o)/this.scale;if(e<=u.domBottom)return u.top+(e-u.domTop);r=u.bottom,o=u.domBottom}}}function _r(s,e){if(e.scale==1)return s;let t=e.toDOM(s.top),r=e.toDOM(s.bottom);return new pn(s.from,s.length,t,r-t,Array.isArray(s._content)?s._content.map(o=>_r(o,e)):s._content)}const wi=v.r$.define({combine:s=>s.join(" ")}),li=v.r$.define({combine:s=>s.indexOf(!0)>-1}),vn=ke.V.newName(),Mr=ke.V.newName(),ei=ke.V.newName(),Er={"&light":"."+Mr,"&dark":"."+ei};function Fi(s,e,t){return new ke.V(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,o=>{if(o=="&")return s;if(!t||!t[o])throw new RangeError(`Unsupported selector: ${o}`);return t[o]}):s+" "+r}})}const is=Fi("."+vn,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Er);class xr{constructor(e,t,r,o){this.typeOver=o,this.bounds=null,this.text="";let{impreciseHead:u,impreciseAnchor:m}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,r,0))){let w=u||m?[]:Wn(e),A=new In(w,e.state);A.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=A.text,this.newSel=mt(w,this.bounds.from)}else{let w=e.observer.selectionRange,A=u&&u.node==w.focusNode&&u.offset==w.focusOffset||!He(e.contentDOM,w.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(w.focusNode,w.focusOffset),D=m&&m.node==w.anchorNode&&m.offset==w.anchorOffset||!He(e.contentDOM,w.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(w.anchorNode,w.anchorOffset);this.newSel=v.jT.single(D,A)}}}function mi(s,e){let t,{newSel:r}=e,o=s.state.selection.main,u=s.inputState.lastKeyTime>Date.now()-100?s.inputState.lastKeyCode:-1;if(e.bounds){let{from:m,to:w}=e.bounds,A=o.from,D=null;(u===8||ve.android&&e.text.length<w-m)&&(A=o.to,D="end");let R=Zr(s.state.doc.sliceString(m,w,Zt),e.text,A-m,D);R&&(ve.chrome&&u==13&&R.toB==R.from+2&&e.text.slice(R.from,R.toB)==Zt+Zt&&R.toB--,t={from:m+R.from,to:m+R.toA,insert:v.xv.of(e.text.slice(R.from,R.toB).split(Zt))})}else r&&(!s.hasFocus&&s.state.facet(tr)||r.main.eq(o))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!o.empty&&r&&r.main.empty?t={from:o.from,to:o.to,insert:s.state.doc.slice(o.from,o.to)}:t&&t.from>=o.from&&t.to<=o.to&&(t.from!=o.from||t.to!=o.to)&&o.to-o.from-(t.to-t.from)<=4?t={from:o.from,to:o.to,insert:s.state.doc.slice(o.from,t.from).append(t.insert).append(s.state.doc.slice(t.to,o.to))}:(ve.mac||ve.android)&&t&&t.from==t.to&&t.from==o.head-1&&/^\. ?$/.test(t.insert.toString())&&s.contentDOM.getAttribute("autocorrect")=="off"?(r&&t.insert.length==2&&(r=v.jT.single(r.main.anchor-1,r.main.head-1)),t={from:o.from,to:o.to,insert:v.xv.of([" "])}):ve.chrome&&t&&t.from==t.to&&t.from==o.head&&t.insert.toString()==`
 `&&s.lineWrapping&&(r&&(r=v.jT.single(r.main.anchor-1,r.main.head-1)),t={from:o.from,to:o.to,insert:v.xv.of([" "])}),t){let m=s.state;if(ve.ios&&s.inputState.flushIOSKey(s)||ve.android&&(t.from==o.from&&t.to==o.to&&t.insert.length==1&&t.insert.lines==2&&ze(s.contentDOM,"Enter",13)||(t.from==o.from-1&&t.to==o.to&&t.insert.length==0||u==8&&t.insert.length<t.to-t.from)&&ze(s.contentDOM,"Backspace",8)||t.from==o.from&&t.to==o.to+1&&t.insert.length==0&&ze(s.contentDOM,"Delete",46)))return!0;let w=t.insert.toString();if(s.state.facet(Ln).some(R=>R(s,t.from,t.to,w)))return!0;s.inputState.composing>=0&&s.inputState.composing++;let A;if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!r||r.main.empty&&r.main.from==t.from+t.insert.length)&&s.inputState.composing<0){let R=o.from<t.from?m.sliceDoc(o.from,t.from):"",Y=o.to>t.to?m.sliceDoc(t.to,o.to):"";A=m.replaceSelection(s.state.toText(R+t.insert.sliceString(0,void 0,s.state.lineBreak)+Y))}else{let R=m.changes(t),Y=r&&r.main.to<=R.newLength?r.main:void 0;if(m.selection.ranges.length>1&&s.inputState.composing>=0&&t.to<=o.to&&t.to>=o.to-10){let Q=s.state.sliceDoc(t.from,t.to),ce=k(s)||s.state.doc.lineAt(o.head),we=o.to-t.to,Qe=o.to-o.from;A=m.changeByRange(Le=>{if(Le.from==o.from&&Le.to==o.to)return{changes:R,range:Y||Le.map(R)};let Ke=Le.to-we,Vt=Ke-Q.length;if(Le.to-Le.from!=Qe||s.state.sliceDoc(Vt,Ke)!=Q||ce&&Le.to>=ce.from&&Le.from<=ce.to)return{range:Le};let gn=m.changes({from:Vt,to:Ke,insert:t.insert}),$t=Le.to-o.to;return{changes:gn,range:Y?v.jT.range(Math.max(0,Y.anchor+$t),Math.max(0,Y.head+$t)):Le.map(gn)}})}else A={changes:R,selection:Y&&m.selection.replaceRange(Y)}}let D="input.type";return(s.composing||s.inputState.compositionPendingChange&&s.inputState.compositionEndedAt>Date.now()-50)&&(s.inputState.compositionPendingChange=!1,D+=".compose",s.inputState.compositionFirstChange&&(D+=".start",s.inputState.compositionFirstChange=!1)),s.dispatch(A,{scrollIntoView:!0,userEvent:D}),!0}else if(r&&!r.main.eq(o)){let m=!1,w="select";return s.inputState.lastSelectionTime>Date.now()-50&&(s.inputState.lastSelectionOrigin=="select"&&(m=!0),w=s.inputState.lastSelectionOrigin),s.dispatch({selection:r,scrollIntoView:m,userEvent:w}),!0}else return!1}function Zr(s,e,t,r){let o=Math.min(s.length,e.length),u=0;for(;u<o&&s.charCodeAt(u)==e.charCodeAt(u);)u++;if(u==o&&s.length==e.length)return null;let m=s.length,w=e.length;for(;m>0&&w>0&&s.charCodeAt(m-1)==e.charCodeAt(w-1);)m--,w--;if(r=="end"){let A=Math.max(0,u-Math.min(m,w));t-=m+A-u}if(m<u&&s.length<e.length){let A=t<=u&&t>=m?u-t:0;u-=A,w=u+(w-m),m=u}else if(w<u){let A=t<=u&&t>=w?u-t:0;u-=A,m=u+(m-w),w=u}return{from:u,toA:m,toB:w}}function Wn(s){let e=[];if(s.root.activeElement!=s.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:o,focusOffset:u}=s.observer.selectionRange;return t&&(e.push(new er(t,r)),(o!=t||u!=r)&&e.push(new er(o,u))),e}function mt(s,e){if(s.length==0)return null;let t=s[0].pos,r=s.length==2?s[1].pos:t;return t>-1&&r>-1?v.jT.single(t+e,r+e):null}const An={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ur=ve.ie&&ve.ie_version<=11;class Ei{constructor(e){this.view=e,this.active=!1,this.selectionRange=new Ye,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(ve.ie&&ve.ie_version<=11||ve.ios&&e.composing)&&t.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),Ur&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,o=this.selectionRange;if(r.state.facet(tr)?r.root.activeElement!=this.dom:!tt(r.dom,o))return;let u=o.anchorNode&&r.docView.nearest(o.anchorNode);if(u&&u.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(ve.ie&&ve.ie_version<=11||ve.android&&ve.chrome)&&!r.state.selection.main.empty&&o.focusNode&&It(o.focusNode,o.focusOffset,o.anchorNode,o.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=ve.safari&&e.root.nodeType==11&&gt(this.dom.ownerDocument)==this.dom&&Xs(this.view)||st(e.root);if(!t||this.selectionRange.eq(t))return!1;let r=tt(this.dom,t);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Ue(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,An),Ur&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ur&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let o=()=>{let u=this.delayedAndroidKey;u&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=u.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&u.force&&ze(this.dom,u.key,u.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(o)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,o=!1;for(let u of e){let m=this.readMutation(u);m&&(m.typeOver&&(o=!0),t==-1?{from:t,to:r}=m:(t=Math.min(m.from,t),r=Math.max(m.to,r)))}return{from:t,to:r,typeOver:o}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),o=this.selectionChanged&&tt(this.dom,this.selectionRange);return e<0&&!o?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new xr(this.view,e,t,r))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return!1;let r=this.view.state,o=mi(this.view,t);return this.view.state==r&&this.view.update([]),o}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let r=Ds(t,e.previousSibling||e.target.previousSibling,-1),o=Ds(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:o?t.posBefore(o):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,r,o;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect(),(o=this.resizeContent)===null||o===void 0||o.disconnect();for(let u of this.scrollTargets)u.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Ds(s,e,t){for(;e;){let r=xe.get(e);if(r&&r.parent==s)return r;let o=e.parentNode;e=o!=s.dom?o:t>0?e.nextSibling:e.previousSibling}return null}function Xs(s){let e=null;function t(A){A.preventDefault(),A.stopImmediatePropagation(),e=A.getTargetRanges()[0]}if(s.contentDOM.addEventListener("beforeinput",t,!0),s.dom.ownerDocument.execCommand("indent"),s.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let r=e.startContainer,o=e.startOffset,u=e.endContainer,m=e.endOffset,w=s.docView.domAtPos(s.state.selection.main.anchor);return It(w.node,w.offset,u,m)&&([r,o,u,m]=[u,m,r,o]),{anchorNode:r,anchorOffset:o,focusNode:u,focusOffset:m}}class bn{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=e.root||ot(e.parent)||document,this.viewState=new ui(e.state||v.yy.create(e)),this.plugins=this.state.facet(Cr).map(t=>new j(t));for(let t of this.plugins)t.update(this);this.observer=new Ei(this),this.inputState=new Us(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new _i(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){let t=e.length==1&&e[0]instanceof v.YW?e[0]:this.state.update(...e);this._dispatch(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,o,u=this.state;for(let Q of e){if(Q.startState!=u)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");u=Q.state}if(this.destroyed){this.viewState.state=u;return}let m=this.hasFocus,w=0,A=null;e.some(Q=>Q.annotation(Li))?(this.inputState.notifiedFocused=m,w=1):m!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=m,A=Ar(u,m),A||(w=1));let D=this.observer.delayedAndroidKey,R=null;if(D?(this.observer.clearDelayedAndroidKey(),R=this.observer.readChange(),(R&&!this.state.doc.eq(u.doc)||!this.state.selection.eq(u.selection))&&(R=null)):this.observer.clear(),u.facet(v.yy.phrases)!=this.state.facet(v.yy.phrases))return this.setState(u);o=he.create(this,u,e),o.flags|=w;let Y=this.viewState.scrollTarget;try{this.updateState=2;for(let Q of e){if(Y&&(Y=Y.map(Q.changes)),Q.scrollIntoView){let{main:ce}=Q.state.selection;Y=new yr(ce.empty?ce:v.jT.cursor(ce.head,ce.head>ce.anchor?-1:1))}for(let ce of Q.effects)ce.is(Gr)&&(Y=ce.value)}this.viewState.update(o,Y),this.bidiCache=Kr.update(this.bidiCache,o.changes),o.empty||(this.updatePlugins(o),this.inputState.update(o)),t=this.docView.update(o),this.state.facet(Z)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(Q=>Q.isUserEvent("select.pointer")))}finally{this.updateState=0}if(o.startState.facet(wi)!=o.state.facet(wi)&&(this.viewState.mustMeasureContent=!0),(t||r||Y||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!o.empty)for(let Q of this.state.facet(ri))Q(o);(A||R)&&Promise.resolve().then(()=>{A&&this.state==A.startState&&this.dispatch(A),R&&!mi(this,R)&&D.force&&ze(this.contentDOM,D.key,D.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new ui(e),this.plugins=e.facet(Cr).map(r=>new j(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView=new _i(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Cr),r=e.state.facet(Cr);if(t!=r){let o=[];for(let u of r){let m=t.indexOf(u);if(m<0)o.push(new j(u));else{let w=this.plugins[m];w.mustUpdate=e,o.push(w)}}for(let u of this.plugins)u.mustUpdate!=e&&u.destroy(this);this.plugins=o,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let o of this.plugins)o.mustUpdate=e;for(let o=0;o<this.plugins.length;o++)this.plugins[o].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,{scrollTop:o}=r,{scrollAnchorPos:u,scrollAnchorHeight:m}=this.viewState;o!=this.viewState.scrollTop&&(m=-1),this.viewState.scrollAnchorHeight=-1;try{for(let w=0;;w++){if(m<0)if(Ge(r))u=-1,m=this.viewState.heightMap.height;else{let ce=this.viewState.scrollAnchorAt(o);u=ce.from,m=ce.top}this.updateState=1;let A=this.viewState.measure(this);if(!A&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(w>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let D=[];A&4||([this.measureRequests,D]=[D,this.measureRequests]);let R=D.map(ce=>{try{return ce.read(this)}catch(we){return kn(this.state,we),gs}}),Y=he.create(this,this.state,[]),Q=!1;Y.flags|=A,t?t.flags|=A:t=Y,this.updateState=2,Y.empty||(this.updatePlugins(Y),this.inputState.update(Y),this.updateAttrs(),Q=this.docView.update(Y));for(let ce=0;ce<D.length;ce++)if(R[ce]!=gs)try{let we=D[ce];we.write&&we.write(R[ce],this)}catch(we){kn(this.state,we)}if(Q&&this.docView.updateSelection(!0),!Y.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}else{let we=(u<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(u).top)-m;if(we>1||we<-1){o=r.scrollTop=o+we,m=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let w of this.state.facet(ri))w(t)}get themeClasses(){return vn+" "+(this.state.facet(li)?ei:Mr)+" "+this.state.facet(wi)}updateAttrs(){let e=ki(this,f,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(tr)?"true":"false",class:"cm-content",style:`${ve.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),ki(this,g,t);let r=this.observer.ignore(()=>{let o=Kt(this.contentDOM,this.contentAttrs,t),u=Kt(this.dom,this.editorAttrs,e);return o||u});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let o of r.effects)if(o.is(bn.announce)){t&&(this.announceDOM.textContent=""),t=!1;let u=this.announceDOM.appendChild(document.createElement("div"));u.textContent=o.value}}mountStyles(){this.styleModules=this.state.facet(Z),ke.V.mount(this.root,this.styleModules.concat(is).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return zi(this,e,zs(this,e,t,r))}moveByGroup(e,t){return zi(this,e,zs(this,e,t,r=>dn(this,e.head,r)))}moveToLineBoundary(e,t,r=!0){return As(this,e,t,r)}moveVertically(e,t,r){return zi(this,e,Zs(this,e,t,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Si(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let o=this.state.doc.lineAt(e),u=this.bidiSpans(o),m=u[nr.find(u,e-o.from,-1,t)];return je(r,m.dir==ue.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ai)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Ys)return Ii(e.length);let t=this.textDirectionAt(e.from);for(let o of this.bidiCache)if(o.from==e.from&&o.dir==t)return o.order;let r=Ri(e.text,t);return this.bidiCache.push(new Kr(e.from,e.to,t,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||ve.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{yt(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Gr.of(new yr(typeof e=="number"?v.jT.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return Zn.define(()=>({}),{eventHandlers:e})}static theme(e,t){let r=ke.V.newName(),o=[wi.of(r),Z.of(Fi(`.${r}`,e))];return t&&t.dark&&o.push(li.of(!0)),o}static baseTheme(e){return v.Wl.lowest(Z.of(Fi("."+vn,e,Er)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),o=r&&xe.get(r)||xe.get(e);return((t=o==null?void 0:o.rootView)===null||t===void 0?void 0:t.view)||null}}bn.styleModule=Z,bn.inputHandler=Ln,bn.focusChangeEffect=gr,bn.perLineTextDirection=ai,bn.exceptionSink=$r,bn.updateListener=ri,bn.editable=tr,bn.mouseSelectionStyle=Hi,bn.dragMovesSelection=zn,bn.clickAddsSelectionRange=fr,bn.decorations=S,bn.atomicRanges=C,bn.scrollMargins=P,bn.darkTheme=li,bn.contentAttributes=g,bn.editorAttributes=f,bn.lineWrapping=bn.contentAttributes.of({class:"cm-lineWrapping"}),bn.announce=v.Py.define();const Ys=4096,gs={};class Kr{constructor(e,t,r,o){this.from=e,this.to=t,this.dir=r,this.order=o}static update(e,t){if(t.empty)return e;let r=[],o=e.length?e[e.length-1].dir:ue.LTR;for(let u=Math.max(0,e.length-10);u<e.length;u++){let m=e[u];m.dir==o&&!t.touchesRange(m.from,m.to)&&r.push(new Kr(t.mapPos(m.from,1),t.mapPos(m.to,-1),m.dir,m.order))}return r}}function ki(s,e,t){for(let r=s.state.facet(e),o=r.length-1;o>=0;o--){let u=r[o],m=typeof u=="function"?u(s):u;m&&Mt(m,t)}return t}const ys=ve.mac?"mac":ve.windows?"win":ve.linux?"linux":"key";function Rs(s,e){const t=s.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let o,u,m,w;for(let A=0;A<t.length-1;++A){const D=t[A];if(/^(cmd|meta|m)$/i.test(D))w=!0;else if(/^a(lt)?$/i.test(D))o=!0;else if(/^(c|ctrl|control)$/i.test(D))u=!0;else if(/^s(hift)?$/i.test(D))m=!0;else if(/^mod$/i.test(D))e=="mac"?w=!0:u=!0;else throw new Error("Unrecognized modifier name: "+D)}return o&&(r="Alt-"+r),u&&(r="Ctrl-"+r),w&&(r="Meta-"+r),m&&(r="Shift-"+r),r}function Ki(s,e,t){return e.altKey&&(s="Alt-"+s),e.ctrlKey&&(s="Ctrl-"+s),e.metaKey&&(s="Meta-"+s),t!==!1&&e.shiftKey&&(s="Shift-"+s),s}const Ci=v.Wl.default(bn.domEventHandlers({keydown(s,e){return Mn(nt(e.state),s,e,"editor")}})),Rt=v.r$.define({enables:Ci}),qe=new WeakMap;function nt(s){let e=s.facet(Rt),t=qe.get(e);return t||qe.set(e,t=Tn(e.reduce((r,o)=>r.concat(o),[]))),t}function ht(s,e,t){return Mn(nt(s.state),e,s,t)}let jt=null;const _t=4e3;function Tn(s,e=ys){let t=Object.create(null),r=Object.create(null),o=(m,w)=>{let A=r[m];if(A==null)r[m]=w;else if(A!=w)throw new Error("Key binding "+m+" is used both as a regular binding and as a multi-stroke prefix")},u=(m,w,A,D,R)=>{var Y,Q;let ce=t[m]||(t[m]=Object.create(null)),we=w.split(/ (?!$)/).map(Ke=>Rs(Ke,e));for(let Ke=1;Ke<we.length;Ke++){let Vt=we.slice(0,Ke).join(" ");o(Vt,!0),ce[Vt]||(ce[Vt]={preventDefault:!0,stopPropagation:!1,run:[gn=>{let $t=jt={view:gn,prefix:Vt,scope:m};return setTimeout(()=>{jt==$t&&(jt=null)},_t),!0}]})}let Qe=we.join(" ");o(Qe,!1);let Le=ce[Qe]||(ce[Qe]={preventDefault:!1,stopPropagation:!1,run:((Q=(Y=ce._any)===null||Y===void 0?void 0:Y.run)===null||Q===void 0?void 0:Q.slice())||[]});A&&Le.run.push(A),D&&(Le.preventDefault=!0),R&&(Le.stopPropagation=!0)};for(let m of s){let w=m.scope?m.scope.split(" "):["editor"];if(m.any)for(let D of w){let R=t[D]||(t[D]=Object.create(null));R._any||(R._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let Y in R)R[Y].run.push(m.any)}let A=m[e]||m.key;if(A)for(let D of w)u(D,A,m.run,m.preventDefault,m.stopPropagation),m.shift&&u(D,"Shift-"+A,m.shift,m.preventDefault,m.stopPropagation)}return t}function Mn(s,e,t,r){let o=rt(e),u=(0,v.gm)(o,0),m=(0,v.nZ)(u)==o.length&&o!=" ",w="",A=!1,D=!1,R=!1;jt&&jt.view==t&&jt.scope==r&&(w=jt.prefix+" ",Ks.indexOf(e.keyCode)<0&&(D=!0,jt=null));let Y=new Set,Q=Le=>{if(Le){for(let Ke of Le.run)if(!Y.has(Ke)&&(Y.add(Ke),Ke(t,e)))return Le.stopPropagation&&(R=!0),!0;Le.preventDefault&&(Le.stopPropagation&&(R=!0),D=!0)}return!1},ce=s[r],we,Qe;return ce&&(Q(ce[w+Ki(o,e,!m)])?A=!0:m&&(e.altKey||e.metaKey||e.ctrlKey)&&!(ve.windows&&e.ctrlKey&&e.altKey)&&(we=me[e.keyCode])&&we!=o?(Q(ce[w+Ki(we,e,!0)])||e.shiftKey&&(Qe=I[e.keyCode])!=o&&Qe!=we&&Q(ce[w+Ki(Qe,e,!1)]))&&(A=!0):m&&e.shiftKey&&Q(ce[w+Ki(o,e,!0)])&&(A=!0),!A&&Q(ce._any)&&(A=!0)),D&&(A=!0),A&&R&&e.stopPropagation(),A}class lr{constructor(e,t,r,o,u){this.className=e,this.left=t,this.top=r,this.width=o,this.height=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(r.empty){let o=e.coordsAtPos(r.head,r.assoc||1);if(!o)return[];let u=ss(e);return[new lr(t,o.left-u.left,o.top-u.top,null,o.bottom-o.top)]}else return Is(e,t,r)}}function ss(s){let e=s.scrollDOM.getBoundingClientRect();return{left:(s.textDirection==ue.LTR?e.left:e.right-s.scrollDOM.clientWidth)-s.scrollDOM.scrollLeft,top:e.top-s.scrollDOM.scrollTop}}function vs(s,e,t){let r=v.jT.cursor(e);return{from:Math.max(t.from,s.moveToLineBoundary(r,!1,!0).from),to:Math.min(t.to,s.moveToLineBoundary(r,!0,!0).from),type:bt.Text}}function Is(s,e,t){if(t.to<=s.viewport.from||t.from>=s.viewport.to)return[];let r=Math.max(t.from,s.viewport.from),o=Math.min(t.to,s.viewport.to),u=s.textDirection==ue.LTR,m=s.contentDOM,w=m.getBoundingClientRect(),A=ss(s),D=m.querySelector(".cm-line"),R=D&&window.getComputedStyle(D),Y=w.left+(R?parseInt(R.paddingLeft)+Math.min(0,parseInt(R.textIndent)):0),Q=w.right-(R?parseInt(R.paddingRight):0),ce=es(s,r),we=es(s,o),Qe=ce.type==bt.Text?ce:null,Le=we.type==bt.Text?we:null;if(Qe&&(s.lineWrapping||ce.widgetLineBreaks)&&(Qe=vs(s,r,Qe)),Le&&(s.lineWrapping||we.widgetLineBreaks)&&(Le=vs(s,o,Le)),Qe&&Le&&Qe.from==Le.from)return Vt(gn(t.from,t.to,Qe));{let tn=Qe?gn(t.from,null,Qe):$t(ce,!1),et=Le?gn(null,t.to,Le):$t(we,!0),Dr=[];return(Qe||ce).to<(Le||we).from-(Qe&&Le?1:0)||ce.widgetLineBreaks>1&&tn.bottom+s.defaultLineHeight/2<et.top?Dr.push(Ke(Y,tn.bottom,Q,et.top)):tn.bottom<et.top&&s.elementAtHeight((tn.bottom+et.top)/2).type==bt.Text&&(tn.bottom=et.top=(tn.bottom+et.top)/2),Vt(tn).concat(Dr).concat(Vt(et))}function Ke(tn,et,Dr,Vi){return new lr(e,tn-A.left,et-A.top-.01,Dr-tn,Vi-et+.01)}function Vt({top:tn,bottom:et,horizontal:Dr}){let Vi=[];for(let Xi=0;Xi<Dr.length;Xi+=2)Vi.push(Ke(Dr[Xi],tn,Dr[Xi+1],et));return Vi}function gn(tn,et,Dr){let Vi=1e9,Xi=-1e9,so=[];function $s(hs,Wi,ks,us,Cs){let Pi=s.coordsAtPos(hs,hs==Dr.to?-2:2),yi=s.coordsAtPos(ks,ks==Dr.from?2:-2);!Pi||!yi||(Vi=Math.min(Pi.top,yi.top,Vi),Xi=Math.max(Pi.bottom,yi.bottom,Xi),Cs==ue.LTR?so.push(u&&Wi?Y:Pi.left,u&&us?Q:yi.right):so.push(!u&&us?Y:yi.left,!u&&Wi?Q:Pi.right))}let Es=tn!=null?tn:Dr.from,oo=et!=null?et:Dr.to;for(let hs of s.visibleRanges)if(hs.to>Es&&hs.from<oo)for(let Wi=Math.max(hs.from,Es),ks=Math.min(hs.to,oo);;){let us=s.state.doc.lineAt(Wi);for(let Cs of s.bidiSpans(us)){let Pi=Cs.from+us.from,yi=Cs.to+us.from;if(Pi>=ks)break;yi>Wi&&$s(Math.max(Pi,Wi),tn==null&&Pi<=Es,Math.min(yi,ks),et==null&&yi>=oo,Cs.dir)}if(Wi=us.to+1,Wi>=ks)break}return so.length==0&&$s(Es,tn==null,oo,et==null,s.textDirection),{top:Vi,bottom:Xi,horizontal:so}}function $t(tn,et){let Dr=w.top+(et?tn.top:tn.bottom);return{top:Dr,bottom:Dr,horizontal:[]}}}function So(s,e){return s.constructor==e.constructor&&s.eq(e)}class os{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Ji)!=e.state.facet(Ji)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(Ji);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((t,r)=>!So(t,this.drawn[r]))){let t=this.dom.firstChild,r=0;for(let o of e)o.update&&t&&o.constructor&&this.drawn[r].constructor&&o.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(o.draw(),t);for(;t;){let o=t.nextSibling;t.remove(),t=o}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Ji=v.r$.define();function wo(s){return[Zn.define(e=>new os(e,s)),Ji.of(s)]}const ti=!ve.ios,Lr=v.r$.define({combine(s){return(0,v.BO)(s,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function Ls(s={}){return[Lr.of(s),Nr,Eo,qs,Dn.of(!0)]}function Ns(s){return s.startState.facet(Lr)!=s.state.facet(Lr)}const Nr=wo({above:!0,markers(s){let{state:e}=s,t=e.facet(Lr),r=[];for(let o of e.selection.ranges){let u=o==e.selection.main;if(o.empty?!u||ti:t.drawRangeCursor){let m=u?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",w=o.empty?o:v.jT.cursor(o.head,o.head>o.anchor?-1:1);for(let A of lr.forRange(s,m,w))r.push(A)}}return r},update(s,e){s.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=Ns(s);return t&&ji(s.state,e),s.docChanged||s.selectionSet||t},mount(s,e){ji(e.state,s)},class:"cm-cursorLayer"});function ji(s,e){e.style.animationDuration=s.facet(Lr).cursorBlinkRate+"ms"}const Eo=wo({above:!1,markers(s){return s.state.selection.ranges.map(e=>e.empty?[]:lr.forRange(s,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(s,e){return s.docChanged||s.selectionSet||s.viewportChanged||Ns(s)},class:"cm-selectionLayer"}),Qs={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};ti&&(Qs[".cm-line"].caretColor="transparent !important");const qs=v.Wl.highest(bn.theme(Qs)),dr=v.Py.define({map(s,e){return s==null?null:e.mapPos(s)}}),ls=v.QQ.define({create(){return null},update(s,e){return s!=null&&(s=e.changes.mapPos(s)),e.effects.reduce((t,r)=>r.is(dr)?r.value:t,s)}}),Bs=Zn.fromClass(class{constructor(s){this.view=s,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(s){var e;let t=s.state.field(ls);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(s.startState.field(ls)!=t||s.docChanged||s.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let s=this.view.state.field(ls),e=s!=null&&this.view.coordsAtPos(s);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(s){this.cursor&&(s?(this.cursor.style.left=s.left+"px",this.cursor.style.top=s.top+"px",this.cursor.style.height=s.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(s){this.view.state.field(ls)!=s&&this.view.dispatch({effects:dr.of(s)})}},{eventHandlers:{dragover(s){this.setDropPos(this.view.posAtCoords({x:s.clientX,y:s.clientY}))},dragleave(s){(s.target==this.view.contentDOM||!this.view.contentDOM.contains(s.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function ko(){return[ls,Bs]}function Co(s,e,t,r,o){e.lastIndex=0;for(let u=s.iterRange(t,r),m=t,w;!u.next().done;m+=u.value.length)if(!u.lineBreak)for(;w=e.exec(u.value);)o(m+w.index,w)}function Oo(s,e){let t=s.visibleRanges;if(t.length==1&&t[0].from==s.viewport.from&&t[0].to==s.viewport.to)return t;let r=[];for(let{from:o,to:u}of t)o=Math.max(s.state.doc.lineAt(o).from,o-e),u=Math.min(s.state.doc.lineAt(u).to,u+e),r.length&&r[r.length-1].to>=o?r[r.length-1].to=u:r.push({from:o,to:u});return r}class _s{constructor(e){const{regexp:t,decoration:r,decorate:o,boundary:u,maxLength:m=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,o)this.addMatch=(w,A,D,R)=>o(R,D,D+w[0].length,w,A);else if(typeof r=="function")this.addMatch=(w,A,D,R)=>{let Y=r(w,A,D);Y&&R(D,D+w[0].length,Y)};else if(r)this.addMatch=(w,A,D,R)=>R(D,D+w[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=u,this.maxLength=m}createDeco(e){let t=new v.f_,r=t.add.bind(t);for(let{from:o,to:u}of Oo(e,this.maxLength))Co(e.state.doc,this.regexp,o,u,(m,w)=>this.addMatch(w,e,m,r));return t.finish()}updateDeco(e,t){let r=1e9,o=-1;return e.docChanged&&e.changes.iterChanges((u,m,w,A)=>{A>e.view.viewport.from&&w<e.view.viewport.to&&(r=Math.min(w,r),o=Math.max(A,o))}),e.viewportChanged||o-r>1e3?this.createDeco(e.view):o>-1?this.updateRange(e.view,t.map(e.changes),r,o):t}updateRange(e,t,r,o){for(let u of e.visibleRanges){let m=Math.max(u.from,r),w=Math.min(u.to,o);if(w>m){let A=e.state.doc.lineAt(m),D=A.to<w?e.state.doc.lineAt(w):A,R=Math.max(u.from,A.from),Y=Math.min(u.to,D.to);if(this.boundary){for(;m>A.from;m--)if(this.boundary.test(A.text[m-1-A.from])){R=m;break}for(;w<D.to;w++)if(this.boundary.test(D.text[w-D.from])){Y=w;break}}let Q=[],ce,we=(Qe,Le,Ke)=>Q.push(Ke.range(Qe,Le));if(A==D)for(this.regexp.lastIndex=R-A.from;(ce=this.regexp.exec(A.text))&&ce.index<Y-A.from;)this.addMatch(ce,e,ce.index+A.from,we);else Co(e.state.doc,this.regexp,R,Y,(Qe,Le)=>this.addMatch(Le,e,Qe,we));t=t.update({filterFrom:R,filterTo:Y,filter:(Qe,Le)=>Qe<R||Le>Y,add:Q})}}return t}}const Fs=/x/.unicode!=null?"gu":"g",Ao=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,Fs),To={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let eo=null;function lo(){var s;if(eo==null&&typeof document!="undefined"&&document.body){let e=document.body.style;eo=((s=e.tabSize)!==null&&s!==void 0?s:e.MozTabSize)!=null}return eo||!1}const bs=v.r$.define({combine(s){let e=(0,v.BO)(s,{render:null,specialChars:Ao,addSpecialChars:null});return(e.replaceTabs=!lo())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Fs)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Fs)),e}});function to(s={}){return[bs.of(s),Mo()]}let xs=null;function Mo(){return xs||(xs=Zn.fromClass(class{constructor(s){this.view=s,this.decorations=wt.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(s.state.facet(bs)),this.decorations=this.decorator.createDeco(s)}makeDecorator(s){return new _s({regexp:s.specialChars,decoration:(e,t,r)=>{let{doc:o}=t.state,u=(0,v.gm)(e[0],0);if(u==9){let m=o.lineAt(r),w=t.state.tabSize,A=(0,v.IS)(m.text,w,r-m.from);return wt.replace({widget:new Do((w-A%w)*this.view.defaultCharacterWidth)})}return this.decorationCache[u]||(this.decorationCache[u]=wt.replace({widget:new cs(s,u)}))},boundary:s.replaceTabs?void 0:/[^]/})}update(s){let e=s.state.facet(bs);s.startState.facet(bs)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(s.view)):this.decorations=this.decorator.updateDeco(s,this.decorations)}},{decorations:s=>s.decorations}))}const Po="\u2022";function as(s){return s>=32?Po:s==10?"\u2424":String.fromCharCode(9216+s)}class cs extends Jt{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=as(this.code),r=e.state.phrase("Control character")+" "+(To[this.code]||"0x"+this.code.toString(16)),o=this.options.render&&this.options.render(this.code,r,t);if(o)return o;let u=document.createElement("span");return u.textContent=t,u.title=r,u.setAttribute("aria-label",r),u.className="cm-specialChar",u}ignoreEvent(){return!1}}class Do extends Jt{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const $i=null;function no(){return[$i,g.of(s=>{var e;return((e=s.plugin($i))===null||e===void 0?void 0:e.attrs)||null})]}function Ro(){return co}const ao=wt.line({class:"cm-activeLine"}),co=Zn.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.docChanged||s.selectionSet)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let e=-1,t=[];for(let r of s.state.selection.ranges){let o=s.lineBlockAt(r.head);o.from>e&&(t.push(ao.range(o.from)),e=o.from)}return wt.set(t)}},{decorations:s=>s.decorations});class Jo extends Jt{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?Je(e.firstChild):[];if(!t.length)return null;let r=window.getComputedStyle(e.parentNode),o=je(t[0],r.direction!="rtl"),u=parseInt(r.lineHeight);return o.bottom-o.top>u*1.5?{left:o.left,right:o.right,top:o.top,bottom:o.top+u}:o}ignoreEvent(){return!1}}function Io(s){return Zn.fromClass(class{constructor(e){this.view=e,this.placeholder=s?wt.set([wt.widget({widget:new Jo(s),side:1}).range(0)]):wt.none}get decorations(){return this.view.state.doc.length?wt.none:this.placeholder}},{decorations:e=>e.decorations})}const fo=2e3;function Go(s,e,t){let r=Math.min(e.line,t.line),o=Math.max(e.line,t.line),u=[];if(e.off>fo||t.off>fo||e.col<0||t.col<0){let m=Math.min(e.off,t.off),w=Math.max(e.off,t.off);for(let A=r;A<=o;A++){let D=s.doc.line(A);D.length<=w&&u.push(v.jT.range(D.from+m,D.to+w))}}else{let m=Math.min(e.col,t.col),w=Math.max(e.col,t.col);for(let A=r;A<=o;A++){let D=s.doc.line(A),R=(0,v.Gz)(D.text,m,s.tabSize,!0);if(R<0)u.push(v.jT.cursor(D.to));else{let Y=(0,v.Gz)(D.text,w,s.tabSize);u.push(v.jT.range(D.from+R,D.from+Y))}}}return u}function Lo(s,e){let t=s.coordsAtPos(s.viewport.from);return t?Math.round(Math.abs((t.left-e)/s.defaultCharacterWidth)):-1}function ro(s,e){let t=s.posAtCoords({x:e.clientX,y:e.clientY},!1),r=s.state.doc.lineAt(t),o=t-r.from,u=o>fo?-1:o==r.length?Lo(s,e.clientX):(0,v.IS)(r.text,s.state.tabSize,t-r.from);return{line:r.number,col:u,off:o}}function No(s,e){let t=ro(s,e),r=s.state.selection;return t?{update(o){if(o.docChanged){let u=o.changes.mapPos(o.startState.doc.line(t.line).from),m=o.state.doc.lineAt(u);t={line:m.number,col:t.col,off:Math.min(t.off,m.length)},r=r.map(o.changes)}},get(o,u,m){let w=ro(s,o);if(!w)return r;let A=Go(s.state,t,w);return A.length?m?v.jT.create(A.concat(r.ranges)):v.jT.create(A):r}}:null}function Xo(s){let e=(s==null?void 0:s.eventFilter)||(t=>t.altKey&&t.button==0);return bn.mouseSelectionStyle.of((t,r)=>e(r)?No(t,r):null)}const Bo={Alt:[18,s=>!!s.altKey],Control:[17,s=>!!s.ctrlKey],Shift:[16,s=>!!s.shiftKey],Meta:[91,s=>!!s.metaKey]},Fo={style:"cursor: crosshair"};function ho(s={}){let[e,t]=Bo[s.key||"Alt"],r=Zn.fromClass(class{constructor(o){this.view=o,this.isDown=!1}set(o){this.isDown!=o&&(this.isDown=o,this.view.update([]))}},{eventHandlers:{keydown(o){this.set(o.keyCode==e||t(o))},keyup(o){(o.keyCode==e||!t(o))&&this.set(!1)},mousemove(o){this.set(t(o))}}});return[r,bn.contentAttributes.of(o=>{var u;return!((u=o.plugin(r))===null||u===void 0)&&u.isDown?Fo:null})]}const Ss="-10000px";class uo{constructor(e,t,r){this.facet=t,this.createTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o),this.tooltipViews=this.tooltips.map(r)}update(e){var t;let r=e.state.facet(this.facet),o=r.filter(m=>m);if(r===this.input){for(let m of this.tooltipViews)m.update&&m.update(e);return!1}let u=[];for(let m=0;m<o.length;m++){let w=o[m],A=-1;if(w){for(let D=0;D<this.tooltips.length;D++){let R=this.tooltips[D];R&&R.create==w.create&&(A=D)}if(A<0)u[m]=this.createTooltipView(w);else{let D=u[m]=this.tooltipViews[A];D.update&&D.update(e)}}}for(let m of this.tooltipViews)u.indexOf(m)<0&&(m.dom.remove(),(t=m.destroy)===null||t===void 0||t.call(m));return this.input=r,this.tooltips=o,this.tooltipViews=u,!0}}function jo(s={}){return io.of(s)}function po(s){let{win:e}=s;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const io=v.r$.define({combine:s=>{var e,t,r;return{position:ve.ios?"absolute":((e=s.find(o=>o.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=s.find(o=>o.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((r=s.find(o=>o.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||po}}}),fs=new WeakMap,Oi=Zn.fromClass(class{constructor(s){this.view=s,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=s.state.facet(io);this.position=e.position,this.parent=e.parent,this.classes=s.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new uo(s,a,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),s.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let s of this.manager.tooltipViews)this.intersectionObserver.observe(s.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(s){s.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(s);e&&this.observeIntersection();let t=e||s.geometryChanged,r=s.state.facet(io);if(r.position!=this.position){this.position=r.position;for(let o of this.manager.tooltipViews)o.dom.style.position=this.position;t=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let o of this.manager.tooltipViews)this.container.appendChild(o.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(s){let e=s.create(this.view);if(e.dom.classList.add("cm-tooltip"),s.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=Ss,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var s,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(s=t.destroy)===null||s===void 0||s.call(t);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let s=this.view.dom.getBoundingClientRect();return{editor:s,parent:this.parent?this.container.getBoundingClientRect():s,pos:this.manager.tooltips.map((e,t)=>{let r=this.manager.tooltipViews[t];return r.getCoords?r.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(io).tooltipSpace(this.view)}}writeMeasure(s){var e;let{editor:t,space:r}=s,o=[];for(let u=0;u<this.manager.tooltips.length;u++){let m=this.manager.tooltips[u],w=this.manager.tooltipViews[u],{dom:A}=w,D=s.pos[u],R=s.size[u];if(!D||D.bottom<=Math.max(t.top,r.top)||D.top>=Math.min(t.bottom,r.bottom)||D.right<Math.max(t.left,r.left)-.1||D.left>Math.min(t.right,r.right)+.1){A.style.top=Ss;continue}let Y=m.arrow?w.dom.querySelector(".cm-tooltip-arrow"):null,Q=Y?7:0,ce=R.right-R.left,we=(e=fs.get(w))!==null&&e!==void 0?e:R.bottom-R.top,Qe=w.offset||h,Le=this.view.textDirection==ue.LTR,Ke=R.width>r.right-r.left?Le?r.left:r.right-R.width:Le?Math.min(D.left-(Y?14:0)+Qe.x,r.right-ce):Math.max(r.left,D.left-ce+(Y?14:0)-Qe.x),Vt=!!m.above;!m.strictSide&&(Vt?D.top-(R.bottom-R.top)-Qe.y<r.top:D.bottom+(R.bottom-R.top)+Qe.y>r.bottom)&&Vt==r.bottom-D.bottom>D.top-r.top&&(Vt=!Vt);let gn=(Vt?D.top-r.top:r.bottom-D.bottom)-Q;if(gn<we&&w.resize!==!1){if(gn<this.view.defaultLineHeight){A.style.top=Ss;continue}fs.set(w,we),A.style.height=(we=gn)+"px"}else A.style.height&&(A.style.height="");let $t=Vt?D.top-we-Q-Qe.y:D.bottom+Q+Qe.y,tn=Ke+ce;if(w.overlap!==!0)for(let et of o)et.left<tn&&et.right>Ke&&et.top<$t+we&&et.bottom>$t&&($t=Vt?et.top-we-2-Q:et.bottom+Q+2);this.position=="absolute"?(A.style.top=$t-s.parent.top+"px",A.style.left=Ke-s.parent.left+"px"):(A.style.top=$t+"px",A.style.left=Ke+"px"),Y&&(Y.style.left=`${D.left+(Le?Qe.x:-Qe.x)-(Ke+14-7)}px`),w.overlap!==!0&&o.push({left:Ke,top:$t,right:tn,bottom:$t+we}),A.classList.toggle("cm-tooltip-above",Vt),A.classList.toggle("cm-tooltip-below",!Vt),w.positioned&&w.positioned(s.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let s of this.manager.tooltipViews)s.dom.style.top=Ss}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),mo=bn.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),h={x:0,y:0},a=v.r$.define({enables:[Oi,mo]}),d=v.r$.define();class x{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new uo(e,d,t=>this.createHostedView(t))}static create(e){return new x(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}}const E=a.compute([d],s=>{let e=s.facet(d).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:x.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class F{constructor(e,t,r,o,u){this.view=e,this.source=t,this.field=r,this.setHover=o,this.hoverTime=u,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let r=this.view.coordsAtPos(t);if(r==null||e.y<r.top||e.y>r.bottom||e.x<r.left-this.view.defaultCharacterWidth||e.x>r.right+this.view.defaultCharacterWidth)return;let o=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(w=>w.from<=t&&w.to>=t),u=o&&o.dir==ue.RTL?-1:1,m=this.source(this.view,t,e.x<r.left?-u:u);if(m!=null&&m.then){let w=this.pending={pos:t};m.then(A=>{this.pending==w&&(this.pending=null,A&&this.view.dispatch({effects:this.setHover.of(A)}))},A=>kn(this.view.state,A,"hover tooltip"))}else m&&this.view.dispatch({effects:this.setHover.of(m)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let r=this.active;if(r&&!J(this.lastMove.target)||this.pending){let{pos:o}=r||this.pending,u=(t=r==null?void 0:r.end)!==null&&t!==void 0?t:o;(o==u?this.view.posAtCoords(this.lastMove)!=o:!_(this.view,o,u,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!J(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function J(s){for(let e=s;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function _(s,e,t,r,o,u){let m=document.createRange(),w=s.domAtPos(e),A=s.domAtPos(t);m.setEnd(A.node,A.offset),m.setStart(w.node,w.offset);let D=m.getClientRects();m.detach();for(let R=0;R<D.length;R++){let Y=D[R];if(Math.max(Y.top-o,o-Y.bottom,Y.left-r,r-Y.right)<=u)return!0}return!1}function de(s,e={}){let t=v.Py.define(),r=v.QQ.define({create(){return null},update(o,u){if(o&&(e.hideOnChange&&(u.docChanged||u.selection)||e.hideOn&&e.hideOn(u,o)))return null;if(o&&u.docChanged){let m=u.changes.mapPos(o.pos,-1,v.gc.TrackDel);if(m==null)return null;let w=Object.assign(Object.create(null),o);w.pos=m,o.end!=null&&(w.end=u.changes.mapPos(o.end)),o=w}for(let m of u.effects)m.is(t)&&(o=m.value),m.is(Ve)&&(o=null);return o},provide:o=>d.from(o)});return[r,Zn.define(o=>new F(o,s,r,t,e.hoverTime||300)),E]}function ie(s,e){let t=s.plugin(Oi);if(!t)return null;let r=t.manager.tooltips.indexOf(e);return r<0?null:t.manager.tooltipViews[r]}function Ce(s){return s.facet(d).some(e=>e)}const Ve=v.Py.define(),dt=null;function Ht(s){var e;(e=s.plugin(Oi))===null||e===void 0||e.maybeMeasure()}const mn=v.r$.define({combine(s){let e,t;for(let r of s)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function en(s){return s?[mn.of(s)]:[]}function _n(s,e){let t=s.plugin(Pr),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const Pr=Zn.fromClass(class{constructor(s){this.input=s.state.facet(Ai),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(s));let e=s.state.facet(mn);this.top=new Sr(s,!0,e.topContainer),this.bottom=new Sr(s,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(s){let e=s.state.facet(mn);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Sr(s.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Sr(s.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=s.state.facet(Ai);if(t!=this.input){let r=t.filter(A=>A),o=[],u=[],m=[],w=[];for(let A of r){let D=this.specs.indexOf(A),R;D<0?(R=A(s.view),w.push(R)):(R=this.panels[D],R.update&&R.update(s)),o.push(R),(R.top?u:m).push(R)}this.specs=r,this.panels=o,this.top.sync(u),this.bottom.sync(m);for(let A of w)A.dom.classList.add("cm-panel"),A.mount&&A.mount()}else for(let r of this.panels)r.update&&r.update(s)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:s=>bn.scrollMargins.of(e=>{let t=e.plugin(s);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Sr{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Br(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Br(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Br(s){let e=s.nextSibling;return s.remove(),e}const Ai=v.r$.define({enables:Pr});class ar extends v.uU{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ar.prototype.elementClass="",ar.prototype.toDOM=void 0,ar.prototype.mapMode=v.gc.TrackBefore,ar.prototype.startSide=ar.prototype.endSide=-1,ar.prototype.point=!0;const Ti=v.r$.define(),Gi={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>v.Xs.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},js=v.r$.define();function $o(s){return[pr(),js.of(Object.assign(Object.assign({},Gi),s))]}const go=v.r$.define({combine:s=>s.some(e=>e)});function pr(s){let e=[Jr];return s&&s.fixed===!1&&e.push(go.of(!0)),e}const Jr=Zn.fromClass(class{constructor(s){this.view=s,this.prevViewport=s.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=s.state.facet(js).map(e=>new Vo(s,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!s.state.facet(go),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),s.scrollDOM.insertBefore(this.dom,s.contentDOM)}update(s){if(this.updateGutters(s)){let e=this.prevViewport,t=s.view.viewport,r=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(r<(t.to-t.from)*.8)}s.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(go)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=s.view.viewport}syncGutters(s){let e=this.dom.nextSibling;s&&this.dom.remove();let t=v.Xs.iter(this.view.state.facet(Ti),this.view.viewport.from),r=[],o=this.gutters.map(u=>new Yo(u,this.view.viewport,-this.view.documentPadding.top));for(let u of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(u.type)){let m=!0;for(let w of u.type)if(w.type==bt.Text&&m){Mi(t,r,w.from);for(let A of o)A.line(this.view,w,r);m=!1}else if(w.widget)for(let A of o)A.widget(this.view,w)}else if(u.type==bt.Text){Mi(t,r,u.from);for(let m of o)m.line(this.view,u,r)}for(let u of o)u.finish();s&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(s){let e=s.startState.facet(js),t=s.state.facet(js),r=s.docChanged||s.heightChanged||s.viewportChanged||!v.Xs.eq(s.startState.facet(Ti),s.state.facet(Ti),s.view.viewport.from,s.view.viewport.to);if(e==t)for(let o of this.gutters)o.update(s)&&(r=!0);else{r=!0;let o=[];for(let u of t){let m=e.indexOf(u);m<0?o.push(new Vo(this.view,u)):(this.gutters[m].update(s),o.push(this.gutters[m]))}for(let u of this.gutters)u.dom.remove(),o.indexOf(u)<0&&u.destroy();for(let u of o)this.dom.appendChild(u.dom);this.gutters=o}return r}destroy(){for(let s of this.gutters)s.destroy();this.dom.remove()}},{provide:s=>bn.scrollMargins.of(e=>{let t=e.plugin(s);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==ue.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function gi(s){return Array.isArray(s)?s:[s]}function Mi(s,e,t){for(;s.value&&s.from<=t;)s.from==t&&e.push(s.value),s.next()}class Yo{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=v.Xs.iter(e.markers,t.from)}addElement(e,t,r){let{gutter:o}=this,u=t.top-this.height;if(this.i==o.elements.length){let m=new tl(e,t.height,u,r);o.elements.push(m),o.dom.appendChild(m.dom)}else o.elements[this.i].update(e,t.height,u,r);this.height=t.bottom,this.i++}line(e,t,r){let o=[];Mi(this.cursor,o,t.from),r.length&&(o=o.concat(r));let u=this.gutter.config.lineMarker(e,t,o);u&&o.unshift(u);let m=this.gutter;o.length==0&&!m.config.renderEmptyElements||this.addElement(e,t,o)}widget(e,t){let r=this.gutter.config.widgetMarker(e,t.widget,t);r&&this.addElement(e,t,[r])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Vo{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in t.domEventHandlers)this.dom.addEventListener(r,o=>{let u=o.target,m;if(u!=this.dom&&this.dom.contains(u)){for(;u.parentNode!=this.dom;)u=u.parentNode;let A=u.getBoundingClientRect();m=(A.top+A.bottom)/2}else m=o.clientY;let w=e.lineBlockAtHeight(m-e.documentTop);t.domEventHandlers[r](e,w,o)&&o.preventDefault()});this.markers=gi(t.markers(e)),t.initialSpacer&&(this.spacer=new tl(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=gi(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let o=this.config.updateSpacer(this.spacer.markers[0],e);o!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[o])}let r=e.view.viewport;return!v.Xs.eq(this.markers,t,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class tl{constructor(e,t,r,o){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,o)}update(e,t,r,o){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),yo(this.markers,o)||this.setMarkers(e,o)}setMarkers(e,t){let r="cm-gutterElement",o=this.dom.firstChild;for(let u=0,m=0;;){let w=m,A=u<t.length?t[u++]:null,D=!1;if(A){let R=A.elementClass;R&&(r+=" "+R);for(let Y=m;Y<this.markers.length;Y++)if(this.markers[Y].compare(A)){w=Y,D=!0;break}}else w=this.markers.length;for(;m<w;){let R=this.markers[m++];if(R.toDOM){R.destroy(o);let Y=o.nextSibling;o.remove(),o=Y}}if(!A)break;A.toDOM&&(D?o=o.nextSibling:this.dom.insertBefore(A.toDOM(e),o)),D&&m++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}function yo(s,e){if(s.length!=e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].compare(e[t]))return!1;return!0}const Wo=v.r$.define(),ws=v.r$.define({combine(s){return(0,v.BO)(s,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let o in t){let u=r[o],m=t[o];r[o]=u?(w,A,D)=>u(w,A,D)||m(w,A,D):m}return r}})}});class kr extends ar{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Qo(s,e){return s.state.facet(ws).formatNumber(e,s.state)}const nl=js.compute([ws],s=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Wo)},lineMarker(e,t,r){return r.some(o=>o.toDOM)?null:new kr(Qo(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(ws)!=e.state.facet(ws),initialSpacer(e){return new kr(Qo(e,Ho(e.state.doc.lines)))},updateSpacer(e,t){let r=Qo(t.view,Ho(t.view.state.doc.lines));return r==e.number?e:new kr(r)},domEventHandlers:s.facet(ws).domEventHandlers}));function rl(s={}){return[ws.of(s),pr(),nl]}function Ho(s){let e=9;for(;e<s;)e=e*10+9;return e}const il=new class extends ar{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},qo=Ti.compute(["selection"],s=>{let e=[],t=-1;for(let r of s.selection.ranges){let o=s.doc.lineAt(r.head).from;o>t&&(t=o,e.push(il.range(o)))}return v.Xs.of(e)});function sl(){return qo}const ol=new Map;function ll(s){let e=ol.get(s);return e||ol.set(s,e=wt.mark({attributes:s==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":s.replace(/ /g,"\xB7")}})),e}function zo(s){return Zn.define(e=>({decorations:s.createDeco(e),update(t){this.decorations=s.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const Zo=zo(new _s({regexp:/\t| +/g,decoration:s=>ll(s[0]),boundary:/\S/}));function yl(){return Zo}const dl=zo(new _s({regexp:/\s+$/g,decoration:wt.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function al(){return dl}const cl={HeightMap:qn,HeightOracle:Kn,MeasuredHeights:Ni,QueryType:Ut,ChangedRange:U,computeOrder:Ri,moveVisually:bi}},21649:function(Bn,pt,z){"use strict";z.d(pt,{Jq:function(){return De},Lj:function(){return Tt},_b:function(){return Ue},i9:function(){return Ae},md:function(){return I},mp:function(){return gt},vj:function(){return He}});const v=1024;let ke=0;class me{constructor(O,N){this.from=O,this.to=N}}class I{constructor(O={}){this.id=ke++,this.perNode=!!O.perNode,this.deserialize=O.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(O){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof O!="function"&&(O=De.match(O)),N=>{let W=O(N);return W===void 0?null:[this,W]}}}I.closedBy=new I({deserialize:Ee=>Ee.split(" ")}),I.openedBy=new I({deserialize:Ee=>Ee.split(" ")}),I.group=new I({deserialize:Ee=>Ee.split(" ")}),I.contextHash=new I({perNode:!0}),I.lookAhead=new I({perNode:!0}),I.mounted=new I({perNode:!0});class se{constructor(O,N,W){this.tree=O,this.overlay=N,this.parser=W}}const Ne=Object.create(null);class De{constructor(O,N,W,G=0){this.name=O,this.props=N,this.id=W,this.flags=G}static define(O){let N=O.props&&O.props.length?Object.create(null):Ne,W=(O.top?1:0)|(O.skipped?2:0)|(O.error?4:0)|(O.name==null?8:0),G=new De(O.name||"",N,O.id,W);if(O.props){for(let ne of O.props)if(Array.isArray(ne)||(ne=ne(G)),ne){if(ne[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");N[ne[0].id]=ne[1]}}return G}prop(O){return this.props[O.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(O){if(typeof O=="string"){if(this.name==O)return!0;let N=this.prop(I.group);return N?N.indexOf(O)>-1:!1}return this.id==O}static match(O){let N=Object.create(null);for(let W in O)for(let G of W.split(" "))N[G]=O[W];return W=>{for(let G=W.prop(I.group),ne=-1;ne<(G?G.length:0);ne++){let pe=N[ne<0?W.name:G[ne]];if(pe)return pe}}}}De.none=new De("",Object.create(null),0,8);class Tt{constructor(O){this.types=O;for(let N=0;N<O.length;N++)if(O[N].id!=N)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...O){let N=[];for(let W of this.types){let G=null;for(let ne of O){let pe=ne(W);pe&&(G||(G=Object.assign({},W.props)),G[pe[0].id]=pe[1])}N.push(G?new De(W.name,G,W.id,W.flags):W)}return new Tt(N)}}const rt=new WeakMap,st=new WeakMap;var He;(function(Ee){Ee[Ee.ExcludeBuffers=1]="ExcludeBuffers",Ee[Ee.IncludeAnonymous=2]="IncludeAnonymous",Ee[Ee.IgnoreMounts=4]="IgnoreMounts",Ee[Ee.IgnoreOverlays=8]="IgnoreOverlays"})(He||(He={}));class gt{constructor(O,N,W,G,ne){if(this.type=O,this.children=N,this.positions=W,this.length=G,this.props=null,ne&&ne.length){this.props=Object.create(null);for(let[pe,Se]of ne)this.props[typeof pe=="number"?pe:pe.id]=Se}}toString(){let O=this.prop(I.mounted);if(O&&!O.overlay)return O.tree.toString();let N="";for(let W of this.children){let G=W.toString();G&&(N&&(N+=","),N+=G)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(N.length?"("+N+")":""):N}cursor(O=0){return new Ye(this.topNode,O)}cursorAt(O,N=0,W=0){let G=rt.get(this)||this.topNode,ne=new Ye(G);return ne.moveTo(O,N),rt.set(this,ne._tree),ne}get topNode(){return new ge(this,0,0,null)}resolve(O,N=0){let W=Me(rt.get(this)||this.topNode,O,N,!1);return rt.set(this,W),W}resolveInner(O,N=0){let W=Me(st.get(this)||this.topNode,O,N,!0);return st.set(this,W),W}iterate(O){let{enter:N,leave:W,from:G=0,to:ne=this.length}=O,pe=O.mode||0,Se=(pe&He.IncludeAnonymous)>0;for(let $e=this.cursor(pe|He.IncludeAnonymous);;){let ve=!1;if($e.from<=ne&&$e.to>=G&&(!Se&&$e.type.isAnonymous||N($e)!==!1)){if($e.firstChild())continue;ve=!0}for(;ve&&W&&(Se||!$e.type.isAnonymous)&&W($e),!$e.nextSibling();){if(!$e.parent())return;ve=!0}}}prop(O){return O.perNode?this.props?this.props[O.id]:void 0:this.type.prop(O)}get propValues(){let O=[];if(this.props)for(let N in this.props)O.push([+N,this.props[N]]);return O}balance(O={}){return this.children.length<=8?this:ze(De.none,this.children,this.positions,0,this.children.length,0,this.length,(N,W,G)=>new gt(this.type,N,W,G,this.propValues),O.makeTree||((N,W,G)=>new gt(De.none,N,W,G)))}static build(O){return yt(O)}}gt.empty=new gt(De.none,[],[],0);class tt{constructor(O,N){this.buffer=O,this.index=N}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new tt(this.buffer,this.index)}}class Je{constructor(O,N,W){this.buffer=O,this.length=N,this.set=W}get type(){return De.none}toString(){let O=[];for(let N=0;N<this.buffer.length;)O.push(this.childString(N)),N=this.buffer[N+3];return O.join(",")}childString(O){let N=this.buffer[O],W=this.buffer[O+3],G=this.set.types[N],ne=G.name;if(/\W/.test(ne)&&!G.isError&&(ne=JSON.stringify(ne)),O+=4,W==O)return ne;let pe=[];for(;O<W;)pe.push(this.childString(O)),O=this.buffer[O+3];return ne+"("+pe.join(",")+")"}findChild(O,N,W,G,ne){let{buffer:pe}=this,Se=-1;for(let $e=O;$e!=N&&!(It(ne,G,pe[$e+1],pe[$e+2])&&(Se=$e,W>0));$e=pe[$e+3]);return Se}slice(O,N,W){let G=this.buffer,ne=new Uint16Array(N-O),pe=0;for(let Se=O,$e=0;Se<N;){ne[$e++]=G[Se++],ne[$e++]=G[Se++]-W;let ve=ne[$e++]=G[Se++]-W;ne[$e++]=G[Se++]-O,pe=Math.max(pe,ve)}return new Je(ne,pe,this.set)}}function It(Ee,O,N,W){switch(Ee){case-2:return N<O;case-1:return W>=O&&N<O;case 0:return N<O&&W>O;case 1:return N<=O&&W>O;case 2:return W>O;case 4:return!0}}function ee(Ee,O){let N=Ee.childBefore(O);for(;N;){let W=N.lastChild;if(!W||W.to!=N.to)break;W.type.isError&&W.from==W.to?(Ee=N,N=W.prevSibling):N=W}return Ee}function Me(Ee,O,N,W){for(var G;Ee.from==Ee.to||(N<1?Ee.from>=O:Ee.from>O)||(N>-1?Ee.to<=O:Ee.to<O);){let pe=!W&&Ee instanceof ge&&Ee.index<0?null:Ee.parent;if(!pe)return Ee;Ee=pe}let ne=W?0:He.IgnoreOverlays;if(W)for(let pe=Ee,Se=pe.parent;Se;pe=Se,Se=pe.parent)pe instanceof ge&&pe.index<0&&((G=Se.enter(O,N,ne))===null||G===void 0?void 0:G.from)!=pe.from&&(Ee=Se);for(;;){let pe=Ee.enter(O,N,ne);if(!pe)return Ee;Ee=pe}}class ge{constructor(O,N,W,G){this._tree=O,this.from=N,this.index=W,this._parent=G}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(O,N,W,G,ne=0){for(let pe=this;;){for(let{children:Se,positions:$e}=pe._tree,ve=N>0?Se.length:-1;O!=ve;O+=N){let ut=Se[O],St=$e[O]+pe.from;if(It(G,W,St,St+ut.length)){if(ut instanceof Je){if(ne&He.ExcludeBuffers)continue;let at=ut.findChild(0,ut.buffer.length,N,W-St,G);if(at>-1)return new Xe(new Oe(pe,ut,O,St),null,at)}else if(ne&He.IncludeAnonymous||!ut.type.isAnonymous||K(ut)){let at;if(!(ne&He.IgnoreMounts)&&ut.props&&(at=ut.prop(I.mounted))&&!at.overlay)return new ge(at.tree,St,O,pe);let zt=new ge(ut,St,O,pe);return ne&He.IncludeAnonymous||!zt.type.isAnonymous?zt:zt.nextChild(N<0?ut.children.length-1:0,N,W,G)}}}if(ne&He.IncludeAnonymous||!pe.type.isAnonymous||(pe.index>=0?O=pe.index+N:O=N<0?-1:pe._parent._tree.children.length,pe=pe._parent,!pe))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(O){return this.nextChild(0,1,O,2)}childBefore(O){return this.nextChild(this._tree.children.length-1,-1,O,-2)}enter(O,N,W=0){let G;if(!(W&He.IgnoreOverlays)&&(G=this._tree.prop(I.mounted))&&G.overlay){let ne=O-this.from;for(let{from:pe,to:Se}of G.overlay)if((N>0?pe<=ne:pe<ne)&&(N<0?Se>=ne:Se>ne))return new ge(G.tree,G.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,O,N,W)}nextSignificantParent(){let O=this;for(;O.type.isAnonymous&&O._parent;)O=O._parent;return O}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(O=0){return new Ye(this,O)}get tree(){return this._tree}toTree(){return this._tree}resolve(O,N=0){return Me(this,O,N,!1)}resolveInner(O,N=0){return Me(this,O,N,!0)}enterUnfinishedNodesBefore(O){return ee(this,O)}getChild(O,N=null,W=null){let G=je(this,O,N,W);return G.length?G[0]:null}getChildren(O,N=null,W=null){return je(this,O,N,W)}toString(){return this._tree.toString()}get node(){return this}matchContext(O){return Ze(this,O)}}function je(Ee,O,N,W){let G=Ee.cursor(),ne=[];if(!G.firstChild())return ne;if(N!=null){for(;!G.type.is(N);)if(!G.nextSibling())return ne}for(;;){if(W!=null&&G.type.is(W))return ne;if(G.type.is(O)&&ne.push(G.node),!G.nextSibling())return W==null?ne:[]}}function Ze(Ee,O,N=O.length-1){for(let W=Ee.parent;N>=0;W=W.parent){if(!W)return!1;if(!W.type.isAnonymous){if(O[N]&&O[N]!=W.name)return!1;N--}}return!0}class Oe{constructor(O,N,W,G){this.parent=O,this.buffer=N,this.index=W,this.start=G}}class Xe{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(O,N,W){this.context=O,this._parent=N,this.index=W,this.type=O.buffer.set.types[O.buffer.buffer[W]]}child(O,N,W){let{buffer:G}=this.context,ne=G.findChild(this.index+4,G.buffer[this.index+3],O,N-this.context.start,W);return ne<0?null:new Xe(this.context,this,ne)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(O){return this.child(1,O,2)}childBefore(O){return this.child(-1,O,-2)}enter(O,N,W=0){if(W&He.ExcludeBuffers)return null;let{buffer:G}=this.context,ne=G.findChild(this.index+4,G.buffer[this.index+3],N>0?1:-1,O-this.context.start,N);return ne<0?null:new Xe(this.context,this,ne)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(O){return this._parent?null:this.context.parent.nextChild(this.context.index+O,O,0,4)}get nextSibling(){let{buffer:O}=this.context,N=O.buffer[this.index+3];return N<(this._parent?O.buffer[this._parent.index+3]:O.buffer.length)?new Xe(this.context,this._parent,N):this.externalSibling(1)}get prevSibling(){let{buffer:O}=this.context,N=this._parent?this._parent.index+4:0;return this.index==N?this.externalSibling(-1):new Xe(this.context,this._parent,O.findChild(N,this.index,-1,0,4))}cursor(O=0){return new Ye(this,O)}get tree(){return null}toTree(){let O=[],N=[],{buffer:W}=this.context,G=this.index+4,ne=W.buffer[this.index+3];if(ne>G){let pe=W.buffer[this.index+1];O.push(W.slice(G,ne,pe)),N.push(0)}return new gt(this.type,O,N,this.to-this.from)}resolve(O,N=0){return Me(this,O,N,!1)}resolveInner(O,N=0){return Me(this,O,N,!0)}enterUnfinishedNodesBefore(O){return ee(this,O)}toString(){return this.context.buffer.childString(this.index)}getChild(O,N=null,W=null){let G=je(this,O,N,W);return G.length?G[0]:null}getChildren(O,N=null,W=null){return je(this,O,N,W)}get node(){return this}matchContext(O){return Ze(this,O)}}class Ye{get name(){return this.type.name}constructor(O,N=0){if(this.mode=N,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,O instanceof ge)this.yieldNode(O);else{this._tree=O.context.parent,this.buffer=O.context;for(let W=O._parent;W;W=W._parent)this.stack.unshift(W.index);this.bufferNode=O,this.yieldBuf(O.index)}}yieldNode(O){return O?(this._tree=O,this.type=O.type,this.from=O.from,this.to=O.to,!0):!1}yieldBuf(O,N){this.index=O;let{start:W,buffer:G}=this.buffer;return this.type=N||G.set.types[G.buffer[O]],this.from=W+G.buffer[O+1],this.to=W+G.buffer[O+2],!0}yield(O){return O?O instanceof ge?(this.buffer=null,this.yieldNode(O)):(this.buffer=O.context,this.yieldBuf(O.index,O.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(O,N,W){if(!this.buffer)return this.yield(this._tree.nextChild(O<0?this._tree._tree.children.length-1:0,O,N,W,this.mode));let{buffer:G}=this.buffer,ne=G.findChild(this.index+4,G.buffer[this.index+3],O,N-this.buffer.start,W);return ne<0?!1:(this.stack.push(this.index),this.yieldBuf(ne))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(O){return this.enterChild(1,O,2)}childBefore(O){return this.enterChild(-1,O,-2)}enter(O,N,W=this.mode){return this.buffer?W&He.ExcludeBuffers?!1:this.enterChild(1,O,N):this.yield(this._tree.enter(O,N,W))}parent(){if(!this.buffer)return this.yieldNode(this.mode&He.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let O=this.mode&He.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(O)}sibling(O){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+O,O,0,4,this.mode)):!1;let{buffer:N}=this.buffer,W=this.stack.length-1;if(O<0){let G=W<0?0:this.stack[W]+4;if(this.index!=G)return this.yieldBuf(N.findChild(G,this.index,-1,0,4))}else{let G=N.buffer[this.index+3];if(G<(W<0?N.buffer.length:N.buffer[this.stack[W]+3]))return this.yieldBuf(G)}return W<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+O,O,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(O){let N,W,{buffer:G}=this;if(G){if(O>0){if(this.index<G.buffer.buffer.length)return!1}else for(let ne=0;ne<this.index;ne++)if(G.buffer.buffer[ne+3]<this.index)return!1;({index:N,parent:W}=G)}else({index:N,_parent:W}=this._tree);for(;W;{index:N,_parent:W}=W)if(N>-1)for(let ne=N+O,pe=O<0?-1:W._tree.children.length;ne!=pe;ne+=O){let Se=W._tree.children[ne];if(this.mode&He.IncludeAnonymous||Se instanceof Je||!Se.type.isAnonymous||K(Se))return!1}return!0}move(O,N){if(N&&this.enterChild(O,0,4))return!0;for(;;){if(this.sibling(O))return!0;if(this.atLastNode(O)||!this.parent())return!1}}next(O=!0){return this.move(1,O)}prev(O=!0){return this.move(-1,O)}moveTo(O,N=0){for(;(this.from==this.to||(N<1?this.from>=O:this.from>O)||(N>-1?this.to<=O:this.to<O))&&this.parent(););for(;this.enterChild(1,O,N););return this}get node(){if(!this.buffer)return this._tree;let O=this.bufferNode,N=null,W=0;if(O&&O.context==this.buffer){e:for(let G=this.index,ne=this.stack.length;ne>=0;){for(let pe=O;pe;pe=pe._parent)if(pe.index==G){if(G==this.index)return pe;N=pe,W=ne+1;break e}G=this.stack[--ne]}}for(let G=W;G<this.stack.length;G++)N=new Xe(this.buffer,N,this.stack[G]);return this.bufferNode=new Xe(this.buffer,N,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(O,N){for(let W=0;;){let G=!1;if(this.type.isAnonymous||O(this)!==!1){if(this.firstChild()){W++;continue}this.type.isAnonymous||(G=!0)}for(;G&&N&&N(this),G=this.type.isAnonymous,!this.nextSibling();){if(!W)return;this.parent(),W--,G=!0}}}matchContext(O){if(!this.buffer)return Ze(this.node,O);let{buffer:N}=this.buffer,{types:W}=N.set;for(let G=O.length-1,ne=this.stack.length-1;G>=0;ne--){if(ne<0)return Ze(this.node,O,G);let pe=W[N.buffer[this.stack[ne]]];if(!pe.isAnonymous){if(O[G]&&O[G]!=pe.name)return!1;G--}}return!0}}function K(Ee){return Ee.children.some(O=>O instanceof Je||!O.type.isAnonymous||K(O))}function yt(Ee){var O;let{buffer:N,nodeSet:W,maxBufferLength:G=v,reused:ne=[],minRepeatType:pe=W.types.length}=Ee,Se=Array.isArray(N)?new tt(N,N.length):N,$e=W.types,ve=0,ut=0;function St(Mt,yn,Ct,Kt,Xt){let{id:Jt,start:bt,end:wt,size:an}=Se,hn=ut;for(;an<0;)if(Se.next(),an==-1){let Bt=ne[Jt];Ct.push(Bt),Kt.push(bt-Mt);return}else if(an==-3){ve=Jt;return}else if(an==-4){ut=Jt;return}else throw new RangeError(`Unrecognized record size: ${an}`);let Vn=$e[Jt],Hn,cr,wr=bt-Mt;if(wt-bt<=G&&(cr=Qt(Se.pos-yn,Xt))){let Bt=new Uint16Array(cr.size-cr.skip),Pn=Se.pos-cr.size,Yt=Bt.length;for(;Se.pos>Pn;)Yt=Jn(cr.start,Bt,Yt);Hn=new Je(Bt,wt-cr.start,W),wr=cr.start-Mt}else{let Bt=Se.pos-an;Se.next();let Pn=[],Yt=[],un=Jt>=pe?Jt:-1,Xn=0,fr=wt;for(;Se.pos>Bt;)un>=0&&Se.id==un&&Se.size>=0?(Se.end<=fr-G&&(zt(Pn,Yt,bt,Xn,Se.end,fr,un,hn),Xn=Pn.length,fr=Se.end),Se.next()):St(bt,Bt,Pn,Yt,un);if(un>=0&&Xn>0&&Xn<Pn.length&&zt(Pn,Yt,bt,Xn,bt,fr,un,hn),Pn.reverse(),Yt.reverse(),un>-1&&Xn>0){let zn=at(Vn);Hn=ze(Vn,Pn,Yt,0,Pn.length,0,wt-bt,zn,zn)}else Hn=Ft(Vn,Pn,Yt,wt-bt,hn-wt)}Ct.push(Hn),Kt.push(wr)}function at(Mt){return(yn,Ct,Kt)=>{let Xt=0,Jt=yn.length-1,bt,wt;if(Jt>=0&&(bt=yn[Jt])instanceof gt){if(!Jt&&bt.type==Mt&&bt.length==Kt)return bt;(wt=bt.prop(I.lookAhead))&&(Xt=Ct[Jt]+bt.length+wt)}return Ft(Mt,yn,Ct,Kt,Xt)}}function zt(Mt,yn,Ct,Kt,Xt,Jt,bt,wt){let an=[],hn=[];for(;Mt.length>Kt;)an.push(Mt.pop()),hn.push(yn.pop()+Ct-Xt);Mt.push(Ft(W.types[bt],an,hn,Jt-Xt,wt-Jt)),yn.push(Xt-Ct)}function Ft(Mt,yn,Ct,Kt,Xt=0,Jt){if(ve){let bt=[I.contextHash,ve];Jt=Jt?[bt].concat(Jt):[bt]}if(Xt>25){let bt=[I.lookAhead,Xt];Jt=Jt?[bt].concat(Jt):[bt]}return new gt(Mt,yn,Ct,Kt,Jt)}function Qt(Mt,yn){let Ct=Se.fork(),Kt=0,Xt=0,Jt=0,bt=Ct.end-G,wt={size:0,start:0,skip:0};e:for(let an=Ct.pos-Mt;Ct.pos>an;){let hn=Ct.size;if(Ct.id==yn&&hn>=0){wt.size=Kt,wt.start=Xt,wt.skip=Jt,Jt+=4,Kt+=4,Ct.next();continue}let Vn=Ct.pos-hn;if(hn<0||Vn<an||Ct.start<bt)break;let Hn=Ct.id>=pe?4:0,cr=Ct.start;for(Ct.next();Ct.pos>Vn;){if(Ct.size<0)if(Ct.size==-3)Hn+=4;else break e;else Ct.id>=pe&&(Hn+=4);Ct.next()}Xt=cr,Kt+=hn,Jt+=Hn}return(yn<0||Kt==Mt)&&(wt.size=Kt,wt.start=Xt,wt.skip=Jt),wt.size>4?wt:void 0}function Jn(Mt,yn,Ct){let{id:Kt,start:Xt,end:Jt,size:bt}=Se;if(Se.next(),bt>=0&&Kt<pe){let wt=Ct;if(bt>4){let an=Se.pos-(bt-4);for(;Se.pos>an;)Ct=Jn(Mt,yn,Ct)}yn[--Ct]=wt,yn[--Ct]=Jt-Mt,yn[--Ct]=Xt-Mt,yn[--Ct]=Kt}else bt==-3?ve=Kt:bt==-4&&(ut=Kt);return Ct}let En=[],or=[];for(;Se.pos>0;)St(Ee.start||0,Ee.bufferStart||0,En,or,-1);let Gt=(O=Ee.length)!==null&&O!==void 0?O:En.length?or[0]+En[0].length:0;return new gt($e[Ee.topID],En.reverse(),or.reverse(),Gt)}const le=new WeakMap;function Ie(Ee,O){if(!Ee.isAnonymous||O instanceof Je||O.type!=Ee)return 1;let N=le.get(O);if(N==null){N=1;for(let W of O.children){if(W.type!=Ee||!(W instanceof gt)){N=1;break}N+=Ie(Ee,W)}le.set(O,N)}return N}function ze(Ee,O,N,W,G,ne,pe,Se,$e){let ve=0;for(let Ft=W;Ft<G;Ft++)ve+=Ie(Ee,O[Ft]);let ut=Math.ceil(ve*1.5/8),St=[],at=[];function zt(Ft,Qt,Jn,En,or){for(let Gt=Jn;Gt<En;){let Mt=Gt,yn=Qt[Gt],Ct=Ie(Ee,Ft[Gt]);for(Gt++;Gt<En;Gt++){let Kt=Ie(Ee,Ft[Gt]);if(Ct+Kt>=ut)break;Ct+=Kt}if(Gt==Mt+1){if(Ct>ut){let Kt=Ft[Mt];zt(Kt.children,Kt.positions,0,Kt.children.length,Qt[Mt]+or);continue}St.push(Ft[Mt])}else{let Kt=Qt[Gt-1]+Ft[Gt-1].length-yn;St.push(ze(Ee,Ft,Qt,Mt,Gt,yn,Kt,null,$e))}at.push(yn+or-ne)}}return zt(O,N,W,G,0),(Se||$e)(St,at,pe)}class ot{constructor(){this.map=new WeakMap}setBuffer(O,N,W){let G=this.map.get(O);G||this.map.set(O,G=new Map),G.set(N,W)}getBuffer(O,N){let W=this.map.get(O);return W&&W.get(N)}set(O,N){O instanceof Xe?this.setBuffer(O.context.buffer,O.index,N):O instanceof ge&&this.map.set(O.tree,N)}get(O){return O instanceof Xe?this.getBuffer(O.context.buffer,O.index):O instanceof ge?this.map.get(O.tree):void 0}cursorSet(O,N){O.buffer?this.setBuffer(O.buffer.buffer,O.index,N):this.map.set(O.tree,N)}cursorGet(O){return O.buffer?this.getBuffer(O.buffer.buffer,O.index):this.map.get(O.tree)}}class Ae{constructor(O,N,W,G,ne=!1,pe=!1){this.from=O,this.to=N,this.tree=W,this.offset=G,this.open=(ne?1:0)|(pe?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(O,N=[],W=!1){let G=[new Ae(0,O.length,O,0,!1,W)];for(let ne of N)ne.to>O.length&&G.push(ne);return G}static applyChanges(O,N,W=128){if(!N.length)return O;let G=[],ne=1,pe=O.length?O[0]:null;for(let Se=0,$e=0,ve=0;;Se++){let ut=Se<N.length?N[Se]:null,St=ut?ut.fromA:1e9;if(St-$e>=W)for(;pe&&pe.from<St;){let at=pe;if($e>=at.from||St<=at.to||ve){let zt=Math.max(at.from,$e)-ve,Ft=Math.min(at.to,St)-ve;at=zt>=Ft?null:new Ae(zt,Ft,at.tree,at.offset+ve,Se>0,!!ut)}if(at&&G.push(at),pe.to>St)break;pe=ne<O.length?O[ne++]:null}if(!ut)break;$e=ut.toA,ve=ut.toA-ut.toB}return G}}class Ue{startParse(O,N,W){return typeof O=="string"&&(O=new Ge(O)),W=W?W.length?W.map(G=>new me(G.from,G.to)):[new me(0,0)]:[new me(0,O.length)],this.createParse(O,N||[],W)}parse(O,N,W){let G=this.startParse(O,N,W);for(;;){let ne=G.advance();if(ne)return ne}}}class Ge{constructor(O){this.string=O}get length(){return this.string.length}chunk(O){return this.string.slice(O)}get lineChunks(){return!1}read(O,N){return this.string.slice(O,N)}}function lt(Ee){return(O,N,W,G)=>new vt(O,Ee,N,W,G)}class ye{constructor(O,N,W,G,ne){if(this.parser=O,this.parse=N,this.overlay=W,this.target=G,this.ranges=ne,!ne.length||ne.some(pe=>pe.from>=pe.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(ne))}}class xe{constructor(O,N,W,G,ne,pe,Se){this.parser=O,this.predicate=N,this.mounts=W,this.index=G,this.start=ne,this.target=pe,this.prev=Se,this.depth=0,this.ranges=[]}}const We=new I({perNode:!0});class vt{constructor(O,N,W,G,ne){this.nest=N,this.input=W,this.fragments=G,this.ranges=ne,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=O}advance(){if(this.baseParse){let W=this.baseParse.advance();if(!W)return null;if(this.baseParse=null,this.baseTree=W,this.startInner(),this.stoppedAt!=null)for(let G of this.inner)G.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let W=this.baseTree;return this.stoppedAt!=null&&(W=new gt(W.type,W.children,W.positions,W.length,W.propValues.concat([[We,this.stoppedAt]]))),W}let O=this.inner[this.innerDone],N=O.parse.advance();if(N){this.innerDone++;let W=Object.assign(Object.create(null),O.target.props);W[I.mounted.id]=new se(N,O.overlay,O.parser),O.target.props=W}return null}get parsedPos(){if(this.baseParse)return 0;let O=this.input.length;for(let N=this.innerDone;N<this.inner.length;N++)this.inner[N].ranges[0].from<O&&(O=Math.min(O,this.inner[N].parse.parsedPos));return O}stopAt(O){if(this.stoppedAt=O,this.baseParse)this.baseParse.stopAt(O);else for(let N=this.innerDone;N<this.inner.length;N++)this.inner[N].parse.stopAt(O)}startInner(){let O=new xn(this.fragments),N=null,W=null,G=new Ye(new ge(this.baseTree,this.ranges[0].from,0,null),He.IncludeAnonymous|He.IgnoreMounts);e:for(let ne,pe;this.stoppedAt==null||G.from<this.stoppedAt;){let Se=!0,$e;if(O.hasNode(G)){if(N){let ve=N.mounts.find(ut=>ut.frag.from<=G.from&&ut.frag.to>=G.to&&ut.mount.overlay);if(ve)for(let ut of ve.mount.overlay){let St=ut.from+ve.pos,at=ut.to+ve.pos;St>=G.from&&at<=G.to&&!N.ranges.some(zt=>zt.from<at&&zt.to>St)&&N.ranges.push({from:St,to:at})}}Se=!1}else if(W&&(pe=Pt(W.ranges,G.from,G.to)))Se=pe!=2;else if(!G.type.isAnonymous&&G.from<G.to&&(ne=this.nest(G,this.input))){G.tree||Zt(G);let ve=O.findMounts(G.from,ne.parser);if(typeof ne.overlay=="function")N=new xe(ne.parser,ne.overlay,ve,this.inner.length,G.from,G.tree,N);else{let ut=er(this.ranges,ne.overlay||[new me(G.from,G.to)]);ut.length&&this.inner.push(new ye(ne.parser,ne.parser.startParse(this.input,rn(ve,ut),ut),ne.overlay?ne.overlay.map(St=>new me(St.from-G.from,St.to-G.from)):null,G.tree,ut)),ne.overlay?ut.length&&(W={ranges:ut,depth:0,prev:W}):Se=!1}}else N&&($e=N.predicate(G))&&($e===!0&&($e=new me(G.from,G.to)),$e.from<$e.to&&N.ranges.push($e));if(Se&&G.firstChild())N&&N.depth++,W&&W.depth++;else for(;!G.nextSibling();){if(!G.parent())break e;if(N&&!--N.depth){let ve=er(this.ranges,N.ranges);ve.length&&this.inner.splice(N.index,0,new ye(N.parser,N.parser.startParse(this.input,rn(N.mounts,ve),ve),N.ranges.map(ut=>new me(ut.from-N.start,ut.to-N.start)),N.target,ve)),N=N.prev}W&&!--W.depth&&(W=W.prev)}}}}function Pt(Ee,O,N){for(let W of Ee){if(W.from>=N)break;if(W.to>O)return W.from<=O&&W.to>=N?2:1}return 0}function Wt(Ee,O,N,W,G,ne){if(O<N){let pe=Ee.buffer[O+1];W.push(Ee.slice(O,N,pe)),G.push(pe-ne)}}function Zt(Ee){let{node:O}=Ee,N=0;do Ee.parent(),N++;while(!Ee.tree);let W=0,G=Ee.tree,ne=0;for(;ne=G.positions[W]+Ee.from,!(ne<=O.from&&ne+G.children[W].length>=O.to);W++);let pe=G.children[W],Se=pe.buffer;function $e(ve,ut,St,at,zt){let Ft=ve;for(;Se[Ft+2]+ne<=O.from;)Ft=Se[Ft+3];let Qt=[],Jn=[];Wt(pe,ve,Ft,Qt,Jn,at);let En=Se[Ft+1],or=Se[Ft+2],Gt=En+ne==O.from&&or+ne==O.to&&Se[Ft]==O.type.id;return Qt.push(Gt?O.toTree():$e(Ft+4,Se[Ft+3],pe.set.types[Se[Ft]],En,or-En)),Jn.push(En-at),Wt(pe,Se[Ft+3],ut,Qt,Jn,at),new gt(St,Qt,Jn,zt)}G.children[W]=$e(0,Se.length,De.none,0,pe.length);for(let ve=0;ve<=N;ve++)Ee.childAfter(O.from)}class In{constructor(O,N){this.offset=N,this.done=!1,this.cursor=O.cursor(He.IncludeAnonymous|He.IgnoreMounts)}moveTo(O){let{cursor:N}=this,W=O-this.offset;for(;!this.done&&N.from<W;)N.to>=O&&N.enter(W,1,He.IgnoreOverlays|He.ExcludeBuffers)||N.next(!1)||(this.done=!0)}hasNode(O){if(this.moveTo(O.from),!this.done&&this.cursor.from+this.offset==O.from&&this.cursor.tree)for(let N=this.cursor.tree;;){if(N==O.tree)return!0;if(N.children.length&&N.positions[0]==0&&N.children[0]instanceof gt)N=N.children[0];else break}return!1}}class xn{constructor(O){var N;if(this.fragments=O,this.curTo=0,this.fragI=0,O.length){let W=this.curFrag=O[0];this.curTo=(N=W.tree.prop(We))!==null&&N!==void 0?N:W.to,this.inner=new In(W.tree,-W.offset)}else this.curFrag=this.inner=null}hasNode(O){for(;this.curFrag&&O.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=O.from&&this.curTo>=O.to&&this.inner.hasNode(O)}nextFrag(){var O;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let N=this.curFrag=this.fragments[this.fragI];this.curTo=(O=N.tree.prop(We))!==null&&O!==void 0?O:N.to,this.inner=new In(N.tree,-N.offset)}}findMounts(O,N){var W;let G=[];if(this.inner){this.inner.cursor.moveTo(O,1);for(let ne=this.inner.cursor.node;ne;ne=ne.parent){let pe=(W=ne.tree)===null||W===void 0?void 0:W.prop(I.mounted);if(pe&&pe.parser==N)for(let Se=this.fragI;Se<this.fragments.length;Se++){let $e=this.fragments[Se];if($e.from>=ne.to)break;$e.tree==this.curFrag.tree&&G.push({frag:$e,pos:ne.from-$e.offset,mount:pe})}}}return G}}function er(Ee,O){let N=null,W=O;for(let G=1,ne=0;G<Ee.length;G++){let pe=Ee[G-1].to,Se=Ee[G].from;for(;ne<W.length;ne++){let $e=W[ne];if($e.from>=Se)break;$e.to<=pe||(N||(W=N=O.slice()),$e.from<pe?(N[ne]=new me($e.from,pe),$e.to>Se&&N.splice(ne+1,0,new me(Se,$e.to))):$e.to>Se?N[ne--]=new me(Se,$e.to):N.splice(ne--,1))}}return W}function Lt(Ee,O,N,W){let G=0,ne=0,pe=!1,Se=!1,$e=-1e9,ve=[];for(;;){let ut=G==Ee.length?1e9:pe?Ee[G].to:Ee[G].from,St=ne==O.length?1e9:Se?O[ne].to:O[ne].from;if(pe!=Se){let at=Math.max($e,N),zt=Math.min(ut,St,W);at<zt&&ve.push(new me(at,zt))}if($e=Math.min(ut,St),$e==1e9)break;ut==$e&&(pe?(pe=!1,G++):pe=!0),St==$e&&(Se?(Se=!1,ne++):Se=!0)}return ve}function rn(Ee,O){let N=[];for(let{pos:W,mount:G,frag:ne}of Ee){let pe=W+(G.overlay?G.overlay[0].from:0),Se=pe+G.tree.length,$e=Math.max(ne.from,pe),ve=Math.min(ne.to,Se);if(G.overlay){let ut=G.overlay.map(at=>new me(at.from+W,at.to+W)),St=Lt(O,ut,$e,ve);for(let at=0,zt=$e;;at++){let Ft=at==St.length,Qt=Ft?ve:St[at].from;if(Qt>zt&&N.push(new Ae(zt,Qt,G.tree,-pe,ne.from>=zt||ne.openStart,ne.to<=Qt||ne.openEnd)),Ft)break;zt=St[at].to}}else N.push(new Ae($e,ve,G.tree,-pe,ne.from>=pe||ne.openStart,ne.to<=Se||ne.openEnd))}return N}},86253:function(Bn,pt,z){"use strict";z.d(pt,{Gv:function(){return Tt},QR:function(){return He},bW:function(){return tt},pJ:function(){return Ue}});var v=z(21649);let ke=0;class me{constructor(ye,xe,We){this.set=ye,this.base=xe,this.modified=We,this.id=ke++}static define(ye){if(ye!=null&&ye.base)throw new Error("Can not derive from a modified tag");let xe=new me([],null,[]);if(xe.set.push(xe),ye)for(let We of ye.set)xe.set.push(We);return xe}static defineModifier(){let ye=new se;return xe=>xe.modified.indexOf(ye)>-1?xe:se.get(xe.base||xe,xe.modified.concat(ye).sort((We,vt)=>We.id-vt.id))}}let I=0;class se{constructor(){this.instances=[],this.id=I++}static get(ye,xe){if(!xe.length)return ye;let We=xe[0].instances.find(Zt=>Zt.base==ye&&Ne(xe,Zt.modified));if(We)return We;let vt=[],Pt=new me(vt,ye,xe);for(let Zt of xe)Zt.instances.push(Pt);let Wt=De(xe);for(let Zt of ye.set)if(!Zt.modified.length)for(let In of Wt)vt.push(se.get(Zt,In));return Pt}}function Ne(lt,ye){return lt.length==ye.length&&lt.every((xe,We)=>xe==ye[We])}function De(lt){let ye=[[]];for(let xe=0;xe<lt.length;xe++)for(let We=0,vt=ye.length;We<vt;We++)ye.push(ye[We].concat(lt[xe]));return ye.sort((xe,We)=>We.length-xe.length)}function Tt(lt){let ye=Object.create(null);for(let xe in lt){let We=lt[xe];Array.isArray(We)||(We=[We]);for(let vt of xe.split(" "))if(vt){let Pt=[],Wt=2,Zt=vt;for(let Lt=0;;){if(Zt=="..."&&Lt>0&&Lt+3==vt.length){Wt=1;break}let rn=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Zt);if(!rn)throw new RangeError("Invalid path: "+vt);if(Pt.push(rn[0]=="*"?"":rn[0][0]=='"'?JSON.parse(rn[0]):rn[0]),Lt+=rn[0].length,Lt==vt.length)break;let Ee=vt[Lt++];if(Lt==vt.length&&Ee=="!"){Wt=0;break}if(Ee!="/")throw new RangeError("Invalid path: "+vt);Zt=vt.slice(Lt)}let In=Pt.length-1,xn=Pt[In];if(!xn)throw new RangeError("Invalid path: "+vt);let er=new st(We,Wt,In>0?Pt.slice(0,In):null);ye[xn]=er.sort(ye[xn])}}return rt.add(ye)}const rt=new v.md;class st{constructor(ye,xe,We,vt){this.tags=ye,this.mode=xe,this.context=We,this.next=vt}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(ye){return!ye||ye.depth<this.depth?(this.next=ye,this):(ye.next=this.sort(ye.next),ye)}get depth(){return this.context?this.context.length:0}}st.empty=new st([],2,null);function He(lt,ye){let xe=Object.create(null);for(let Pt of lt)if(!Array.isArray(Pt.tag))xe[Pt.tag.id]=Pt.class;else for(let Wt of Pt.tag)xe[Wt.id]=Pt.class;let{scope:We,all:vt=null}=ye||{};return{style:Pt=>{let Wt=vt;for(let Zt of Pt)for(let In of Zt.set){let xn=xe[In.id];if(xn){Wt=Wt?Wt+" "+xn:xn;break}}return Wt},scope:We}}function gt(lt,ye){let xe=null;for(let We of lt){let vt=We.style(ye);vt&&(xe=xe?xe+" "+vt:vt)}return xe}function tt(lt,ye,xe,We=0,vt=lt.length){let Pt=new Je(We,Array.isArray(ye)?ye:[ye],xe);Pt.highlightRange(lt.cursor(),We,vt,"",Pt.highlighters),Pt.flush(vt)}class Je{constructor(ye,xe,We){this.at=ye,this.highlighters=xe,this.span=We,this.class=""}startSpan(ye,xe){xe!=this.class&&(this.flush(ye),ye>this.at&&(this.at=ye),this.class=xe)}flush(ye){ye>this.at&&this.class&&this.span(this.at,ye,this.class)}highlightRange(ye,xe,We,vt,Pt){let{type:Wt,from:Zt,to:In}=ye;if(Zt>=We||In<=xe)return;Wt.isTop&&(Pt=this.highlighters.filter(Ee=>!Ee.scope||Ee.scope(Wt)));let xn=vt,er=It(ye)||st.empty,Lt=gt(Pt,er.tags);if(Lt&&(xn&&(xn+=" "),xn+=Lt,er.mode==1&&(vt+=(vt?" ":"")+Lt)),this.startSpan(Math.max(xe,Zt),xn),er.opaque)return;let rn=ye.tree&&ye.tree.prop(v.md.mounted);if(rn&&rn.overlay){let Ee=ye.node.enter(rn.overlay[0].from+Zt,1),O=this.highlighters.filter(W=>!W.scope||W.scope(rn.tree.type)),N=ye.firstChild();for(let W=0,G=Zt;;W++){let ne=W<rn.overlay.length?rn.overlay[W]:null,pe=ne?ne.from+Zt:In,Se=Math.max(xe,G),$e=Math.min(We,pe);if(Se<$e&&N)for(;ye.from<$e&&(this.highlightRange(ye,Se,$e,vt,Pt),this.startSpan(Math.min($e,ye.to),xn),!(ye.to>=pe||!ye.nextSibling())););if(!ne||pe>We)break;G=ne.to+Zt,G>xe&&(this.highlightRange(Ee.cursor(),Math.max(xe,ne.from+Zt),Math.min(We,G),"",O),this.startSpan(Math.min(We,G),xn))}N&&ye.parent()}else if(ye.firstChild()){rn&&(vt="");do if(!(ye.to<=xe)){if(ye.from>=We)break;this.highlightRange(ye,xe,We,vt,Pt),this.startSpan(Math.min(We,ye.to),xn)}while(ye.nextSibling());ye.parent()}}}function It(lt){let ye=lt.type.prop(rt);for(;ye&&ye.context&&!lt.matchContext(ye.context);)ye=ye.next;return ye||null}const ee=me.define,Me=ee(),ge=ee(),je=ee(ge),Ze=ee(ge),Oe=ee(),Xe=ee(Oe),Ye=ee(Oe),K=ee(),yt=ee(K),le=ee(),Ie=ee(),ze=ee(),ot=ee(ze),Ae=ee(),Ue={comment:Me,lineComment:ee(Me),blockComment:ee(Me),docComment:ee(Me),name:ge,variableName:ee(ge),typeName:je,tagName:ee(je),propertyName:Ze,attributeName:ee(Ze),className:ee(ge),labelName:ee(ge),namespace:ee(ge),macroName:ee(ge),literal:Oe,string:Xe,docString:ee(Xe),character:ee(Xe),attributeValue:ee(Xe),number:Ye,integer:ee(Ye),float:ee(Ye),bool:ee(Oe),regexp:ee(Oe),escape:ee(Oe),color:ee(Oe),url:ee(Oe),keyword:le,self:ee(le),null:ee(le),atom:ee(le),unit:ee(le),modifier:ee(le),operatorKeyword:ee(le),controlKeyword:ee(le),definitionKeyword:ee(le),moduleKeyword:ee(le),operator:Ie,derefOperator:ee(Ie),arithmeticOperator:ee(Ie),logicOperator:ee(Ie),bitwiseOperator:ee(Ie),compareOperator:ee(Ie),updateOperator:ee(Ie),definitionOperator:ee(Ie),typeOperator:ee(Ie),controlOperator:ee(Ie),punctuation:ze,separator:ee(ze),bracket:ot,angleBracket:ee(ot),squareBracket:ee(ot),paren:ee(ot),brace:ee(ot),content:K,heading:yt,heading1:ee(yt),heading2:ee(yt),heading3:ee(yt),heading4:ee(yt),heading5:ee(yt),heading6:ee(yt),contentSeparator:ee(K),list:ee(K),quote:ee(K),emphasis:ee(K),strong:ee(K),link:ee(K),monospace:ee(K),strikethrough:ee(K),inserted:ee(),deleted:ee(),changed:ee(),invalid:ee(),meta:Ae,documentMeta:ee(Ae),annotation:ee(Ae),processingInstruction:ee(Ae),definition:me.defineModifier(),constant:me.defineModifier(),function:me.defineModifier(),standard:me.defineModifier(),local:me.defineModifier(),special:me.defineModifier()},Ge=He([{tag:Ue.link,class:"tok-link"},{tag:Ue.heading,class:"tok-heading"},{tag:Ue.emphasis,class:"tok-emphasis"},{tag:Ue.strong,class:"tok-strong"},{tag:Ue.keyword,class:"tok-keyword"},{tag:Ue.atom,class:"tok-atom"},{tag:Ue.bool,class:"tok-bool"},{tag:Ue.url,class:"tok-url"},{tag:Ue.labelName,class:"tok-labelName"},{tag:Ue.inserted,class:"tok-inserted"},{tag:Ue.deleted,class:"tok-deleted"},{tag:Ue.literal,class:"tok-literal"},{tag:Ue.string,class:"tok-string"},{tag:Ue.number,class:"tok-number"},{tag:[Ue.regexp,Ue.escape,Ue.special(Ue.string)],class:"tok-string2"},{tag:Ue.variableName,class:"tok-variableName"},{tag:Ue.local(Ue.variableName),class:"tok-variableName tok-local"},{tag:Ue.definition(Ue.variableName),class:"tok-variableName tok-definition"},{tag:Ue.special(Ue.variableName),class:"tok-variableName2"},{tag:Ue.definition(Ue.propertyName),class:"tok-propertyName tok-definition"},{tag:Ue.typeName,class:"tok-typeName"},{tag:Ue.namespace,class:"tok-namespace"},{tag:Ue.className,class:"tok-className"},{tag:Ue.macroName,class:"tok-macroName"},{tag:Ue.propertyName,class:"tok-propertyName"},{tag:Ue.operator,class:"tok-operator"},{tag:Ue.comment,class:"tok-comment"},{tag:Ue.meta,class:"tok-meta"},{tag:Ue.invalid,class:"tok-invalid"},{tag:Ue.punctuation,class:"tok-punctuation"}])},37207:function(Bn,pt,z){"use strict";z.d(pt,{V:function(){return se}});const v="\u037C",ke=typeof Symbol=="undefined"?"__"+v:Symbol.for(v),me=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),I=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class se{constructor(rt,st){this.rules=[];let{finish:He}=st||{};function gt(Je){return/^@/.test(Je)?[Je]:Je.split(/,\s*/)}function tt(Je,It,ee,Me){let ge=[],je=/^@(\w+)\b/.exec(Je[0]),Ze=je&&je[1]=="keyframes";if(je&&It==null)return ee.push(Je[0]+";");for(let Oe in It){let Xe=It[Oe];if(/&/.test(Oe))tt(Oe.split(/,\s*/).map(Ye=>Je.map(K=>Ye.replace(/&/,K))).reduce((Ye,K)=>Ye.concat(K)),Xe,ee);else if(Xe&&typeof Xe=="object"){if(!je)throw new RangeError("The value of a property ("+Oe+") should be a primitive value.");tt(gt(Oe),Xe,ge,Ze)}else Xe!=null&&ge.push(Oe.replace(/_.*/,"").replace(/[A-Z]/g,Ye=>"-"+Ye.toLowerCase())+": "+Xe+";")}(ge.length||Ze)&&ee.push((He&&!je&&!Me?Je.map(He):Je).join(", ")+" {"+ge.join(" ")+"}")}for(let Je in rt)tt(gt(Je),rt[Je],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let rt=I[ke]||1;return I[ke]=rt+1,v+rt.toString(36)}static mount(rt,st){(rt[me]||new De(rt)).mount(Array.isArray(st)?st:[st])}}let Ne=new Map;class De{constructor(rt){let st=rt.ownerDocument||rt,He=st.defaultView;if(!rt.head&&rt.adoptedStyleSheets&&He.CSSStyleSheet){let gt=Ne.get(st);if(gt)return rt.adoptedStyleSheets=[gt.sheet,...rt.adoptedStyleSheets],rt[me]=gt;this.sheet=new He.CSSStyleSheet,rt.adoptedStyleSheets=[this.sheet,...rt.adoptedStyleSheets],Ne.set(st,this)}else{this.styleTag=st.createElement("style");let gt=rt.head||rt;gt.insertBefore(this.styleTag,gt.firstChild)}this.modules=[],rt[me]=this}mount(rt){let st=this.sheet,He=0,gt=0;for(let tt=0;tt<rt.length;tt++){let Je=rt[tt],It=this.modules.indexOf(Je);if(It<gt&&It>-1&&(this.modules.splice(It,1),gt--,It=-1),It==-1){if(this.modules.splice(gt++,0,Je),st)for(let ee=0;ee<Je.rules.length;ee++)st.insertRule(Je.rules[ee],He++)}else{for(;gt<It;)He+=this.modules[gt++].rules.length;He+=Je.rules.length,gt++}}if(!st){let tt="";for(let Je=0;Je<this.modules.length;Je++)tt+=this.modules[Je].getRules()+`
`;this.styleTag.textContent=tt}}}}}]);})();

//# sourceMappingURL=844.931d16b9.chunk.js.map